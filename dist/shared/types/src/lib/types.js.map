{"version":3,"sources":["../../../../../shared/types/src/lib/types.ts"],"sourcesContent":["/**\r\n * Shared TypeScript interfaces for Mentor AI\r\n * These types are used across both frontend (Angular) and backend (NestJS)\r\n */\r\n\r\n/** Base entity with common fields */\r\nexport interface BaseEntity {\r\n  id: string;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\n/** API response wrapper */\r\nexport interface ApiResponse<T> {\r\n  data: T;\r\n  message?: string;\r\n  success: boolean;\r\n}\r\n\r\n/** Pagination metadata */\r\nexport interface PaginationMeta {\r\n  page: number;\r\n  limit: number;\r\n  total: number;\r\n  totalPages: number;\r\n}\r\n\r\n/** Paginated response */\r\nexport interface PaginatedResponse<T> extends ApiResponse<T[]> {\r\n  meta: PaginationMeta;\r\n}\r\n\r\n/** User entity */\r\nexport interface User extends BaseEntity {\r\n  email: string;\r\n  displayName: string;\r\n  avatarUrl?: string;\r\n}\r\n\r\n/** Error response */\r\nexport interface ApiError {\r\n  statusCode: number;\r\n  message: string;\r\n  error?: string;\r\n}\r\n\r\n/** Invitation status */\r\nexport enum InvitationStatus {\r\n  PENDING = 'PENDING',\r\n  ACCEPTED = 'ACCEPTED',\r\n  EXPIRED = 'EXPIRED',\r\n  REVOKED = 'REVOKED',\r\n}\r\n\r\n/** Department assignment */\r\nexport enum Department {\r\n  FINANCE = 'FINANCE',\r\n  MARKETING = 'MARKETING',\r\n  TECHNOLOGY = 'TECHNOLOGY',\r\n  OPERATIONS = 'OPERATIONS',\r\n  LEGAL = 'LEGAL',\r\n  CREATIVE = 'CREATIVE',\r\n  STRATEGY = 'STRATEGY',\r\n  SALES = 'SALES',\r\n}\r\n\r\n/** Full list of industries for onboarding */\r\nexport const INDUSTRIES = [\r\n  'Accounting & Finance',\r\n  'Agriculture',\r\n  'Automotive',\r\n  'Construction & Real Estate',\r\n  'Consulting',\r\n  'Education',\r\n  'Energy & Utilities',\r\n  'Entertainment & Media',\r\n  'Food & Beverage',\r\n  'Government',\r\n  'Healthcare',\r\n  'Hospitality & Tourism',\r\n  'Insurance',\r\n  'Legal Services',\r\n  'Manufacturing',\r\n  'Non-Profit',\r\n  'Professional Services',\r\n  'Retail & E-Commerce',\r\n  'SaaS & Technology',\r\n  'Telecommunications',\r\n  'Transportation & Logistics',\r\n  'Other',\r\n] as const;\r\n\r\nexport type Industry = (typeof INDUSTRIES)[number];\r\n\r\n/** Invitation entity */\r\nexport interface Invitation extends BaseEntity {\r\n  email: string;\r\n  department: Department;\r\n  role: string;\r\n  status: InvitationStatus;\r\n  token: string;\r\n  expiresAt: Date;\r\n  tenantId: string;\r\n  invitedById: string;\r\n  acceptedByUserId?: string | null;\r\n}\r\n\r\n/** Create invitation request */\r\nexport interface CreateInvitationRequest {\r\n  email: string;\r\n  department: Department;\r\n}\r\n\r\n/** Invitation response from API */\r\nexport interface InvitationResponse extends Invitation {\r\n  tenantName?: string;\r\n  invitedByEmail?: string;\r\n}\r\n\r\n/** Team member removal strategy */\r\nexport type RemovalStrategy = 'REASSIGN' | 'ARCHIVE';\r\n\r\n/** Remove member request body */\r\nexport interface RemoveMemberRequest {\r\n  strategy: RemovalStrategy;\r\n}\r\n\r\n/** Team member response for listing active members */\r\nexport interface TeamMemberResponse {\r\n  id: string;\r\n  email: string;\r\n  name: string | null;\r\n  role: string;\r\n  department: string | null;\r\n  createdAt: Date;\r\n}\r\n\r\n/** Backup owner response */\r\nexport interface BackupOwnerResponse {\r\n  id: string;\r\n  email: string;\r\n  name: string | null;\r\n  designatedAt: string;\r\n}\r\n\r\n/** Request to designate a backup owner */\r\nexport interface DesignateBackupOwnerRequest {\r\n  backupOwnerId: string;\r\n}\r\n\r\n/** Backup owner status for warning banner check */\r\nexport interface BackupOwnerStatus {\r\n  hasBackupOwner: boolean;\r\n  tenantAgeDays: number;\r\n  showWarning: boolean;\r\n}\r\n\r\n/** Recovery result */\r\nexport interface RecoveryResult {\r\n  recoveredUserId: string;\r\n  message: string;\r\n}\r\n\r\n// ── Data Export Types ──\r\n// NOTE: These enums intentionally mirror the Prisma schema enums (ExportFormat, ExportStatus).\r\n// Prisma generates its own types from schema.prisma, but frontend cannot import @prisma/client.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** Export format options */\r\nexport enum ExportFormat {\r\n  PDF = 'PDF',\r\n  MARKDOWN = 'MARKDOWN',\r\n  JSON = 'JSON',\r\n}\r\n\r\n/** Export status tracking */\r\nexport enum ExportStatus {\r\n  PENDING = 'PENDING',\r\n  PROCESSING = 'PROCESSING',\r\n  COMPLETED = 'COMPLETED',\r\n  FAILED = 'FAILED',\r\n  EXPIRED = 'EXPIRED',\r\n}\r\n\r\n/** Request to initiate a data export */\r\nexport interface DataExportRequest {\r\n  format: ExportFormat;\r\n  dataTypes: string[]; // [\"all\", \"profile\", \"invitations\"]\r\n}\r\n\r\n/** Single data export record response */\r\nexport interface DataExportResponse {\r\n  exportId: string;\r\n  status: ExportStatus;\r\n  format: ExportFormat;\r\n  dataTypes: string[];\r\n  fileSize: number | null;\r\n  requestedAt: string;\r\n  completedAt: string | null;\r\n  expiresAt: string | null;\r\n  downloadUrl: string | null;\r\n}\r\n\r\n/** Section of collected export data */\r\nexport interface ExportDataSection {\r\n  key: string;\r\n  title: string;\r\n  items: Record<string, unknown>[];\r\n  itemCount: number;\r\n}\r\n\r\n// ── Tenant Deletion Types ──\r\n// NOTE: TenantStatus intentionally mirrors the Prisma schema enum.\r\n// Prisma generates its own types from schema.prisma, but frontend cannot import @prisma/client.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** Tenant status tracking */\r\nexport enum TenantStatus {\r\n  DRAFT = 'DRAFT',\r\n  ONBOARDING = 'ONBOARDING',\r\n  ACTIVE = 'ACTIVE',\r\n  SUSPENDED = 'SUSPENDED',\r\n  PENDING_DELETION = 'PENDING_DELETION',\r\n  DELETED = 'DELETED',\r\n}\r\n\r\n/** Request to initiate tenant deletion */\r\nexport interface TenantDeletionRequest {\r\n  workspaceName: string;\r\n}\r\n\r\n/** Tenant deletion status response */\r\nexport interface TenantDeletionStatusResponse {\r\n  status: TenantStatus;\r\n  requestedAt: string | null;\r\n  gracePeriodEndsAt: string | null;\r\n  estimatedCompletionBy: string | null;\r\n  canCancel: boolean;\r\n  /** Tenant name for type-to-confirm validation */\r\n  tenantName?: string;\r\n  /** Number of active team members who will lose access */\r\n  memberCount?: number;\r\n}\r\n\r\n/** Response after initiating tenant deletion */\r\nexport interface TenantDeletionResponse {\r\n  data: TenantDeletionStatusResponse;\r\n  message: string;\r\n}\r\n\r\n// ── LLM Provider Configuration Types ──\r\n// NOTE: LlmProviderType intentionally mirrors the Prisma schema enum.\r\n// Prisma generates its own types from schema.prisma, but frontend cannot import @prisma/client.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** LLM provider types supported by the platform */\r\nexport enum LlmProviderType {\r\n  OPENROUTER = 'OPENROUTER',\r\n  LOCAL_LLAMA = 'LOCAL_LLAMA',\r\n  OPENAI = 'OPENAI',\r\n  ANTHROPIC = 'ANTHROPIC',\r\n}\r\n\r\n/** Single LLM provider configuration */\r\nexport interface LlmProviderConfig {\r\n  id: string;\r\n  providerType: LlmProviderType;\r\n  apiKey?: string; // Masked on read, full value on write\r\n  endpoint?: string;\r\n  modelId: string;\r\n  isPrimary: boolean;\r\n  isFallback: boolean;\r\n  isActive: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n/** Model information from provider */\r\nexport interface LlmModelInfo {\r\n  id: string;\r\n  name: string;\r\n  costPer1kTokens: number | null;\r\n  contextLength?: number;\r\n}\r\n\r\n/** Resource requirements for local LLM */\r\nexport interface LlmResourceInfo {\r\n  gpuRequired: boolean;\r\n  gpuMemoryGb?: number;\r\n  cpuCores?: number;\r\n  ramGb?: number;\r\n}\r\n\r\n/** Provider validation status/result */\r\nexport interface LlmProviderStatus {\r\n  valid: boolean;\r\n  models: LlmModelInfo[];\r\n  resourceInfo: LlmResourceInfo | null;\r\n  errorMessage?: string;\r\n}\r\n\r\n/** Single provider configuration for update request */\r\nexport interface LlmProviderUpdatePayload {\r\n  type: LlmProviderType;\r\n  apiKey?: string;\r\n  endpoint?: string;\r\n  modelId: string;\r\n}\r\n\r\n/** Request to update LLM configuration */\r\nexport interface LlmConfigUpdateRequest {\r\n  primaryProvider: LlmProviderUpdatePayload;\r\n  fallbackProvider?: LlmProviderUpdatePayload | null;\r\n}\r\n\r\n/** Response containing current LLM configuration */\r\nexport interface LlmConfigResponse {\r\n  primaryProvider: LlmProviderConfig | null;\r\n  fallbackProvider: LlmProviderConfig | null;\r\n}\r\n\r\n/** Request to validate a provider's credentials */\r\nexport interface LlmValidateProviderRequest {\r\n  type: LlmProviderType;\r\n  apiKey?: string;\r\n  endpoint?: string;\r\n}\r\n\r\n/** Response from provider validation */\r\nexport interface LlmValidateProviderResponse {\r\n  data: LlmProviderStatus;\r\n}\r\n\r\n/** Audit log entry for LLM config changes */\r\nexport interface LlmConfigAuditLogEntry {\r\n  id: string;\r\n  action: 'CREATE' | 'UPDATE' | 'DELETE';\r\n  changedBy: string;\r\n  previousVal: Record<string, unknown> | null;\r\n  newVal: Record<string, unknown>;\r\n  createdAt: string;\r\n}\r\n\r\n// ── Chat Conversation Types (Story 2.1) ──\r\n// NOTE: MessageRole intentionally mirrors the Prisma schema enum.\r\n// Prisma generates its own types from schema.prisma, but frontend cannot import @prisma/client.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** Message role in conversation */\r\nexport enum MessageRole {\r\n  USER = 'USER',\r\n  ASSISTANT = 'ASSISTANT',\r\n}\r\n\r\n/** Chat conversation session */\r\nexport interface Conversation {\r\n  id: string; // sess_ prefix\r\n  userId: string;\r\n  title: string | null;\r\n  personaType: PersonaType | null; // Selected department persona (Story 2.4)\r\n  conceptId: string | null; // Links to platform Concept for tree organization\r\n  conceptName?: string | null; // Denormalized concept name for display\r\n  conceptCategory?: string | null; // Denormalized concept category for display\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n/** Individual chat message */\r\nexport interface Message {\r\n  id: string; // msg_ prefix\r\n  conversationId: string;\r\n  role: MessageRole;\r\n  content: string;\r\n  /** Confidence score for AI messages (0.0-1.0), null for user messages */\r\n  confidenceScore: number | null;\r\n  /** Confidence factor breakdown for AI messages */\r\n  confidenceFactors: ConfidenceFactor[] | null;\r\n  /** Concept citations in this message (Story 2.6) */\r\n  citations?: ConceptCitation[];\r\n  /** Memory attributions for context references (Story 2.7) */\r\n  memoryAttributions?: MemoryAttribution[];\r\n  createdAt: string;\r\n}\r\n\r\n/** Conversation with messages included */\r\nexport interface ConversationWithMessages extends Conversation {\r\n  messages: Message[];\r\n}\r\n\r\n/** Request to create a new conversation */\r\nexport interface CreateConversationRequest {\r\n  title?: string;\r\n  personaType?: PersonaType;\r\n  conceptId?: string;\r\n}\r\n\r\n/** Curriculum node from reference JSON */\r\nexport interface CurriculumNode {\r\n  id: string;           // slug identifier\r\n  parentId: string | null;\r\n  label: string;        // Serbian display name\r\n  sortOrder: number;\r\n}\r\n\r\n/** Hierarchical concept tree node (for sidebar) */\r\nexport interface ConceptHierarchyNode {\r\n  curriculumId: string;\r\n  label: string;\r\n  conceptId?: string;         // DB concept ID if created\r\n  children: ConceptHierarchyNode[];\r\n  conversationCount: number;  // Total conversations in this subtree\r\n  conversations: Conversation[];  // Direct conversations (only on leaf concepts)\r\n}\r\n\r\n/** Full concept tree structure for sidebar */\r\nexport interface ConceptTreeData {\r\n  tree: ConceptHierarchyNode[];  // Hierarchical (replaces old categories)\r\n  uncategorized: Conversation[];\r\n}\r\n\r\n// Legacy types kept for backward compatibility during migration\r\n/** @deprecated Use ConceptHierarchyNode instead */\r\nexport interface ConceptTreeCategory {\r\n  category: string;\r\n  concepts: ConceptTreeNode[];\r\n}\r\n\r\n/** @deprecated Use ConceptHierarchyNode instead */\r\nexport interface ConceptTreeNode {\r\n  conceptId: string;\r\n  conceptName: string;\r\n  conversations: Conversation[];\r\n}\r\n\r\n/** Response for single conversation */\r\nexport interface ConversationResponse {\r\n  data: ConversationWithMessages;\r\n}\r\n\r\n/** Response for conversation list */\r\nexport interface ConversationsListResponse {\r\n  data: Conversation[];\r\n}\r\n\r\n/** Request to send a message in a conversation */\r\nexport interface SendMessageRequest {\r\n  content: string;\r\n}\r\n\r\n/** WebSocket event: Client sends message to server */\r\nexport interface ChatMessageSend {\r\n  conversationId: string;\r\n  content: string;\r\n}\r\n\r\n/** WebSocket event: Server streams message chunk to client */\r\nexport interface ChatMessageChunk {\r\n  content: string;\r\n  index: number;\r\n}\r\n\r\n/** WebSocket event: Server signals message completion */\r\nexport interface ChatComplete {\r\n  messageId: string;\r\n  fullContent: string;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\n// ── AI Gateway Types (Story 2.2) ──\r\n// Types for rate limiting, token tracking, and circuit breaker\r\n\r\n/** Chat message format for AI conversations */\r\nexport interface ChatMessage {\r\n  role: 'user' | 'assistant' | 'system';\r\n  content: string;\r\n}\r\n\r\n/** Time period for usage queries */\r\nexport type UsagePeriod = 'day' | 'week' | 'month' | 'all';\r\n\r\n/** Rate limit headers for HTTP responses */\r\nexport interface RateLimitHeaders {\r\n  'X-RateLimit-Limit': string;\r\n  'X-RateLimit-Remaining': string;\r\n  'X-RateLimit-Reset': string;\r\n  'Retry-After'?: string;\r\n}\r\n\r\n/** Pricing structure for a model */\r\nexport interface ModelPricing {\r\n  /** Cost per 1000 input tokens in USD */\r\n  input: number;\r\n  /** Cost per 1000 output tokens in USD */\r\n  output: number;\r\n}\r\n\r\n/** Cost calculation result */\r\nexport interface CostCalculation {\r\n  /** Cost for input tokens */\r\n  inputCost: number;\r\n  /** Cost for output tokens */\r\n  outputCost: number;\r\n  /** Total cost */\r\n  totalCost: number;\r\n  /** Model ID used for calculation */\r\n  modelId: string;\r\n  /** Whether pricing was found for the model */\r\n  pricingFound: boolean;\r\n}\r\n\r\n/** Circuit breaker status information */\r\nexport interface CircuitBreakerStatus {\r\n  state: CircuitBreakerState;\r\n  failures: number;\r\n  lastFailure?: number;\r\n  lastSuccess?: number;\r\n  openedAt?: number;\r\n}\r\n\r\n/** Circuit breaker event for monitoring (alias for SystemCircuitBreaker) */\r\nexport type CircuitBreakerEvent = SystemCircuitBreaker;\r\n\r\n/** Token usage record for tracking AI consumption */\r\nexport interface TokenUsage {\r\n  id: string; // tku_ prefix\r\n  tenantId: string;\r\n  userId: string;\r\n  conversationId?: string;\r\n  inputTokens: number;\r\n  outputTokens: number;\r\n  totalTokens: number;\r\n  cost: number;\r\n  modelId: string;\r\n  providerId?: string;\r\n  createdAt: string;\r\n}\r\n\r\n/** Aggregated usage summary for reporting */\r\nexport interface UsageSummary {\r\n  totalTokens: number;\r\n  inputTokens: number;\r\n  outputTokens: number;\r\n  totalCost: number;\r\n  requestCount: number;\r\n}\r\n\r\n/** Rate limit information for responses */\r\nexport interface RateLimitInfo {\r\n  /** Whether the request is allowed */\r\n  allowed: boolean;\r\n  /** Maximum requests allowed in the window */\r\n  limit: number;\r\n  /** Remaining requests in the current window */\r\n  remaining: number;\r\n  /** Unix timestamp when the rate limit resets */\r\n  reset: number;\r\n  /** Retry-After value in seconds (only present when rate limited) */\r\n  retryAfter?: number;\r\n  /** Type of limit that was exceeded (tenant or user) */\r\n  limitType?: 'tenant' | 'user';\r\n}\r\n\r\n/** Quota status for a tenant */\r\nexport interface QuotaStatus {\r\n  /** Whether the request is allowed */\r\n  allowed: boolean;\r\n  /** Remaining tokens in quota */\r\n  remaining: number;\r\n  /** Total quota limit */\r\n  limit: number;\r\n  /** Tokens used so far */\r\n  used: number;\r\n  /** Percentage of quota used (0-100) */\r\n  percentUsed: number;\r\n}\r\n\r\n/** Circuit breaker states */\r\nexport enum CircuitBreakerState {\r\n  /** Normal operation - requests flow through */\r\n  CLOSED = 'CLOSED',\r\n  /** Circuit tripped - all requests rejected */\r\n  OPEN = 'OPEN',\r\n  /** Testing - allow one request to check if service recovered */\r\n  HALF_OPEN = 'HALF_OPEN',\r\n}\r\n\r\n/** WebSocket event: Queue position update */\r\nexport interface ChatQueuePosition {\r\n  position: number;\r\n  estimatedWait: number; // seconds\r\n  requestId: string;\r\n}\r\n\r\n/** WebSocket event: Circuit breaker state change */\r\nexport interface SystemCircuitBreaker {\r\n  eventId: string;\r\n  providerId: string;\r\n  previousState: CircuitBreakerState;\r\n  newState: CircuitBreakerState;\r\n  failures: number;\r\n  timestamp: number;\r\n  /** Correlation ID for request tracing */\r\n  correlationId?: string;\r\n}\r\n\r\n// ── Department Persona Types (Story 2.4) ──\r\n// Types for department-specific AI personas\r\n// NOTE: PersonaType intentionally mirrors the Prisma schema enum.\r\n// Prisma generates its own types from schema.prisma, but frontend cannot import @prisma/client.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** Persona type for department-specific AI responses */\r\nexport enum PersonaType {\r\n  CFO = 'CFO',\r\n  CMO = 'CMO',\r\n  CTO = 'CTO',\r\n  OPERATIONS = 'OPERATIONS',\r\n  LEGAL = 'LEGAL',\r\n  CREATIVE = 'CREATIVE',\r\n  CSO = 'CSO',\r\n  SALES = 'SALES',\r\n}\r\n\r\n/**\r\n * Persona colors for UI theming (dark mode compatible).\r\n * Single source of truth for persona color values.\r\n */\r\nexport const PERSONA_COLORS: Record<PersonaType, string> = {\r\n  [PersonaType.CFO]: '#10B981', // Emerald green (financial stability)\r\n  [PersonaType.CMO]: '#F59E0B', // Amber (energy, creativity)\r\n  [PersonaType.CTO]: '#3B82F6', // Blue (technology, trust)\r\n  [PersonaType.OPERATIONS]: '#8B5CF6', // Purple (efficiency, process)\r\n  [PersonaType.LEGAL]: '#6B7280', // Gray (neutrality, formality)\r\n  [PersonaType.CREATIVE]: '#EC4899', // Pink (creativity, innovation)\r\n  [PersonaType.CSO]: '#F97316', // Orange (strategy, vision)\r\n  [PersonaType.SALES]: '#06B6D4', // Cyan (sales, connection)\r\n};\r\n\r\n/**\r\n * Persona display names for UI.\r\n * Single source of truth for persona short names.\r\n */\r\nexport const PERSONA_NAMES: Record<PersonaType, string> = {\r\n  [PersonaType.CFO]: 'CFO',\r\n  [PersonaType.CMO]: 'CMO',\r\n  [PersonaType.CTO]: 'CTO',\r\n  [PersonaType.OPERATIONS]: 'COO',\r\n  [PersonaType.LEGAL]: 'Legal',\r\n  [PersonaType.CREATIVE]: 'Creative',\r\n  [PersonaType.CSO]: 'CSO',\r\n  [PersonaType.SALES]: 'Sales',\r\n};\r\n\r\n/** Department persona definition */\r\nexport interface Persona {\r\n  /** Unique persona identifier with prs_ prefix */\r\n  id: string;\r\n  /** Persona type enum value */\r\n  type: PersonaType;\r\n  /** Full persona name (e.g., \"Chief Financial Officer\") */\r\n  name: string;\r\n  /** Short name (e.g., \"CFO\") */\r\n  shortName: string;\r\n  /** Brief description of the persona's expertise */\r\n  description: string;\r\n  /** Path to the persona's avatar image */\r\n  avatarUrl: string;\r\n  /** Hex color code for UI theming */\r\n  color: string;\r\n}\r\n\r\n/** Persona system prompt configuration */\r\nexport interface PersonaSystemPrompt {\r\n  /** Persona type */\r\n  type: PersonaType;\r\n  /** System prompt for AI context (~500 tokens) */\r\n  systemPrompt: string;\r\n  /** List of capabilities */\r\n  capabilities: string[];\r\n  /** List of limitations */\r\n  limitations: string[];\r\n}\r\n\r\n/** Request to update conversation persona */\r\nexport interface UpdatePersonaRequest {\r\n  /** Persona type to set */\r\n  personaType: PersonaType;\r\n}\r\n\r\n/** Response containing all available personas */\r\nexport interface PersonasListResponse {\r\n  data: Persona[];\r\n}\r\n\r\n/** Response containing single persona */\r\nexport interface PersonaResponse {\r\n  data: Persona;\r\n}\r\n\r\n// ── Confidence Scoring Types (Story 2.5) ──\r\n// Types for AI response confidence scoring and improvement suggestions\r\n\r\n/** Confidence level thresholds */\r\nexport enum ConfidenceLevel {\r\n  /** High confidence: 85-100% */\r\n  HIGH = 'HIGH',\r\n  /** Medium confidence: 50-84% */\r\n  MEDIUM = 'MEDIUM',\r\n  /** Low confidence: 0-49% */\r\n  LOW = 'LOW',\r\n}\r\n\r\n/**\r\n * Confidence level colors for UI theming.\r\n * Single source of truth for confidence indicator colors.\r\n */\r\nexport const CONFIDENCE_COLORS: Record<ConfidenceLevel, string> = {\r\n  [ConfidenceLevel.HIGH]: '#22C55E', // Green\r\n  [ConfidenceLevel.MEDIUM]: '#EAB308', // Amber\r\n  [ConfidenceLevel.LOW]: '#EF4444', // Red\r\n};\r\n\r\n/** Individual factor contributing to confidence score */\r\nexport interface ConfidenceFactor {\r\n  /** Factor identifier (e.g., \"hedging_language\", \"context_depth\") */\r\n  name: string;\r\n  /** Factor score (0.0-1.0) */\r\n  score: number;\r\n  /** Factor contribution weight (should sum to 1.0 across all factors) */\r\n  weight: number;\r\n  /** Human-readable description of what this factor measures */\r\n  description?: string;\r\n}\r\n\r\n/** Complete confidence score with factor breakdown */\r\nexport interface ConfidenceScore {\r\n  /** Overall confidence score (0.0-1.0, display as percentage) */\r\n  score: number;\r\n  /** Categorized confidence level */\r\n  level: ConfidenceLevel;\r\n  /** Breakdown of individual factors */\r\n  factors: ConfidenceFactor[];\r\n  /** Actionable suggestion to improve confidence */\r\n  improvementSuggestion?: string;\r\n  /** Previous score for showing improvement delta */\r\n  previousScore?: number;\r\n}\r\n\r\n/** Improvement suggestion for low confidence responses */\r\nexport interface ImprovementSuggestion {\r\n  /** Category of missing context (e.g., \"missing_context\", \"ambiguous_question\") */\r\n  category: string;\r\n  /** User-facing actionable suggestion text */\r\n  suggestion: string;\r\n  /** Priority ranking (1 = highest) */\r\n  priority: number;\r\n}\r\n\r\n/** Context for confidence calculation */\r\nexport interface ConfidenceContext {\r\n  /** Number of messages in conversation history */\r\n  messageCount: number;\r\n  /** Whether client/project context is available */\r\n  hasClientContext: boolean;\r\n  /** Whether specific data points were provided */\r\n  hasSpecificData: boolean;\r\n  /** Active persona type */\r\n  personaType?: PersonaType;\r\n  /** User's original question */\r\n  userQuestion: string;\r\n}\r\n\r\n// ── Onboarding Types (Story 2.3) ──\r\n// Types for the sub-5-minute first value quick win onboarding flow\r\n\r\n/** Quick task for onboarding wizard */\r\nexport interface QuickTask {\r\n  /** Unique task identifier */\r\n  id: string;\r\n  /** Display name for the task */\r\n  name: string;\r\n  /** Brief description of what the task produces */\r\n  description: string;\r\n  /** Department this task is associated with */\r\n  department: Department;\r\n  /** Estimated time this task saves the user (in minutes) */\r\n  estimatedTimeSaved: number;\r\n}\r\n\r\n/** Onboarding wizard status */\r\nexport interface OnboardingStatus {\r\n  /** Current wizard step (1, 2, 3, or 'complete') */\r\n  currentStep: 1 | 2 | 3 | 'complete';\r\n  /** Current tenant status */\r\n  tenantStatus: TenantStatus;\r\n  /** Selected industry/department from step 1 */\r\n  selectedIndustry?: string;\r\n  /** Selected task ID from step 2 */\r\n  selectedTaskId?: string;\r\n  /** Timestamp when onboarding started (ISO string) */\r\n  startedAt?: string;\r\n}\r\n\r\n/** Request to execute quick win task */\r\nexport interface QuickWinRequest {\r\n  /** Selected task ID */\r\n  taskId: string;\r\n  /** User-provided context for the task (max 280 chars) */\r\n  userContext: string;\r\n  /** Selected industry/department */\r\n  industry: string;\r\n}\r\n\r\n/** Response from quick win execution */\r\nexport interface QuickWinResponse {\r\n  /** Generated AI output */\r\n  output: string;\r\n  /** Time taken to generate (in milliseconds) */\r\n  generationTimeMs: number;\r\n  /** Token usage for this request */\r\n  tokensUsed: number;\r\n}\r\n\r\n/** Request to complete onboarding and save first note */\r\nexport interface OnboardingCompleteRequest {\r\n  /** Selected task ID */\r\n  taskId: string;\r\n  /** User-provided context */\r\n  userContext: string;\r\n  /** Selected industry */\r\n  industry: string;\r\n  /** Generated output to save as note */\r\n  generatedOutput: string;\r\n}\r\n\r\n/** Response after completing onboarding */\r\nexport interface OnboardingCompleteResponse {\r\n  /** Saved note content */\r\n  output: string;\r\n  /** Estimated time saved (in minutes) */\r\n  timeSavedMinutes: number;\r\n  /** ID of the saved note (if applicable) */\r\n  noteId?: string;\r\n  /** Celebration message to display */\r\n  celebrationMessage: string;\r\n  /** New tenant status (should be ACTIVE) */\r\n  newTenantStatus: TenantStatus;\r\n  /** ID of the welcome conversation created with task list */\r\n  welcomeConversationId?: string;\r\n  /** Execution mode selected during onboarding */\r\n  executionMode?: ExecutionMode;\r\n}\r\n\r\n/** Onboarding metric for analytics */\r\nexport interface OnboardingMetricResponse {\r\n  /** Metric record ID */\r\n  id: string;\r\n  /** Tenant ID */\r\n  tenantId: string;\r\n  /** User ID */\r\n  userId: string;\r\n  /** When onboarding started */\r\n  startedAt: string;\r\n  /** When onboarding completed (null if not complete) */\r\n  completedAt: string | null;\r\n  /** Time to first value in milliseconds */\r\n  timeToFirstValueMs: number | null;\r\n  /** Quick task type used */\r\n  quickTaskType: string;\r\n  /** Industry selected */\r\n  industry: string;\r\n}\r\n\r\n// ── Business Concept Types (Story 3.1) ──\r\n// Types for the business concepts knowledge base\r\n// NOTE: RelationshipType and ConceptCategory intentionally mirror the Prisma schema.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** Category for business concepts (matches departments) */\r\nexport enum ConceptCategory {\r\n  FINANCE = 'Finance',\r\n  MARKETING = 'Marketing',\r\n  TECHNOLOGY = 'Technology',\r\n  OPERATIONS = 'Operations',\r\n  LEGAL = 'Legal',\r\n  CREATIVE = 'Creative',\r\n  STRATEGY = 'Strategy',\r\n  SALES = 'Sales',\r\n}\r\n\r\n/** Relationship type between concepts */\r\nexport enum RelationshipType {\r\n  /** Must understand this concept first */\r\n  PREREQUISITE = 'PREREQUISITE',\r\n  /** Related topic */\r\n  RELATED = 'RELATED',\r\n  /** Deeper dive on this topic */\r\n  ADVANCED = 'ADVANCED',\r\n}\r\n\r\n/** Source tracking for how a concept was created (Story 2.15) */\r\nexport enum ConceptSource {\r\n  /** Pre-loaded from seed JSON files */\r\n  SEED_DATA = 'SEED_DATA',\r\n  /** Created via curriculum tree UI */\r\n  CURRICULUM = 'CURRICULUM',\r\n  /** Automatically extracted from AI output */\r\n  AI_DISCOVERED = 'AI_DISCOVERED',\r\n}\r\n\r\n/** Business concept entity */\r\nexport interface Concept {\r\n  /** Unique identifier with cpt_ prefix */\r\n  id: string;\r\n  /** Concept name (unique) */\r\n  name: string;\r\n  /** URL-friendly version of name */\r\n  slug: string;\r\n  /** Category (Finance, Marketing, etc.) */\r\n  category: ConceptCategory;\r\n  /** Brief definition (2-3 sentences) */\r\n  definition: string;\r\n  /** Extended description (full explanation) */\r\n  extendedDescription?: string;\r\n  /** Department tags for filtering */\r\n  departmentTags: string[];\r\n  /** Qdrant vector ID for semantic search */\r\n  embeddingId?: string;\r\n  /** How the concept was created (Story 2.15) */\r\n  source?: ConceptSource;\r\n  /** Version number for tracking updates */\r\n  version: number;\r\n  /** Parent concept ID for hierarchy */\r\n  parentId?: string | null;\r\n  /** Display order among siblings */\r\n  sortOrder?: number;\r\n  /** Links to curriculum.json id */\r\n  curriculumId?: string | null;\r\n  /** Creation timestamp */\r\n  createdAt: string;\r\n  /** Last update timestamp */\r\n  updatedAt: string;\r\n}\r\n\r\n/** Relationship between two concepts */\r\nexport interface ConceptRelationship {\r\n  /** Unique identifier */\r\n  id: string;\r\n  /** Source concept ID */\r\n  sourceConceptId: string;\r\n  /** Target concept ID */\r\n  targetConceptId: string;\r\n  /** Type of relationship */\r\n  relationshipType: RelationshipType;\r\n  /** Creation timestamp */\r\n  createdAt: string;\r\n}\r\n\r\n/** Concept with related concepts included */\r\nexport interface ConceptWithRelations extends Concept {\r\n  /** Related concepts from both directions */\r\n  relatedConcepts: Array<{\r\n    /** The related concept */\r\n    concept: Concept;\r\n    /** Type of relationship */\r\n    relationshipType: RelationshipType;\r\n    /** Direction: 'outgoing' if this concept points to it, 'incoming' if it points to this */\r\n    direction: 'outgoing' | 'incoming';\r\n  }>;\r\n}\r\n\r\n/** Result of dynamic relationship creation for a newly discovered concept */\r\nexport interface DynamicRelationshipResult {\r\n  /** The concept ID relationships were created for */\r\n  conceptId: string;\r\n  /** The concept name */\r\n  conceptName: string;\r\n  /** Number of relationships successfully created */\r\n  relationshipsCreated: number;\r\n  /** Any non-fatal errors encountered */\r\n  errors: string[];\r\n}\r\n\r\n/** Result of AI-driven concept extraction from text (Story 2.15) */\r\nexport interface ConceptExtractionResult {\r\n  /** Concepts successfully created in the database */\r\n  created: ConceptSummary[];\r\n  /** Concept names that were skipped as duplicates */\r\n  skippedDuplicates: string[];\r\n  /** Non-fatal errors encountered during extraction */\r\n  errors: string[];\r\n}\r\n\r\n/** Summary view of a concept for listings and side panels */\r\nexport interface ConceptSummary {\r\n  /** Unique identifier with cpt_ prefix */\r\n  id: string;\r\n  /** Concept name */\r\n  name: string;\r\n  /** URL-friendly slug */\r\n  slug: string;\r\n  /** Category */\r\n  category: ConceptCategory;\r\n  /** Brief definition */\r\n  definition: string;\r\n}\r\n\r\n/** Seed data format for a single concept */\r\nexport interface ConceptSeedData {\r\n  /** Concept name */\r\n  name: string;\r\n  /** URL-friendly slug */\r\n  slug: string;\r\n  /** Category */\r\n  category: string;\r\n  /** Brief definition */\r\n  definition: string;\r\n  /** Extended description */\r\n  extendedDescription?: string;\r\n  /** Department tags */\r\n  departmentTags: string[];\r\n  /** Related concepts with relationship type */\r\n  relatedConcepts?: Array<{\r\n    /** Slug of related concept */\r\n    slug: string;\r\n    /** Type of relationship */\r\n    type: RelationshipType;\r\n  }>;\r\n}\r\n\r\n/** Request for listing concepts with optional filters */\r\nexport interface ConceptsListRequest {\r\n  /** Filter by category */\r\n  category?: ConceptCategory;\r\n  /** Search query for name/definition */\r\n  search?: string;\r\n  /** Page number (1-indexed) */\r\n  page?: number;\r\n  /** Items per page */\r\n  limit?: number;\r\n}\r\n\r\n/** Response for concept listing */\r\nexport interface ConceptsListResponse {\r\n  data: ConceptSummary[];\r\n  meta: PaginationMeta;\r\n}\r\n\r\n/** Response for single concept with relations */\r\nexport interface ConceptResponse {\r\n  data: ConceptWithRelations;\r\n}\r\n\r\n/** Response for related concepts of a concept */\r\nexport interface ConceptRelationsResponse {\r\n  data: Array<{\r\n    concept: ConceptSummary;\r\n    relationshipType: RelationshipType;\r\n    direction: 'outgoing' | 'incoming';\r\n  }>;\r\n}\r\n\r\n// ── Concept Citation Types (Story 2.6) ──\r\n// Types for linking AI responses to business concepts\r\n\r\n/** Citation of a business concept in an AI message */\r\nexport interface ConceptCitation {\r\n  /** Unique identifier with cit_ prefix */\r\n  id: string;\r\n  /** Message ID this citation belongs to */\r\n  messageId: string;\r\n  /** Concept ID being cited */\r\n  conceptId: string;\r\n  /** Concept name (denormalized for display) */\r\n  conceptName: string;\r\n  /** Concept category for styling */\r\n  conceptCategory: ConceptCategory;\r\n  /** Character position in message where citation appears */\r\n  position: number;\r\n  /** Semantic similarity score (0.0-1.0) */\r\n  score: number;\r\n  /** Creation timestamp */\r\n  createdAt: string;\r\n}\r\n\r\n/** Concept match result from semantic search */\r\nexport interface ConceptMatch {\r\n  /** Concept ID */\r\n  conceptId: string;\r\n  /** Concept name */\r\n  conceptName: string;\r\n  /** Concept category */\r\n  category: ConceptCategory;\r\n  /** Concept definition for display */\r\n  definition: string;\r\n  /** Semantic similarity score (0.0-1.0) */\r\n  score: number;\r\n}\r\n\r\n/** Result of citation injection into a response */\r\nexport interface CitationInjectionResult {\r\n  /** Content with [[Concept Name]] citations injected */\r\n  content: string;\r\n  /** List of citations that were injected */\r\n  citations: ConceptCitation[];\r\n}\r\n\r\n/** Response for message citations endpoint */\r\nexport interface MessageCitationsResponse {\r\n  data: ConceptCitation[];\r\n}\r\n\r\n/** Concept summary for citation side panel */\r\nexport interface ConceptCitationSummary {\r\n  /** Concept ID */\r\n  id: string;\r\n  /** Concept name */\r\n  name: string;\r\n  /** Concept category */\r\n  category: ConceptCategory;\r\n  /** Brief definition (2-3 sentences) */\r\n  definition: string;\r\n  /** Full educational content */\r\n  extendedDescription?: string;\r\n  /** Related concepts for exploration */\r\n  relatedConcepts: Array<{ id: string; name: string }>;\r\n}\r\n\r\n// ── Persistent Memory Types (Story 2.7) ──\r\n// Types for AI memory persistence across conversations\r\n// NOTE: MemoryType and MemorySource intentionally mirror the Prisma schema enums.\r\n// Keep values in sync with apps/api/prisma/schema.prisma.\r\n\r\n/** Type of memory stored */\r\nexport enum MemoryType {\r\n  /** Context about a specific client */\r\n  CLIENT_CONTEXT = 'CLIENT_CONTEXT',\r\n  /** Context about a specific project */\r\n  PROJECT_CONTEXT = 'PROJECT_CONTEXT',\r\n  /** User preferences and working style */\r\n  USER_PREFERENCE = 'USER_PREFERENCE',\r\n  /** General factual statements */\r\n  FACTUAL_STATEMENT = 'FACTUAL_STATEMENT',\r\n}\r\n\r\n/** Source of the memory */\r\nexport enum MemorySource {\r\n  /** Automatically extracted from conversation by AI */\r\n  AI_EXTRACTED = 'AI_EXTRACTED',\r\n  /** Explicitly stated by user */\r\n  USER_STATED = 'USER_STATED',\r\n  /** Corrected by user after AI extraction */\r\n  USER_CORRECTED = 'USER_CORRECTED',\r\n}\r\n\r\n/**\r\n * Memory type colors for UI theming.\r\n * Single source of truth for memory type indicator colors.\r\n */\r\nexport const MEMORY_TYPE_COLORS: Record<MemoryType, string> = {\r\n  [MemoryType.CLIENT_CONTEXT]: '#3B82F6', // Blue (business relationships)\r\n  [MemoryType.PROJECT_CONTEXT]: '#8B5CF6', // Purple (project work)\r\n  [MemoryType.USER_PREFERENCE]: '#10B981', // Emerald (personal)\r\n  [MemoryType.FACTUAL_STATEMENT]: '#6B7280', // Gray (neutral facts)\r\n};\r\n\r\n/**\r\n * Memory type display labels.\r\n * Single source of truth for memory type names.\r\n */\r\nexport const MEMORY_TYPE_LABELS: Record<MemoryType, string> = {\r\n  [MemoryType.CLIENT_CONTEXT]: 'Client',\r\n  [MemoryType.PROJECT_CONTEXT]: 'Project',\r\n  [MemoryType.USER_PREFERENCE]: 'Preference',\r\n  [MemoryType.FACTUAL_STATEMENT]: 'Fact',\r\n};\r\n\r\n/** Persistent memory entity */\r\nexport interface Memory {\r\n  /** Unique identifier with mem_ prefix */\r\n  id: string;\r\n  /** Tenant ID for isolation */\r\n  tenantId: string;\r\n  /** User ID who owns this memory */\r\n  userId: string;\r\n  /** Type of memory */\r\n  type: MemoryType;\r\n  /** How the memory was created */\r\n  source: MemorySource;\r\n  /** The actual memory content */\r\n  content: string;\r\n  /** Subject name (client, project, or topic) */\r\n  subject?: string;\r\n  /** Extraction/confidence score (0.0-1.0) */\r\n  confidence: number;\r\n  /** Qdrant vector ID for semantic search */\r\n  embeddingId?: string;\r\n  /** Original message this was extracted from */\r\n  sourceMessageId?: string;\r\n  /** Whether this memory has been soft-deleted */\r\n  isDeleted: boolean;\r\n  /** When the memory was deleted (if applicable) */\r\n  deletedAt?: string;\r\n  /** Creation timestamp */\r\n  createdAt: string;\r\n  /** Last update timestamp */\r\n  updatedAt: string;\r\n}\r\n\r\n/** Memory attribution displayed in AI responses */\r\nexport interface MemoryAttribution {\r\n  /** Memory ID (mem_ prefix) */\r\n  memoryId: string;\r\n  /** Subject name (e.g., \"Acme Corp\", \"Project Phoenix\") */\r\n  subject: string;\r\n  /** Brief summary of the memory content */\r\n  summary: string;\r\n  /** Type of memory */\r\n  type: MemoryType;\r\n}\r\n\r\n/** Request to create a new memory */\r\nexport interface CreateMemoryDto {\r\n  /** Type of memory */\r\n  type: MemoryType;\r\n  /** Source of the memory */\r\n  source: MemorySource;\r\n  /** The memory content */\r\n  content: string;\r\n  /** Subject name (optional) */\r\n  subject?: string;\r\n  /** Confidence score (optional, defaults to 1.0) */\r\n  confidence?: number;\r\n  /** Source message ID (optional) */\r\n  sourceMessageId?: string;\r\n}\r\n\r\n/** Request to update/correct a memory */\r\nexport interface UpdateMemoryDto {\r\n  /** Updated content */\r\n  content: string;\r\n  /** Source will be set to USER_CORRECTED automatically */\r\n  source?: MemorySource;\r\n}\r\n\r\n/** Memory with pagination for list views */\r\nexport interface MemoryListResponse {\r\n  data: Memory[];\r\n  meta: {\r\n    total: number;\r\n    limit: number;\r\n    offset: number;\r\n  };\r\n}\r\n\r\n/** Response for single memory operations */\r\nexport interface MemoryResponse {\r\n  data: Memory;\r\n}\r\n\r\n/** Response for memory deletion */\r\nexport interface MemoryDeleteResponse {\r\n  success: boolean;\r\n  message: string;\r\n}\r\n\r\n/** Request to forget all memories (with confirmation) */\r\nexport interface ForgetAllMemoriesRequest {\r\n  /** User must type \"FORGET\" to confirm */\r\n  confirmation: string;\r\n}\r\n\r\n/** Extended completion result with memory attributions */\r\nexport interface CompletionResultWithMemory {\r\n  /** The AI response content */\r\n  content: string;\r\n  /** Token usage for this completion */\r\n  tokenUsage: TokenUsage;\r\n  /** Confidence score for the response */\r\n  confidenceScore?: ConfidenceScore;\r\n  /** Memory attributions used in this response */\r\n  memoryAttributions?: MemoryAttribution[];\r\n  /** Concept citations in the response */\r\n  citations?: ConceptCitation[];\r\n}\r\n\r\n// ── Notes/Tasks Types ──\r\n// Types for the conversation notes and task tracking system\r\n\r\n/** Note type classification */\r\nexport enum NoteType {\r\n  TASK = 'TASK',\r\n  NOTE = 'NOTE',\r\n  SUMMARY = 'SUMMARY',\r\n}\r\n\r\n/** Task completion status */\r\nexport enum NoteStatus {\r\n  PENDING = 'PENDING',\r\n  READY_FOR_REVIEW = 'READY_FOR_REVIEW',\r\n  COMPLETED = 'COMPLETED',\r\n}\r\n\r\n/** Note/task item */\r\nexport interface NoteItem {\r\n  id: string;\r\n  title: string;\r\n  content: string;\r\n  source: 'ONBOARDING' | 'CONVERSATION' | 'MANUAL';\r\n  noteType: NoteType;\r\n  status: NoteStatus | null;\r\n  conversationId: string | null;\r\n  conceptId: string | null;\r\n  messageId: string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  parentNoteId: string | null;\r\n  children?: NoteItem[];\r\n  userReport: string | null;\r\n  aiScore: number | null;\r\n  aiFeedback: string | null;\r\n  expectedOutcome: string | null;\r\n  workflowStepNumber: number | null;\r\n}\r\n\r\n/** Request to create a note */\r\nexport interface CreateNoteRequest {\r\n  title: string;\r\n  content: string;\r\n  noteType?: NoteType;\r\n  status?: NoteStatus;\r\n  conversationId?: string;\r\n  conceptId?: string;\r\n}\r\n\r\n/** Request to update a note */\r\nexport interface UpdateNoteRequest {\r\n  title?: string;\r\n  content?: string;\r\n}\r\n\r\n/** Request to update note/task status */\r\nexport interface UpdateNoteStatusRequest {\r\n  status: NoteStatus;\r\n}\r\n\r\n/** Response containing notes list */\r\nexport interface NotesListResponse {\r\n  data: NoteItem[];\r\n}\r\n\r\n// ── Workflow & Agent Execution ──\r\n\r\n/** A single step in a concept workflow (generated by LLM, cached in DB) */\r\nexport interface WorkflowStep {\r\n  stepNumber: number;\r\n  title: string;\r\n  description: string;\r\n  promptTemplate: string;\r\n  expectedOutcome: string;\r\n  estimatedMinutes: number;\r\n  departmentTag?: string;\r\n}\r\n\r\n/** A step in an execution plan (derived from WorkflowStep + concept metadata) */\r\nexport interface ExecutionPlanStep {\r\n  stepId: string;\r\n  conceptId: string;\r\n  conceptName: string;\r\n  workflowStepNumber: number;\r\n  title: string;\r\n  description: string;\r\n  estimatedMinutes: number;\r\n  departmentTag?: string;\r\n  status: 'pending' | 'in_progress' | 'completed' | 'failed';\r\n}\r\n\r\n/** Full execution plan for a set of selected tasks */\r\nexport interface ExecutionPlan {\r\n  planId: string;\r\n  taskIds: string[];\r\n  steps: ExecutionPlanStep[];\r\n  totalEstimatedMinutes: number;\r\n  conceptOrder: string[];\r\n  status: 'awaiting_approval' | 'executing' | 'completed' | 'cancelled' | 'failed';\r\n  createdAt: string;\r\n}\r\n\r\n/** WebSocket payload: plan ready for user approval */\r\nexport interface WorkflowPlanReadyPayload {\r\n  plan: ExecutionPlan;\r\n  conversationId: string;\r\n}\r\n\r\n/** WebSocket payload: step execution progress */\r\nexport interface WorkflowStepProgressPayload {\r\n  planId: string;\r\n  stepId: string;\r\n  stepTitle?: string;\r\n  stepIndex?: number;\r\n  totalSteps?: number;\r\n  status: 'in_progress' | 'completed' | 'failed';\r\n  content?: string;\r\n  citations?: ConceptCitation[];\r\n  conversationId: string;\r\n}\r\n\r\n/** WebSocket payload: workflow execution complete */\r\nexport interface WorkflowCompletePayload {\r\n  planId: string;\r\n  status: 'completed' | 'cancelled' | 'failed';\r\n  completedSteps: number;\r\n  totalSteps: number;\r\n  conversationId: string;\r\n}\r\n\r\n/** WebSocket payload: per-concept conversations created for workflow execution */\r\nexport interface WorkflowConversationsCreatedPayload {\r\n  planId: string;\r\n  conversations: Array<{ conceptId: string; conceptName: string; conversationId: string }>;\r\n  originalConversationId: string;\r\n}\r\n\r\n/** WebSocket payload: workflow error */\r\nexport interface WorkflowErrorPayload {\r\n  planId?: string;\r\n  message: string;\r\n  conversationId: string;\r\n}\r\n\r\n/** WebSocket payload: step awaiting user confirmation before continuing */\r\nexport interface WorkflowStepConfirmationPayload {\r\n  planId: string;\r\n  completedStepId: string;\r\n  nextStep: {\r\n    stepId: string;\r\n    title: string;\r\n    description: string;\r\n    conceptName: string;\r\n    stepIndex: number;\r\n    totalSteps: number;\r\n  };\r\n  conversationId: string;\r\n}\r\n\r\n/** Discriminator for workflow step interaction type */\r\nexport type WorkflowStepInputType = 'text' | 'confirmation';\r\n\r\n/** WebSocket payload: step awaiting user input (text or confirmation) */\r\nexport interface WorkflowStepAwaitingInputPayload {\r\n  planId: string;\r\n  stepId: string;\r\n  stepTitle: string;\r\n  stepDescription: string;\r\n  conceptName: string;\r\n  stepIndex: number;\r\n  totalSteps: number;\r\n  inputType: WorkflowStepInputType;\r\n  conversationId: string;\r\n}\r\n\r\n/** WebSocket payload: complete workflow step message for chat rendering */\r\nexport interface WorkflowStepMessagePayload {\r\n  planId: string;\r\n  conversationId: string;\r\n  messageId: string;\r\n  content: string;\r\n  stepIndex: number;\r\n  totalSteps: number;\r\n  inputType: WorkflowStepInputType;\r\n  conceptName: string;\r\n}\r\n\r\n/** WebSocket payload: navigate to a specific conversation for workflow execution */\r\nexport interface WorkflowNavigatePayload {\r\n  planId: string;\r\n  conversationId: string;\r\n  conceptName: string;\r\n}\r\n\r\n// ─── YOLO Autonomous Execution ──────────────────────────────────\r\n\r\nexport type ExecutionMode = 'MANUAL' | 'YOLO';\r\n\r\nexport interface YoloConfig {\r\n  maxConcurrency: number;\r\n  maxConceptsHardStop: number;\r\n  retryAttempts: number;\r\n  retryBaseDelayMs?: number;      // Exponential backoff base (default 5000ms)\r\n  circuitBreakerCooldownMs?: number; // Pause after consecutive failures (default 30000ms)\r\n}\r\n\r\nexport interface YoloProgressPayload {\r\n  planId: string;\r\n  running: number;\r\n  maxConcurrency: number;\r\n  completed: number;\r\n  failed: number;\r\n  total: number;\r\n  discoveredCount: number;\r\n  currentTasks: Array<{\r\n    conceptName: string;\r\n    status: string;\r\n    /** Current workflow step title (e.g., \"Market Analysis\") */\r\n    currentStep?: string;\r\n    /** Zero-based index of current step within the workflow */\r\n    currentStepIndex?: number;\r\n    /** Total number of steps in this task's workflow */\r\n    totalSteps?: number;\r\n  }>;\r\n  /** Last N log entries from the YOLO activity log */\r\n  recentLogs?: string[];\r\n  conversationId: string;\r\n}\r\n\r\n// ── Web Search Types (Story 2.14) ──\r\n\r\n/** Enriched search result with optional full page content */\r\nexport interface EnrichedSearchResult {\r\n  title: string;\r\n  link: string;\r\n  snippet: string;\r\n  /** Extracted page content (truncated), if deep fetch succeeded */\r\n  pageContent?: string;\r\n  /** Timestamp when the result was fetched */\r\n  fetchedAt: string;\r\n}\r\n\r\nexport interface YoloCompletePayload {\r\n  planId: string;\r\n  status: 'completed' | 'failed' | 'hard-stopped';\r\n  completed: number;\r\n  failed: number;\r\n  total: number;\r\n  discoveredCount: number;\r\n  durationMs: number;\r\n  conversationId: string;\r\n  /** Final log entries from the YOLO execution */\r\n  logs?: string[];\r\n}\r\n"],"names":["CONFIDENCE_COLORS","INDUSTRIES","MEMORY_TYPE_COLORS","MEMORY_TYPE_LABELS","PERSONA_COLORS","PERSONA_NAMES","InvitationStatus","Department","ExportFormat","ExportStatus","TenantStatus","LlmProviderType","MessageRole","CircuitBreakerState","PersonaType","ConfidenceLevel","ConceptCategory","RelationshipType","ConceptSource","MemoryType","MemorySource","NoteType","NoteStatus"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA;;;CAGC,GAED,mCAAmC;;;;;;;;;;;IAusBtBA,iBAAiB;eAAjBA;;;;;;;;;;;;;;;;;;;;;;;IAzoBAC,UAAU;eAAVA;;;;;;;;IAokCAC,kBAAkB;eAAlBA;;IAWAC,kBAAkB;eAAlBA;;;;;;;;;;;;;;;;;IA/hBAC,cAAc;eAAdA;;IAeAC,aAAa;eAAbA;;;;;;;;;;;;;UAnlBDC;;;;;GAAAA,qBAAAA;;UAQAC;;;;;;;;;GAAAA,eAAAA;AAYL,MAAMN,aAAa;IACxB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;;UA+EWO;;;;GAAAA,iBAAAA;;UAOAC;;;;;;GAAAA,iBAAAA;;UAyCAC;;;;;;;GAAAA,iBAAAA;;UAuCAC;;;;;GAAAA,oBAAAA;;UA6FAC;;;GAAAA,gBAAAA;;UAoOAC;IACV,6CAA6C;IAE7C,4CAA4C;IAE5C,8DAA8D;GALpDA,wBAAAA;;UAmCAC;;;;;;;;;GAAAA,gBAAAA;AAeL,MAAMV,iBAA8C;IACzD,OAAiB,EAAE;IACnB,OAAiB,EAAE;IACnB,OAAiB,EAAE;IACnB,cAAwB,EAAE;IAC1B,SAAmB,EAAE;IACrB,YAAsB,EAAE;IACxB,OAAiB,EAAE;IACnB,SAAmB,EAAE;AACvB;AAMO,MAAMC,gBAA6C;IACxD,OAAiB,EAAE;IACnB,OAAiB,EAAE;IACnB,OAAiB,EAAE;IACnB,cAAwB,EAAE;IAC1B,SAAmB,EAAE;IACrB,YAAsB,EAAE;IACxB,OAAiB,EAAE;IACnB,SAAmB,EAAE;AACvB;;UAoDYU;IACV,6BAA6B;IAE7B,8BAA8B;IAE9B,0BAA0B;GALhBA,oBAAAA;AAaL,MAAMf,oBAAqD;IAChE,QAAsB,EAAE;IACxB,UAAwB,EAAE;IAC1B,OAAqB,EAAE;AACzB;;UA+JYgB;;;;;;;;;GAAAA,oBAAAA;;UAYAC;IACV,uCAAuC;IAEvC,kBAAkB;IAElB,8BAA8B;GALpBA,qBAAAA;;UAUAC;IACV,oCAAoC;IAEpC,mCAAmC;IAEnC,2CAA2C;GALjCA,kBAAAA;;UAyOAC;IACV,oCAAoC;IAEpC,qCAAqC;IAErC,uCAAuC;IAEvC,+BAA+B;GAPrBA,eAAAA;;UAYAC;IACV,oDAAoD;IAEpD,8BAA8B;IAE9B,0CAA0C;GALhCA,iBAAAA;AAaL,MAAMlB,qBAAiD;IAC5D,kBAA2B,EAAE;IAC7B,mBAA4B,EAAE;IAC9B,mBAA4B,EAAE;IAC9B,qBAA8B,EAAE;AAClC;AAMO,MAAMC,qBAAiD;IAC5D,kBAA2B,EAAE;IAC7B,mBAA4B,EAAE;IAC9B,mBAA4B,EAAE;IAC9B,qBAA8B,EAAE;AAClC;;UAmHYkB;;;;GAAAA,aAAAA;;UAOAC;;;;GAAAA,eAAAA"}