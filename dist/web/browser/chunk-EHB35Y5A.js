import{d as yn,e as wn,f as Pn,g as Sn}from"./chunk-S6LNR5CA.js";import{c as En,e as Mn,g as Tn,q as rt}from"./chunk-ATNIHN2O.js";import{a as Ce,b as kn}from"./chunk-BTP5US75.js";import{a as Rt}from"./chunk-HXP2IP54.js";import{$ as _e,A as C,Aa as y,B as x,Ba as T,C as w,Ca as se,D as F,Da as it,Ea as gn,F as un,Fa as fn,Ga as _n,I as v,Ia as ye,J as Je,K as mn,L as hn,La as oe,Oa as z,P as et,Pa as N,R as a,V as U,Va as Y,Za as re,a as L,aa as f,b as Z,ba as _,bb as Cn,c as Mo,ca as tt,cb as xn,da as nt,ea as j,eb as bn,fa as G,fb as vn,ga as X,ha as p,i as B,ia as h,ja as E,ka as u,la as m,ma as I,na as P,oa as Q,pa as R,qa as S,ra as l,sa as ot,ta as ve,ua as ke,v as fe,wa as H,xa as A,y as W,ya as Ee,za as c}from"./chunk-4VSIGE6D.js";var Me=class n{http=W(re);baseUrl=`${Ce.apiUrl}/api/v1/conversations`;isCreating$=v(!1);async createConversation(t,e,o,i){this.isCreating$.set(!0);try{return(await B(this.http.post(this.baseUrl,{title:t,personaType:e,conceptId:o,curriculumId:i}))).data}finally{this.isCreating$.set(!1)}}async updatePersona(t,e){return(await B(this.http.patch(`${this.baseUrl}/${t}/persona`,{personaType:e}))).data}async getConversations(){return(await B(this.http.get(this.baseUrl))).data}async getConversation(t){return(await B(this.http.get(`${this.baseUrl}/${t}`))).data}async deleteConversation(t){await B(this.http.delete(`${this.baseUrl}/${t}`))}async getGroupedConversations(){return(await B(this.http.get(`${this.baseUrl}/grouped`))).data}static \u0275fac=function(e){return new(e||n)};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})};var le=Object.create(null);le.open="0";le.close="1";le.ping="2";le.pong="3";le.message="4";le.upgrade="5";le.noop="6";var De=Object.create(null);Object.keys(le).forEach(n=>{De[le[n]]=n});var Le={type:"error",data:"parser error"};var $n=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Nn=typeof ArrayBuffer=="function",An=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Ve=({type:n,data:t},e,o)=>$n&&t instanceof Blob?e?o(t):On(t,o):Nn&&(t instanceof ArrayBuffer||An(t))?e?o(t):On(new Blob([t]),o):o(le[n]+(t||"")),On=(n,t)=>{let e=new FileReader;return e.onload=function(){let o=e.result.split(",")[1];t("b"+(o||""))},e.readAsDataURL(n)};function In(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}var Dt;function Rn(n,t){if($n&&n.data instanceof Blob)return n.data.arrayBuffer().then(In).then(t);if(Nn&&(n.data instanceof ArrayBuffer||An(n.data)))return t(In(n.data));Ve(n,!1,e=>{Dt||(Dt=new TextEncoder),t(Dt.encode(e))})}var Dn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Dn.length;n++)Fe[Dn.charCodeAt(n)]=n;var Ln=n=>{let t=n.length*.75,e=n.length,o,i=0,r,s,g,d;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);let k=new ArrayBuffer(t),b=new Uint8Array(k);for(o=0;o<e;o+=4)r=Fe[n.charCodeAt(o)],s=Fe[n.charCodeAt(o+1)],g=Fe[n.charCodeAt(o+2)],d=Fe[n.charCodeAt(o+3)],b[i++]=r<<2|s>>4,b[i++]=(s&15)<<4|g>>2,b[i++]=(g&3)<<6|d&63;return k};var To=typeof ArrayBuffer=="function",ze=(n,t)=>{if(typeof n!="string")return{type:"message",data:Vn(n,t)};let e=n.charAt(0);return e==="b"?{type:"message",data:Oo(n.substring(1),t)}:De[e]?n.length>1?{type:De[e],data:n.substring(1)}:{type:De[e]}:Le},Oo=(n,t)=>{if(To){let e=Ln(n);return Vn(e,t)}else return{base64:!0,data:n}},Vn=(n,t)=>t==="blob"?n instanceof Blob?n:new Blob([n]):n instanceof ArrayBuffer?n:n.buffer;var Fn="",zn=(n,t)=>{let e=n.length,o=new Array(e),i=0;n.forEach((r,s)=>{Ve(r,!1,g=>{o[s]=g,++i===e&&t(o.join(Fn))})})},Bn=(n,t)=>{let e=n.split(Fn),o=[];for(let i=0;i<e.length;i++){let r=ze(e[i],t);if(o.push(r),r.type==="error")break}return o};function Wn(){return new TransformStream({transform(n,t){Rn(n,e=>{let o=e.length,i;if(o<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,o);else if(o<65536){i=new Uint8Array(3);let r=new DataView(i.buffer);r.setUint8(0,126),r.setUint16(1,o)}else{i=new Uint8Array(9);let r=new DataView(i.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(o))}n.data&&typeof n.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(e)})}})}var Lt;function at(n){return n.reduce((t,e)=>t+e.length,0)}function st(n,t){if(n[0].length===t)return n.shift();let e=new Uint8Array(t),o=0;for(let i=0;i<t;i++)e[i]=n[0][o++],o===n[0].length&&(n.shift(),o=0);return n.length&&o<n[0].length&&(n[0]=n[0].slice(o)),e}function Hn(n,t){Lt||(Lt=new TextDecoder);let e=[],o=0,i=-1,r=!1;return new TransformStream({transform(s,g){for(e.push(s);;){if(o===0){if(at(e)<1)break;let d=st(e,1);r=(d[0]&128)===128,i=d[0]&127,i<126?o=3:i===126?o=1:o=2}else if(o===1){if(at(e)<2)break;let d=st(e,2);i=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),o=3}else if(o===2){if(at(e)<8)break;let d=st(e,8),k=new DataView(d.buffer,d.byteOffset,d.length),b=k.getUint32(0);if(b>Math.pow(2,21)-1){g.enqueue(Le);break}i=b*Math.pow(2,32)+k.getUint32(4),o=3}else{if(at(e)<i)break;let d=st(e,i);g.enqueue(ze(r?d:Lt.decode(d),t)),o=0}if(i===0||i>n){g.enqueue(Le);break}}}})}var Vt=4;function q(n){if(n)return Io(n)}function Io(n){for(var t in q.prototype)n[t]=q.prototype[t];return n}q.prototype.on=q.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};q.prototype.once=function(n,t){function e(){this.off(n,e),t.apply(this,arguments)}return e.fn=t,this.on(n,e),this};q.prototype.off=q.prototype.removeListener=q.prototype.removeAllListeners=q.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+n];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var o,i=0;i<e.length;i++)if(o=e[i],o===t||o.fn===t){e.splice(i,1);break}return e.length===0&&delete this._callbacks["$"+n],this};q.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+n],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(e){e=e.slice(0);for(var o=0,i=e.length;o<i;++o)e[o].apply(this,t)}return this};q.prototype.emitReserved=q.prototype.emit;q.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};q.prototype.hasListeners=function(n){return!!this.listeners(n).length};var ue=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),te=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),qn="arraybuffer";function lt(n,...t){return t.reduce((e,o)=>(n.hasOwnProperty(o)&&(e[o]=n[o]),e),{})}var $o=te.setTimeout,No=te.clearTimeout;function me(n,t){t.useNativeTimers?(n.setTimeoutFn=$o.bind(te),n.clearTimeoutFn=No.bind(te)):(n.setTimeoutFn=te.setTimeout.bind(te),n.clearTimeoutFn=te.clearTimeout.bind(te))}var Ao=1.33;function Un(n){return typeof n=="string"?Ro(n):Math.ceil((n.byteLength||n.size)*Ao)}function Ro(n){let t=0,e=0;for(let o=0,i=n.length;o<i;o++)t=n.charCodeAt(o),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(o++,e+=4);return e}function ct(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function jn(n){let t="";for(let e in n)n.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t}function Gn(n){let t={},e=n.split("&");for(let o=0,i=e.length;o<i;o++){let r=e[o].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}var dt=class extends Error{constructor(t,e,o){super(t),this.description=e,this.context=o,this.type="TransportError"}},he=class extends q{constructor(t){super(),this.writable=!1,me(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,o){return super.emitReserved("error",new dt(t,e,o)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let e=ze(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){let t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){let e=jn(t);return e.length?"?"+e:""}};var Be=class extends he{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";let e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let o=0;this._polling&&(o++,this.once("pollComplete",function(){--o||e()})),this.writable||(o++,this.once("drain",function(){--o||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){let e=o=>{if(this.readyState==="opening"&&o.type==="open"&&this.onOpen(),o.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(o)};Bn(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){let t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,zn(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=ct()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}};var Yn=!1;try{Yn=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var Kn=Yn;function Do(){}var Ft=class extends Be{constructor(t){if(super(t),typeof location<"u"){let e=location.protocol==="https:",o=location.port;o||(o=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||o!==t.port}}doWrite(t,e){let o=this.request({method:"POST",data:t});o.on("success",e),o.on("error",(i,r)=>{this.onError("xhr post error",i,r)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,o)=>{this.onError("xhr poll error",e,o)}),this.pollXhr=t}},pt=(()=>{class n extends q{constructor(e,o,i){super(),this.createRequest=e,me(this,i),this._opts=i,this._method=i.method||"GET",this._uri=o,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;let o=lt(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");o.xdomain=!!this._opts.xd;let i=this._xhr=this.createRequest(o);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var r;i.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=n.requestsCount++,n.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Do,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete n.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}return n.requestsCount=0,n.requests={},n})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Qn);else if(typeof addEventListener=="function"){let n="onpagehide"in te?"pagehide":"unload";addEventListener(n,Qn,!1)}}function Qn(){for(let n in pt.requests)pt.requests.hasOwnProperty(n)&&pt.requests[n].abort()}var Lo=(function(){let n=Zn({xdomain:!1});return n&&n.responseType!==null})(),xe=class extends Ft{constructor(t){super(t);let e=t&&t.forceBase64;this.supportsBinary=Lo&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new pt(Zn,this.uri(),t)}};function Zn(n){let t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Kn))return new XMLHttpRequest}catch{}if(!t)try{return new te[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var Xn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Bt=class extends he{get name(){return"websocket"}doOpen(){let t=this.uri(),e=this.opts.protocols,o=Xn?{}:lt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(o.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,o)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let o=t[e],i=e===t.length-1;Ve(o,this.supportsBinary,r=>{try{this.doWrite(o,r)}catch{}i&&ue(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=ct()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}},zt=te.WebSocket||te.MozWebSocket,be=class extends Bt{createSocket(t,e,o){return Xn?new zt(t,e,o):e?new zt(t,e):new zt(t)}doWrite(t,e){this.ws.send(e)}};var Te=class extends he{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{let e=Hn(Number.MAX_SAFE_INTEGER,this.socket.binaryType),o=t.readable.pipeThrough(e).getReader(),i=Wn();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();let r=()=>{o.read().then(({done:g,value:d})=>{g||(this.onPacket(d),r())}).catch(g=>{})};r();let s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let o=t[e],i=e===t.length-1;this._writer.write(o).then(()=>{i&&ue(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}};var Wt={websocket:be,webtransport:Te,polling:xe};var Vo=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Fo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Oe(n){if(n.length>8e3)throw"URI too long";let t=n,e=n.indexOf("["),o=n.indexOf("]");e!=-1&&o!=-1&&(n=n.substring(0,e)+n.substring(e,o).replace(/:/g,";")+n.substring(o,n.length));let i=Vo.exec(n||""),r={},s=14;for(;s--;)r[Fo[s]]=i[s]||"";return e!=-1&&o!=-1&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=zo(r,r.path),r.queryKey=Bo(r,r.query),r}function zo(n,t){let e=/\/{2,9}/g,o=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&o.splice(0,1),t.slice(-1)=="/"&&o.splice(o.length-1,1),o}function Bo(n,t){let e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(o,i,r){i&&(e[i]=r)}),e}var Ht=typeof addEventListener=="function"&&typeof removeEventListener=="function",ut=[];Ht&&addEventListener("offline",()=>{ut.forEach(n=>n())},!1);var mt=(()=>{class n extends q{constructor(e,o){if(super(),this.binaryType=qn,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(o=e,e=null),e){let i=Oe(e);o.hostname=i.host,o.secure=i.protocol==="https"||i.protocol==="wss",o.port=i.port,i.query&&(o.query=i.query)}else o.host&&(o.hostname=Oe(o.host).host);me(this,o),this.secure=o.secure!=null?o.secure:typeof location<"u"&&location.protocol==="https:",o.hostname&&!o.port&&(o.port=this.secure?"443":"80"),this.hostname=o.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=o.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},o.transports.forEach(i=>{let r=i.prototype.name;this.transports.push(r),this._transportsByName[r]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},o),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Gn(this.opts.query)),Ht&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ut.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let o=Object.assign({},this.opts.query);o.EIO=Vt,o.transport=e,this.id&&(o.sid=this.id);let i=Object.assign({},this.opts,{query:o,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let o=this.createTransport(e);o.open(),this.setTransport(o)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",o=>this._onClose("transport close",o))}onOpen(){this.readyState="open",n.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let o=new Error("server error");o.code=e.data,this._onError(o);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let o=1;for(let i=0;i<this.writeBuffer.length;i++){let r=this.writeBuffer[i].data;if(r&&(o+=Un(r)),i>0&&o>this._maxPayload)return this.writeBuffer.slice(0,i);o+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,ue(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,o,i){return this._sendPacket("message",e,o,i),this}send(e,o,i){return this._sendPacket("message",e,o,i),this}_sendPacket(e,o,i,r){if(typeof o=="function"&&(r=o,o=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:o,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},o=()=>{this.off("upgrade",o),this.off("upgradeError",o),e()},i=()=>{this.once("upgrade",o),this.once("upgradeError",o)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(n.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,o){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ht&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let i=ut.indexOf(this._offlineEventListener);i!==-1&&ut.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,o),this.writeBuffer=[],this._prevBufferLen=0}}}return n.protocol=Vt,n})(),ht=class extends mt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),o=!1;mt.priorWebsocketSuccess=!1;let i=()=>{o||(e.send([{type:"ping",data:"probe"}]),e.once("packet",M=>{if(!o)if(M.type==="pong"&&M.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;mt.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{o||this.readyState!=="closed"&&(b(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{let O=new Error("probe error");O.transport=e.name,this.emitReserved("upgradeError",O)}}))};function r(){o||(o=!0,b(),e.close(),e=null)}let s=M=>{let O=new Error("probe error: "+M);O.transport=e.name,r(),this.emitReserved("upgradeError",O)};function g(){s("transport closed")}function d(){s("socket closed")}function k(M){e&&M.name!==e.name&&r()}let b=()=>{e.removeListener("open",i),e.removeListener("error",s),e.removeListener("close",g),this.off("close",d),this.off("upgrading",k)};e.once("open",i),e.once("error",s),e.once("close",g),this.once("close",d),this.once("upgrading",k),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{o||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){let e=[];for(let o=0;o<t.length;o++)~this.transports.indexOf(t[o])&&e.push(t[o]);return e}},Ie=class extends ht{constructor(t,e={}){let o=typeof t=="object"?t:e;(!o.transports||o.transports&&typeof o.transports[0]=="string")&&(o.transports=(o.transports||["polling","websocket","webtransport"]).map(i=>Wt[i]).filter(i=>!!i)),super(t,o)}};var Zl=Ie.protocol;function Jn(n,t="",e){let o=n;e=e||typeof location<"u"&&location,n==null&&(n=e.protocol+"//"+e.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=e.protocol+n:n=e.host+n),/^(https?|wss?):\/\//.test(n)||(typeof e<"u"?n=e.protocol+"//"+n:n="https://"+n),o=Oe(n)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";let r=o.host.indexOf(":")!==-1?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+r+":"+o.port+t,o.href=o.protocol+"://"+r+(e&&e.port===o.port?"":":"+o.port),o}var Kt={};Mo(Kt,{Decoder:()=>Gt,Encoder:()=>jt,PacketType:()=>$,isPacketValid:()=>Zo,protocol:()=>io});var Ho=typeof ArrayBuffer=="function",qo=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,eo=Object.prototype.toString,Uo=typeof Blob=="function"||typeof Blob<"u"&&eo.call(Blob)==="[object BlobConstructor]",jo=typeof File=="function"||typeof File<"u"&&eo.call(File)==="[object FileConstructor]";function He(n){return Ho&&(n instanceof ArrayBuffer||qo(n))||Uo&&n instanceof Blob||jo&&n instanceof File}function We(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let e=0,o=n.length;e<o;e++)if(We(n[e]))return!0;return!1}if(He(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return We(n.toJSON(),!0);for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&We(n[e]))return!0;return!1}function to(n){let t=[],e=n.data,o=n;return o.data=qt(e,t),o.attachments=t.length,{packet:o,buffers:t}}function qt(n,t){if(!n)return n;if(He(n)){let e={_placeholder:!0,num:t.length};return t.push(n),e}else if(Array.isArray(n)){let e=new Array(n.length);for(let o=0;o<n.length;o++)e[o]=qt(n[o],t);return e}else if(typeof n=="object"&&!(n instanceof Date)){let e={};for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=qt(n[o],t));return e}return n}function no(n,t){return n.data=Ut(n.data,t),delete n.attachments,n}function Ut(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=Ut(n[e],t);else if(typeof n=="object")for(let e in n)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=Ut(n[e],t));return n}var oo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],io=5,$=(function(n){return n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK",n})($||{}),jt=class{constructor(t){this.replacer=t}encode(t){return(t.type===$.EVENT||t.type===$.ACK)&&We(t)?this.encodeAsBinary({type:t.type===$.EVENT?$.BINARY_EVENT:$.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===$.BINARY_EVENT||t.type===$.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){let e=to(t),o=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(o),i}},Gt=class n extends q{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);let o=e.type===$.BINARY_EVENT;o||e.type===$.BINARY_ACK?(e.type=o?$.EVENT:$.ACK,this.reconstructor=new Yt(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(He(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0,o={type:Number(t.charAt(0))};if($[o.type]===void 0)throw new Error("unknown packet type "+o.type);if(o.type===$.BINARY_EVENT||o.type===$.BINARY_ACK){let r=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);let s=t.substring(r,e);if(s!=Number(s)||t.charAt(e)!=="-")throw new Error("Illegal attachments");o.attachments=Number(s)}if(t.charAt(e+1)==="/"){let r=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););o.nsp=t.substring(r,e)}else o.nsp="/";let i=t.charAt(e+1);if(i!==""&&Number(i)==i){let r=e+1;for(;++e;){let s=t.charAt(e);if(s==null||Number(s)!=s){--e;break}if(e===t.length)break}o.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){let r=this.tryParse(t.substr(e));if(n.isPayloadValid(o.type,r))o.data=r;else throw new Error("invalid payload")}return o}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case $.CONNECT:return gt(e);case $.DISCONNECT:return e===void 0;case $.CONNECT_ERROR:return typeof e=="string"||gt(e);case $.EVENT:case $.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&oo.indexOf(e[0])===-1);case $.ACK:case $.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},Yt=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let e=no(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Go(n){return typeof n=="string"}var Yo=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};function Ko(n){return n===void 0||Yo(n)}function gt(n){return Object.prototype.toString.call(n)==="[object Object]"}function Qo(n,t){switch(n){case $.CONNECT:return t===void 0||gt(t);case $.DISCONNECT:return t===void 0;case $.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&oo.indexOf(t[0])===-1);case $.ACK:return Array.isArray(t);case $.CONNECT_ERROR:return typeof t=="string"||gt(t);default:return!1}}function Zo(n){return Go(n.nsp)&&Ko(n.id)&&Qo(n.type,n.data)}function ie(n,t,e){return n.on(t,e),function(){n.off(t,e)}}var Xo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),$e=class extends q{constructor(t,e,o){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,o&&o.auth&&(this.auth=o.auth),this._opts=Object.assign({},o),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[ie(t,"open",this.onopen.bind(this)),ie(t,"packet",this.onpacket.bind(this)),ie(t,"error",this.onerror.bind(this)),ie(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var o,i,r;if(Xo.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;let s={type:$.EVENT,data:e};if(s.options={},s.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let b=this.ids++,M=e.pop();this._registerAckCallback(b,M),s.id=b}let g=(i=(o=this.io.engine)===null||o===void 0?void 0:o.transport)===null||i===void 0?void 0:i.writable,d=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!g||(d?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(t,e){var o;let i=(o=this.flags.timeout)!==null&&o!==void 0?o:this._opts.ackTimeout;if(i===void 0){this.acks[t]=e;return}let r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let g=0;g<this.sendBuffer.length;g++)this.sendBuffer[g].id===t&&this.sendBuffer.splice(g,1);e.call(this,new Error("operation has timed out"))},i),s=(...g)=>{this.io.clearTimeoutFn(r),e.apply(this,g)};s.withError=!0,this.acks[t]=s}emitWithAck(t,...e){return new Promise((o,i)=>{let r=(s,g)=>s?i(s):o(g);r.withError=!0,e.push(r),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());let o={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...r)=>(this._queue[0],i!==null?o.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(i)):(this._queue.shift(),e&&e(null,...r)),o.pending=!1,this._drainQueue())),this._queue.push(o),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;let e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:$.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(o=>String(o.id)===t)){let o=this.acks[t];delete this.acks[t],o.withError&&o.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case $.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case $.EVENT:case $.BINARY_EVENT:this.onevent(t);break;case $.ACK:case $.BINARY_ACK:this.onack(t);break;case $.DISCONNECT:this.ondisconnect();break;case $.CONNECT_ERROR:this.destroy();let o=new Error(t.data.message);o.data=t.data.data,this.emitReserved("connect_error",o);break}}onevent(t){let e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let o of e)o.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){let e=this,o=!1;return function(...i){o||(o=!0,e.packet({type:$.ACK,id:t,data:i}))}}onack(t){let e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:$.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let e=this._anyListeners;for(let o=0;o<e.length;o++)if(t===e[o])return e.splice(o,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let e=this._anyOutgoingListeners;for(let o=0;o<e.length;o++)if(t===e[o])return e.splice(o,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let o of e)o.apply(this,t.data)}}};function we(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}we.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*n);n=(Math.floor(t*10)&1)==0?n-e:n+e}return Math.min(n,this.max)|0};we.prototype.reset=function(){this.attempts=0};we.prototype.setMin=function(n){this.ms=n};we.prototype.setMax=function(n){this.max=n};we.prototype.setJitter=function(n){this.jitter=n};var Ne=class extends q{constructor(t,e){var o;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,me(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((o=e.randomizationFactor)!==null&&o!==void 0?o:.5),this.backoff=new we({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;let i=e.parser||Kt;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ie(this.uri,this.opts);let e=this.engine,o=this;this._readyState="opening",this.skipReconnect=!1;let i=ie(e,"open",function(){o.onopen(),t&&t()}),r=g=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",g),t?t(g):this.maybeReconnectOnOpen()},s=ie(e,"error",r);if(this._timeout!==!1){let g=this._timeout,d=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),e.close()},g);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(i),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(ie(t,"ping",this.onping.bind(this)),ie(t,"data",this.ondata.bind(this)),ie(t,"error",this.onerror.bind(this)),ie(t,"close",this.onclose.bind(this)),ie(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){ue(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let o=this.nsps[t];return o?this._autoConnect&&!o.active&&o.connect():(o=new $e(this,t,e),this.nsps[t]=o),o}_destroy(t){let e=Object.keys(this.nsps);for(let o of e)if(this.nsps[o].active)return;this._close()}_packet(t){let e=this.encoder.encode(t);for(let o=0;o<e.length;o++)this.engine.write(e[o],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var o;this.cleanup(),(o=this.engine)===null||o===void 0||o.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();this._reconnecting=!0;let o=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},e);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};var qe={};function Ue(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};let e=Jn(n,t.path||"/socket.io"),o=e.source,i=e.id,r=e.path,s=qe[i]&&r in qe[i].nsps,g=t.forceNew||t["force new connection"]||t.multiplex===!1||s,d;return g?d=new Ne(o,t):(qe[i]||(qe[i]=new Ne(o,t)),d=qe[i]),e.query&&!t.query&&(t.query=e.queryKey),d.socket(e.path,t)}Object.assign(Ue,{Manager:Ne,Socket:$e,io:Ue,connect:Ue});var ft=class n{socket=null;authService=W(kn);messageReceivedCallbacks=[];messageChunkCallbacks=[];completeCallbacks=[];errorCallbacks=[];notesUpdatedCallbacks=[];conceptDetectedCallbacks=[];planReadyCallbacks=[];stepProgressCallbacks=[];workflowCompleteCallbacks=[];workflowErrorCallbacks=[];conversationsCreatedCallbacks=[];stepConfirmationCallbacks=[];stepAwaitingInputCallbacks=[];stepMessageCallbacks=[];navigateToConversationCallbacks=[];tasksCreatedForExecutionCallbacks=[];yoloProgressCallbacks=[];yoloCompleteCallbacks=[];discoveryChunkCallbacks=[];discoveryCompleteCallbacks=[];discoveryErrorCallbacks=[];async connect(){if(this.socket?.connected)return;this.clearCallbacks();let t=this.authService.getAccessToken();if(!t)return;let e=Ce.apiUrl.replace(/^http/,"ws");this.socket=Ue(`${e}/ws/chat`,{auth:{token:t},query:{token:t},transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("chat:message-received",o=>{this.messageReceivedCallbacks.forEach(i=>i(o))}),this.socket.on("chat:message-chunk",o=>{this.messageChunkCallbacks.forEach(i=>i(o))}),this.socket.on("chat:complete",o=>{this.completeCallbacks.forEach(i=>i(o))}),this.socket.on("chat:error",o=>{this.errorCallbacks.forEach(i=>i(o))}),this.socket.on("chat:notes-updated",o=>{this.notesUpdatedCallbacks.forEach(i=>i(o))}),this.socket.on("chat:concept-detected",o=>{this.conceptDetectedCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:plan-ready",o=>{this.planReadyCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:step-progress",o=>{this.stepProgressCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:complete",o=>{this.workflowCompleteCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:error",o=>{this.workflowErrorCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:conversations-created",o=>{this.conversationsCreatedCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:step-awaiting-confirmation",o=>{this.stepConfirmationCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:step-awaiting-input",o=>{this.stepAwaitingInputCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:step-message",o=>{this.stepMessageCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:navigate-to-conversation",o=>{this.navigateToConversationCallbacks.forEach(i=>i(o))}),this.socket.on("chat:tasks-created-for-execution",o=>{this.tasksCreatedForExecutionCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:yolo-progress",o=>{this.yoloProgressCallbacks.forEach(i=>i(o))}),this.socket.on("workflow:yolo-complete",o=>{this.yoloCompleteCallbacks.forEach(i=>i(o))}),this.socket.on("discovery:message-chunk",o=>{this.discoveryChunkCallbacks.forEach(i=>i(o))}),this.socket.on("discovery:message-complete",o=>{this.discoveryCompleteCallbacks.forEach(i=>i(o))}),this.socket.on("discovery:error",o=>{this.discoveryErrorCallbacks.forEach(i=>i(o))})}waitForConnection(t=1e4){return new Promise((e,o)=>{if(this.socket?.connected){e();return}let i=setTimeout(()=>{o(new Error("WebSocket connection timeout"))},t),r=()=>{this.socket?.connected?(clearTimeout(i),e()):setTimeout(r,100)};r()})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}sendMessage(t,e){this.socket?.connected&&this.socket.emit("chat:message-send",{conversationId:t,content:e})}emitRunAgents(t,e){this.socket?.connected&&this.socket.emit("workflow:run-agents",{taskIds:t,conversationId:e})}emitWorkflowApproval(t,e,o){this.socket?.connected&&this.socket.emit("workflow:approve",{planId:t,approved:e,conversationId:o})}emitWorkflowCancel(t,e){this.socket?.connected&&this.socket.emit("workflow:cancel",{planId:t,conversationId:e})}emitStepContinue(t,e,o){this.socket?.connected&&this.socket.emit("workflow:step-continue",{planId:t,conversationId:e,userInput:o})}emitStartYolo(t){this.socket?.connected&&this.socket.emit("workflow:start-yolo",{conversationId:t})}emitStartDomainYolo(t,e){this.socket?.connected&&this.socket.emit("yolo:start-domain",{conversationId:t,category:e})}emitDiscoveryMessage(t){this.socket?.connected&&this.socket.emit("discovery:send-message",{content:t})}onMessageReceived(t){return this.messageReceivedCallbacks.push(t),()=>{let e=this.messageReceivedCallbacks.indexOf(t);e>-1&&this.messageReceivedCallbacks.splice(e,1)}}onMessageChunk(t){return this.messageChunkCallbacks.push(t),()=>{let e=this.messageChunkCallbacks.indexOf(t);e>-1&&this.messageChunkCallbacks.splice(e,1)}}onComplete(t){return this.completeCallbacks.push(t),()=>{let e=this.completeCallbacks.indexOf(t);e>-1&&this.completeCallbacks.splice(e,1)}}onError(t){return this.errorCallbacks.push(t),()=>{let e=this.errorCallbacks.indexOf(t);e>-1&&this.errorCallbacks.splice(e,1)}}onNotesUpdated(t){return this.notesUpdatedCallbacks.push(t),()=>{let e=this.notesUpdatedCallbacks.indexOf(t);e>-1&&this.notesUpdatedCallbacks.splice(e,1)}}onTasksCreatedForExecution(t){return this.tasksCreatedForExecutionCallbacks.push(t),()=>{let e=this.tasksCreatedForExecutionCallbacks.indexOf(t);e>-1&&this.tasksCreatedForExecutionCallbacks.splice(e,1)}}onConceptDetected(t){return this.conceptDetectedCallbacks.push(t),()=>{let e=this.conceptDetectedCallbacks.indexOf(t);e>-1&&this.conceptDetectedCallbacks.splice(e,1)}}onPlanReady(t){return this.planReadyCallbacks.push(t),()=>{let e=this.planReadyCallbacks.indexOf(t);e>-1&&this.planReadyCallbacks.splice(e,1)}}onStepProgress(t){return this.stepProgressCallbacks.push(t),()=>{let e=this.stepProgressCallbacks.indexOf(t);e>-1&&this.stepProgressCallbacks.splice(e,1)}}onWorkflowComplete(t){return this.workflowCompleteCallbacks.push(t),()=>{let e=this.workflowCompleteCallbacks.indexOf(t);e>-1&&this.workflowCompleteCallbacks.splice(e,1)}}onWorkflowError(t){return this.workflowErrorCallbacks.push(t),()=>{let e=this.workflowErrorCallbacks.indexOf(t);e>-1&&this.workflowErrorCallbacks.splice(e,1)}}onConversationsCreated(t){return this.conversationsCreatedCallbacks.push(t),()=>{let e=this.conversationsCreatedCallbacks.indexOf(t);e>-1&&this.conversationsCreatedCallbacks.splice(e,1)}}onStepAwaitingConfirmation(t){return this.stepConfirmationCallbacks.push(t),()=>{let e=this.stepConfirmationCallbacks.indexOf(t);e>-1&&this.stepConfirmationCallbacks.splice(e,1)}}onStepAwaitingInput(t){return this.stepAwaitingInputCallbacks.push(t),()=>{let e=this.stepAwaitingInputCallbacks.indexOf(t);e>-1&&this.stepAwaitingInputCallbacks.splice(e,1)}}onStepMessage(t){return this.stepMessageCallbacks.push(t),()=>{let e=this.stepMessageCallbacks.indexOf(t);e>-1&&this.stepMessageCallbacks.splice(e,1)}}onNavigateToConversation(t){return this.navigateToConversationCallbacks.push(t),()=>{let e=this.navigateToConversationCallbacks.indexOf(t);e>-1&&this.navigateToConversationCallbacks.splice(e,1)}}onYoloProgress(t){return this.yoloProgressCallbacks.push(t),()=>{let e=this.yoloProgressCallbacks.indexOf(t);e>-1&&this.yoloProgressCallbacks.splice(e,1)}}onYoloComplete(t){return this.yoloCompleteCallbacks.push(t),()=>{let e=this.yoloCompleteCallbacks.indexOf(t);e>-1&&this.yoloCompleteCallbacks.splice(e,1)}}onDiscoveryChunk(t){return this.discoveryChunkCallbacks.push(t),()=>{let e=this.discoveryChunkCallbacks.indexOf(t);e>-1&&this.discoveryChunkCallbacks.splice(e,1)}}onDiscoveryComplete(t){return this.discoveryCompleteCallbacks.push(t),()=>{let e=this.discoveryCompleteCallbacks.indexOf(t);e>-1&&this.discoveryCompleteCallbacks.splice(e,1)}}onDiscoveryError(t){return this.discoveryErrorCallbacks.push(t),()=>{let e=this.discoveryErrorCallbacks.indexOf(t);e>-1&&this.discoveryErrorCallbacks.splice(e,1)}}clearCallbacks(){this.messageReceivedCallbacks=[],this.messageChunkCallbacks=[],this.completeCallbacks=[],this.errorCallbacks=[],this.notesUpdatedCallbacks=[],this.conceptDetectedCallbacks=[],this.planReadyCallbacks=[],this.stepProgressCallbacks=[],this.workflowCompleteCallbacks=[],this.workflowErrorCallbacks=[],this.conversationsCreatedCallbacks=[],this.stepConfirmationCallbacks=[],this.stepAwaitingInputCallbacks=[],this.stepMessageCallbacks=[],this.navigateToConversationCallbacks=[],this.tasksCreatedForExecutionCallbacks=[],this.yoloProgressCallbacks=[],this.yoloCompleteCallbacks=[],this.discoveryChunkCallbacks=[],this.discoveryCompleteCallbacks=[],this.discoveryErrorCallbacks=[]}static \u0275fac=function(e){return new(e||n)};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ae=class n{http=W(re);baseUrl=`${Ce.apiUrl}/api/v1/notes`;async getByConversation(t){return(await B(this.http.get(`${this.baseUrl}/conversation/${t}`))).data}async getByConcept(t){return(await B(this.http.get(`${this.baseUrl}/concept/${t}`))).data}async getByConceptIds(t){return(await Promise.all(t.map(o=>this.getByConcept(o).catch(()=>[])))).flat()}async getByConversationIds(t){return(await Promise.all(t.map(o=>this.getByConversation(o).catch(()=>[])))).flat()}async createNote(t){return(await B(this.http.post(this.baseUrl,t))).data}async updateStatus(t,e){return(await B(this.http.patch(`${this.baseUrl}/${t}/status`,{status:e}))).data}async updateNote(t,e,o){return(await B(this.http.patch(`${this.baseUrl}/${t}`,{title:e,content:o}))).data}async submitReport(t,e){return(await B(this.http.post(`${this.baseUrl}/${t}/report`,{report:e}))).data}async scoreReport(t){return(await B(this.http.post(`${this.baseUrl}/${t}/score`,{}))).data}async deleteNote(t){await B(this.http.delete(`${this.baseUrl}/${t}`))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})};function Jt(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Se=Jt();function uo(n){Se=n}var Ke={exec:()=>null};function V(n,t=""){let e=typeof n=="string"?n:n.source,o={replace:(i,r)=>{let s=typeof r=="string"?r:r.source;return s=s.replace(ne.caret,"$1"),e=e.replace(i,s),o},getRegex:()=>new RegExp(e,t)};return o}var Jo=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),ne={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},ei=/^(?:[ \t]*(?:\n|$))+/,ti=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ni=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Qe=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,oi=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,en=/(?:[*+-]|\d{1,9}[.)])/,mo=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ho=V(mo).replace(/bull/g,en).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),ii=V(mo).replace(/bull/g,en).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),tn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ri=/^[^\n]+/,nn=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,ai=V(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",nn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),si=V(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,en).getRegex(),vt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",on=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,li=V("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",on).replace("tag",vt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),go=V(tn).replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",vt).getRegex(),ci=V(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",go).getRegex(),rn={blockquote:ci,code:ti,def:ai,fences:ni,heading:oi,hr:Qe,html:li,lheading:ho,list:si,newline:ei,paragraph:go,table:Ke,text:ri},ro=V("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",vt).getRegex(),di=Z(L({},rn),{lheading:ii,table:ro,paragraph:V(tn).replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ro).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",vt).getRegex()}),pi=Z(L({},rn),{html:V(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",on).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ke,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:V(tn).replace("hr",Qe).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ho).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()}),ui=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,mi=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,fo=/^( {2,}|\\)\n(?!\s*$)/,hi=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,kt=/[\p{P}\p{S}]/u,an=/[\s\p{P}\p{S}]/u,_o=/[^\s\p{P}\p{S}]/u,gi=V(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,an).getRegex(),Co=/(?!~)[\p{P}\p{S}]/u,fi=/(?!~)[\s\p{P}\p{S}]/u,_i=/(?:[^\s\p{P}\p{S}]|~)/u,Ci=V(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Jo?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),xo=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,xi=V(xo,"u").replace(/punct/g,kt).getRegex(),bi=V(xo,"u").replace(/punct/g,Co).getRegex(),bo="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",vi=V(bo,"gu").replace(/notPunctSpace/g,_o).replace(/punctSpace/g,an).replace(/punct/g,kt).getRegex(),ki=V(bo,"gu").replace(/notPunctSpace/g,_i).replace(/punctSpace/g,fi).replace(/punct/g,Co).getRegex(),yi=V("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,_o).replace(/punctSpace/g,an).replace(/punct/g,kt).getRegex(),wi=V(/\\(punct)/,"gu").replace(/punct/g,kt).getRegex(),Pi=V(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Si=V(on).replace("(?:-->|$)","-->").getRegex(),Ei=V("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Si).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ct=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Mi=V(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ct).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),vo=V(/^!?\[(label)\]\[(ref)\]/).replace("label",Ct).replace("ref",nn).getRegex(),ko=V(/^!?\[(ref)\](?:\[\])?/).replace("ref",nn).getRegex(),Ti=V("reflink|nolink(?!\\()","g").replace("reflink",vo).replace("nolink",ko).getRegex(),ao=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,sn={_backpedal:Ke,anyPunctuation:wi,autolink:Pi,blockSkip:Ci,br:fo,code:mi,del:Ke,emStrongLDelim:xi,emStrongRDelimAst:vi,emStrongRDelimUnd:yi,escape:ui,link:Mi,nolink:ko,punctuation:gi,reflink:vo,reflinkSearch:Ti,tag:Ei,text:hi,url:Ke},Oi=Z(L({},sn),{link:V(/^!?\[(label)\]\((.*?)\)/).replace("label",Ct).getRegex(),reflink:V(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ct).getRegex()}),Qt=Z(L({},sn),{emStrongRDelimAst:ki,emStrongLDelim:bi,url:V(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",ao).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:V(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",ao).getRegex()}),Ii=Z(L({},Qt),{br:V(fo).replace("{2,}","*").getRegex(),text:V(Qt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),_t={normal:rn,gfm:di,pedantic:pi},je={normal:sn,gfm:Qt,breaks:Ii,pedantic:Oi},$i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},so=n=>$i[n];function ge(n,t){if(t){if(ne.escapeTest.test(n))return n.replace(ne.escapeReplace,so)}else if(ne.escapeTestNoEncode.test(n))return n.replace(ne.escapeReplaceNoEncode,so);return n}function lo(n){try{n=encodeURI(n).replace(ne.percentDecode,"%")}catch{return null}return n}function co(n,t){let e=n.replace(ne.findPipe,(r,s,g)=>{let d=!1,k=s;for(;--k>=0&&g[k]==="\\";)d=!d;return d?"|":" |"}),o=e.split(ne.splitPipe),i=0;if(o[0].trim()||o.shift(),o.length>0&&!o.at(-1)?.trim()&&o.pop(),t)if(o.length>t)o.splice(t);else for(;o.length<t;)o.push("");for(;i<o.length;i++)o[i]=o[i].trim().replace(ne.slashPipe,"|");return o}function Ge(n,t,e){let o=n.length;if(o===0)return"";let i=0;for(;i<o;){let r=n.charAt(o-i-1);if(r===t&&!e)i++;else if(r!==t&&e)i++;else break}return n.slice(0,o-i)}function Ni(n,t){if(n.indexOf(t[1])===-1)return-1;let e=0;for(let o=0;o<n.length;o++)if(n[o]==="\\")o++;else if(n[o]===t[0])e++;else if(n[o]===t[1]&&(e--,e<0))return o;return e>0?-2:-1}function po(n,t,e,o,i){let r=t.href,s=t.title||null,g=n[1].replace(i.other.outputLinkReplace,"$1");o.state.inLink=!0;let d={type:n[0].charAt(0)==="!"?"image":"link",raw:e,href:r,title:s,text:g,tokens:o.inlineTokens(g)};return o.state.inLink=!1,d}function Ai(n,t,e){let o=n.match(e.other.indentCodeCompensation);if(o===null)return t;let i=o[1];return t.split(`
`).map(r=>{let s=r.match(e.other.beginningSpace);if(s===null)return r;let[g]=s;return g.length>=i.length?r.slice(i.length):r}).join(`
`)}var xt=class{options;rules;lexer;constructor(n){this.options=n||Se}space(n){let t=this.rules.block.newline.exec(n);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(n){let t=this.rules.block.code.exec(n);if(t){let e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:Ge(e,`
`)}}}fences(n){let t=this.rules.block.fences.exec(n);if(t){let e=t[0],o=Ai(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:o}}}heading(n){let t=this.rules.block.heading.exec(n);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){let o=Ge(e,"#");(this.options.pedantic||!o||this.rules.other.endingSpaceChar.test(o))&&(e=o.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(n){let t=this.rules.block.hr.exec(n);if(t)return{type:"hr",raw:Ge(t[0],`
`)}}blockquote(n){let t=this.rules.block.blockquote.exec(n);if(t){let e=Ge(t[0],`
`).split(`
`),o="",i="",r=[];for(;e.length>0;){let s=!1,g=[],d;for(d=0;d<e.length;d++)if(this.rules.other.blockquoteStart.test(e[d]))g.push(e[d]),s=!0;else if(!s)g.push(e[d]);else break;e=e.slice(d);let k=g.join(`
`),b=k.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");o=o?`${o}
${k}`:k,i=i?`${i}
${b}`:b;let M=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(b,r,!0),this.lexer.state.top=M,e.length===0)break;let O=r.at(-1);if(O?.type==="code")break;if(O?.type==="blockquote"){let J=O,K=J.raw+`
`+e.join(`
`),ae=this.blockquote(K);r[r.length-1]=ae,o=o.substring(0,o.length-J.raw.length)+ae.raw,i=i.substring(0,i.length-J.text.length)+ae.text;break}else if(O?.type==="list"){let J=O,K=J.raw+`
`+e.join(`
`),ae=this.list(K);r[r.length-1]=ae,o=o.substring(0,o.length-O.raw.length)+ae.raw,i=i.substring(0,i.length-J.raw.length)+ae.raw,e=K.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:o,tokens:r,text:i}}}list(n){let t=this.rules.block.list.exec(n);if(t){let e=t[1].trim(),o=e.length>1,i={type:"list",raw:"",ordered:o,start:o?+e.slice(0,-1):"",loose:!1,items:[]};e=o?`\\d{1,9}\\${e.slice(-1)}`:`\\${e}`,this.options.pedantic&&(e=o?e:"[*+-]");let r=this.rules.other.listItemRegex(e),s=!1;for(;n;){let d=!1,k="",b="";if(!(t=r.exec(n))||this.rules.block.hr.test(n))break;k=t[0],n=n.substring(k.length);let M=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,ae=>" ".repeat(3*ae.length)),O=n.split(`
`,1)[0],J=!M.trim(),K=0;if(this.options.pedantic?(K=2,b=M.trimStart()):J?K=t[1].length+1:(K=t[2].search(this.rules.other.nonSpaceChar),K=K>4?1:K,b=M.slice(K),K+=t[1].length),J&&this.rules.other.blankLine.test(O)&&(k+=O+`
`,n=n.substring(O.length+1),d=!0),!d){let ae=this.rules.other.nextBulletRegex(K),cn=this.rules.other.hrRegex(K),dn=this.rules.other.fencesBeginRegex(K),pn=this.rules.other.headingBeginRegex(K),Eo=this.rules.other.htmlBeginRegex(K);for(;n;){let At=n.split(`
`,1)[0],Re;if(O=At,this.options.pedantic?(O=O.replace(this.rules.other.listReplaceNesting,"  "),Re=O):Re=O.replace(this.rules.other.tabCharGlobal,"    "),dn.test(O)||pn.test(O)||Eo.test(O)||ae.test(O)||cn.test(O))break;if(Re.search(this.rules.other.nonSpaceChar)>=K||!O.trim())b+=`
`+Re.slice(K);else{if(J||M.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||dn.test(M)||pn.test(M)||cn.test(M))break;b+=`
`+O}!J&&!O.trim()&&(J=!0),k+=At+`
`,n=n.substring(At.length+1),M=Re.slice(K)}}i.loose||(s?i.loose=!0:this.rules.other.doubleBlankLine.test(k)&&(s=!0)),i.items.push({type:"list_item",raw:k,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),i.raw+=k}let g=i.items.at(-1);if(g)g.raw=g.raw.trimEnd(),g.text=g.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let d of i.items){if(this.lexer.state.top=!1,d.tokens=this.lexer.blockTokens(d.text,[]),d.task){if(d.text=d.text.replace(this.rules.other.listReplaceTask,""),d.tokens[0]?.type==="text"||d.tokens[0]?.type==="paragraph"){d.tokens[0].raw=d.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),d.tokens[0].text=d.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let k=this.rules.other.listTaskCheckbox.exec(d.raw);if(k){let b={type:"checkbox",raw:k[0]+" ",checked:k[0]!=="[ ]"};d.checked=b.checked,i.loose?d.tokens[0]&&["paragraph","text"].includes(d.tokens[0].type)&&"tokens"in d.tokens[0]&&d.tokens[0].tokens?(d.tokens[0].raw=b.raw+d.tokens[0].raw,d.tokens[0].text=b.raw+d.tokens[0].text,d.tokens[0].tokens.unshift(b)):d.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):d.tokens.unshift(b)}}if(!i.loose){let k=d.tokens.filter(M=>M.type==="space"),b=k.length>0&&k.some(M=>this.rules.other.anyLine.test(M.raw));i.loose=b}}if(i.loose)for(let d of i.items){d.loose=!0;for(let k of d.tokens)k.type==="text"&&(k.type="paragraph")}return i}}html(n){let t=this.rules.block.html.exec(n);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(n){let t=this.rules.block.def.exec(n);if(t){let e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),o=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:o,title:i}}}table(n){let t=this.rules.block.table.exec(n);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let e=co(t[1]),o=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(e.length===o.length){for(let s of o)this.rules.other.tableAlignRight.test(s)?r.align.push("right"):this.rules.other.tableAlignCenter.test(s)?r.align.push("center"):this.rules.other.tableAlignLeft.test(s)?r.align.push("left"):r.align.push(null);for(let s=0;s<e.length;s++)r.header.push({text:e[s],tokens:this.lexer.inline(e[s]),header:!0,align:r.align[s]});for(let s of i)r.rows.push(co(s,r.header.length).map((g,d)=>({text:g,tokens:this.lexer.inline(g),header:!1,align:r.align[d]})));return r}}lheading(n){let t=this.rules.block.lheading.exec(n);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(n){let t=this.rules.block.paragraph.exec(n);if(t){let e=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(n){let t=this.rules.block.text.exec(n);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(n){let t=this.rules.inline.escape.exec(n);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(n){let t=this.rules.inline.tag.exec(n);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(n){let t=this.rules.inline.link.exec(n);if(t){let e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;let r=Ge(e.slice(0,-1),"\\");if((e.length-r.length)%2===0)return}else{let r=Ni(t[2],"()");if(r===-2)return;if(r>-1){let s=(t[0].indexOf("!")===0?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,s).trim(),t[3]=""}}let o=t[2],i="";if(this.options.pedantic){let r=this.rules.other.pedanticHrefTitle.exec(o);r&&(o=r[1],i=r[3])}else i=t[3]?t[3].slice(1,-1):"";return o=o.trim(),this.rules.other.startAngleBracket.test(o)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?o=o.slice(1):o=o.slice(1,-1)),po(t,{href:o&&o.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(n,t){let e;if((e=this.rules.inline.reflink.exec(n))||(e=this.rules.inline.nolink.exec(n))){let o=(e[2]||e[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[o.toLowerCase()];if(!i){let r=e[0].charAt(0);return{type:"text",raw:r,text:r}}return po(e,i,e[0],this.lexer,this.rules)}}emStrong(n,t,e=""){let o=this.rules.inline.emStrongLDelim.exec(n);if(!(!o||o[3]&&e.match(this.rules.other.unicodeAlphaNumeric))&&(!(o[1]||o[2])||!e||this.rules.inline.punctuation.exec(e))){let i=[...o[0]].length-1,r,s,g=i,d=0,k=o[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(k.lastIndex=0,t=t.slice(-1*n.length+i);(o=k.exec(t))!=null;){if(r=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!r)continue;if(s=[...r].length,o[3]||o[4]){g+=s;continue}else if((o[5]||o[6])&&i%3&&!((i+s)%3)){d+=s;continue}if(g-=s,g>0)continue;s=Math.min(s,s+g+d);let b=[...o[0]][0].length,M=n.slice(0,i+o.index+b+s);if(Math.min(i,s)%2){let J=M.slice(1,-1);return{type:"em",raw:M,text:J,tokens:this.lexer.inlineTokens(J)}}let O=M.slice(2,-2);return{type:"strong",raw:M,text:O,tokens:this.lexer.inlineTokens(O)}}}}codespan(n){let t=this.rules.inline.code.exec(n);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," "),o=this.rules.other.nonSpaceChar.test(e),i=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return o&&i&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(n){let t=this.rules.inline.br.exec(n);if(t)return{type:"br",raw:t[0]}}del(n){let t=this.rules.inline.del.exec(n);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(n){let t=this.rules.inline.autolink.exec(n);if(t){let e,o;return t[2]==="@"?(e=t[1],o="mailto:"+e):(e=t[1],o=e),{type:"link",raw:t[0],text:e,href:o,tokens:[{type:"text",raw:e,text:e}]}}}url(n){let t;if(t=this.rules.inline.url.exec(n)){let e,o;if(t[2]==="@")e=t[0],o="mailto:"+e;else{let i;do i=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(i!==t[0]);e=t[0],t[1]==="www."?o="http://"+t[0]:o=t[0]}return{type:"link",raw:t[0],text:e,href:o,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(n){let t=this.rules.inline.text.exec(n);if(t){let e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}},ce=class Zt{tokens;options;state;inlineQueue;tokenizer;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Se,this.options.tokenizer=this.options.tokenizer||new xt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let e={other:ne,block:_t.normal,inline:je.normal};this.options.pedantic?(e.block=_t.pedantic,e.inline=je.pedantic):this.options.gfm&&(e.block=_t.gfm,this.options.breaks?e.inline=je.breaks:e.inline=je.gfm),this.tokenizer.rules=e}static get rules(){return{block:_t,inline:je}}static lex(t,e){return new Zt(e).lex(t)}static lexInline(t,e){return new Zt(e).inlineTokens(t)}lex(t){t=t.replace(ne.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let o=this.inlineQueue[e];this.inlineTokens(o.src,o.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,e=[],o=!1){for(this.options.pedantic&&(t=t.replace(ne.tabCharGlobal,"    ").replace(ne.spaceLine,""));t;){let i;if(this.options.extensions?.block?.some(s=>(i=s.call({lexer:this},t,e))?(t=t.substring(i.raw.length),e.push(i),!0):!1))continue;if(i=this.tokenizer.space(t)){t=t.substring(i.raw.length);let s=e.at(-1);i.raw.length===1&&s!==void 0?s.raw+=`
`:e.push(i);continue}if(i=this.tokenizer.code(t)){t=t.substring(i.raw.length);let s=e.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+i.raw,s.text+=`
`+i.text,this.inlineQueue.at(-1).src=s.text):e.push(i);continue}if(i=this.tokenizer.fences(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.heading(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.hr(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.blockquote(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.list(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.html(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.def(t)){t=t.substring(i.raw.length);let s=e.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+i.raw,s.text+=`
`+i.raw,this.inlineQueue.at(-1).src=s.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title},e.push(i));continue}if(i=this.tokenizer.table(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.lheading(t)){t=t.substring(i.raw.length),e.push(i);continue}let r=t;if(this.options.extensions?.startBlock){let s=1/0,g=t.slice(1),d;this.options.extensions.startBlock.forEach(k=>{d=k.call({lexer:this},g),typeof d=="number"&&d>=0&&(s=Math.min(s,d))}),s<1/0&&s>=0&&(r=t.substring(0,s+1))}if(this.state.top&&(i=this.tokenizer.paragraph(r))){let s=e.at(-1);o&&s?.type==="paragraph"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):e.push(i),o=r.length!==t.length,t=t.substring(i.raw.length);continue}if(i=this.tokenizer.text(t)){t=t.substring(i.raw.length);let s=e.at(-1);s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):e.push(i);continue}if(t){let s="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){let o=t,i=null;if(this.tokens.links){let d=Object.keys(this.tokens.links);if(d.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)d.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,i.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let r;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)r=i[2]?i[2].length:0,o=o.slice(0,i.index+r)+"["+"a".repeat(i[0].length-r-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);o=this.options.hooks?.emStrongMask?.call({lexer:this},o)??o;let s=!1,g="";for(;t;){s||(g=""),s=!1;let d;if(this.options.extensions?.inline?.some(b=>(d=b.call({lexer:this},t,e))?(t=t.substring(d.raw.length),e.push(d),!0):!1))continue;if(d=this.tokenizer.escape(t)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.tag(t)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.link(t)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(d.raw.length);let b=e.at(-1);d.type==="text"&&b?.type==="text"?(b.raw+=d.raw,b.text+=d.text):e.push(d);continue}if(d=this.tokenizer.emStrong(t,o,g)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.codespan(t)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.br(t)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.del(t)){t=t.substring(d.raw.length),e.push(d);continue}if(d=this.tokenizer.autolink(t)){t=t.substring(d.raw.length),e.push(d);continue}if(!this.state.inLink&&(d=this.tokenizer.url(t))){t=t.substring(d.raw.length),e.push(d);continue}let k=t;if(this.options.extensions?.startInline){let b=1/0,M=t.slice(1),O;this.options.extensions.startInline.forEach(J=>{O=J.call({lexer:this},M),typeof O=="number"&&O>=0&&(b=Math.min(b,O))}),b<1/0&&b>=0&&(k=t.substring(0,b+1))}if(d=this.tokenizer.inlineText(k)){t=t.substring(d.raw.length),d.raw.slice(-1)!=="_"&&(g=d.raw.slice(-1)),s=!0;let b=e.at(-1);b?.type==="text"?(b.raw+=d.raw,b.text+=d.text):e.push(d);continue}if(t){let b="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(b);break}else throw new Error(b)}}return e}},bt=class{options;parser;constructor(n){this.options=n||Se}space(n){return""}code({text:n,lang:t,escaped:e}){let o=(t||"").match(ne.notSpaceStart)?.[0],i=n.replace(ne.endingNewline,"")+`
`;return o?'<pre><code class="language-'+ge(o)+'">'+(e?i:ge(i,!0))+`</code></pre>
`:"<pre><code>"+(e?i:ge(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}def(n){return""}heading({tokens:n,depth:t}){return`<h${t}>${this.parser.parseInline(n)}</h${t}>
`}hr(n){return`<hr>
`}list(n){let t=n.ordered,e=n.start,o="";for(let s=0;s<n.items.length;s++){let g=n.items[s];o+=this.listitem(g)}let i=t?"ol":"ul",r=t&&e!==1?' start="'+e+'"':"";return"<"+i+r+`>
`+o+"</"+i+`>
`}listitem(n){return`<li>${this.parser.parse(n.tokens)}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let t="",e="";for(let i=0;i<n.header.length;i++)e+=this.tablecell(n.header[i]);t+=this.tablerow({text:e});let o="";for(let i=0;i<n.rows.length;i++){let r=n.rows[i];e="";for(let s=0;s<r.length;s++)e+=this.tablecell(r[s]);o+=this.tablerow({text:e})}return o&&(o=`<tbody>${o}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+o+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){let t=this.parser.parseInline(n.tokens),e=n.header?"th":"td";return(n.align?`<${e} align="${n.align}">`:`<${e}>`)+t+`</${e}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${ge(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:t,tokens:e}){let o=this.parser.parseInline(e),i=lo(n);if(i===null)return o;n=i;let r='<a href="'+n+'"';return t&&(r+=' title="'+ge(t)+'"'),r+=">"+o+"</a>",r}image({href:n,title:t,text:e,tokens:o}){o&&(e=this.parser.parseInline(o,this.parser.textRenderer));let i=lo(n);if(i===null)return ge(e);n=i;let r=`<img src="${n}" alt="${e}"`;return t&&(r+=` title="${ge(t)}"`),r+=">",r}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:ge(n.text)}},ln=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}checkbox({raw:n}){return n}},de=class Xt{options;renderer;textRenderer;constructor(t){this.options=t||Se,this.options.renderer=this.options.renderer||new bt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ln}static parse(t,e){return new Xt(e).parse(t)}static parseInline(t,e){return new Xt(e).parseInline(t)}parse(t){let e="";for(let o=0;o<t.length;o++){let i=t[o];if(this.options.extensions?.renderers?.[i.type]){let s=i,g=this.options.extensions.renderers[s.type].call({parser:this},s);if(g!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(s.type)){e+=g||"";continue}}let r=i;switch(r.type){case"space":{e+=this.renderer.space(r);break}case"hr":{e+=this.renderer.hr(r);break}case"heading":{e+=this.renderer.heading(r);break}case"code":{e+=this.renderer.code(r);break}case"table":{e+=this.renderer.table(r);break}case"blockquote":{e+=this.renderer.blockquote(r);break}case"list":{e+=this.renderer.list(r);break}case"checkbox":{e+=this.renderer.checkbox(r);break}case"html":{e+=this.renderer.html(r);break}case"def":{e+=this.renderer.def(r);break}case"paragraph":{e+=this.renderer.paragraph(r);break}case"text":{e+=this.renderer.text(r);break}default:{let s='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(s),"";throw new Error(s)}}}return e}parseInline(t,e=this.renderer){let o="";for(let i=0;i<t.length;i++){let r=t[i];if(this.options.extensions?.renderers?.[r.type]){let g=this.options.extensions.renderers[r.type].call({parser:this},r);if(g!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){o+=g||"";continue}}let s=r;switch(s.type){case"escape":{o+=e.text(s);break}case"html":{o+=e.html(s);break}case"link":{o+=e.link(s);break}case"image":{o+=e.image(s);break}case"checkbox":{o+=e.checkbox(s);break}case"strong":{o+=e.strong(s);break}case"em":{o+=e.em(s);break}case"codespan":{o+=e.codespan(s);break}case"br":{o+=e.br(s);break}case"del":{o+=e.del(s);break}case"text":{o+=e.text(s);break}default:{let g='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(g),"";throw new Error(g)}}}return o}},Ye=class{options;block;constructor(n){this.options=n||Se}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}emStrongMask(n){return n}provideLexer(){return this.block?ce.lex:ce.lexInline}provideParser(){return this.block?de.parse:de.parseInline}},Ri=class{defaults=Jt();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=de;Renderer=bt;TextRenderer=ln;Lexer=ce;Tokenizer=xt;Hooks=Ye;constructor(...n){this.use(...n)}walkTokens(n,t){let e=[];for(let o of n)switch(e=e.concat(t.call(this,o)),o.type){case"table":{let i=o;for(let r of i.header)e=e.concat(this.walkTokens(r.tokens,t));for(let r of i.rows)for(let s of r)e=e.concat(this.walkTokens(s.tokens,t));break}case"list":{let i=o;e=e.concat(this.walkTokens(i.items,t));break}default:{let i=o;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(r=>{let s=i[r].flat(1/0);e=e.concat(this.walkTokens(s,t))}):i.tokens&&(e=e.concat(this.walkTokens(i.tokens,t)))}}return e}use(...n){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(e=>{let o=L({},e);if(o.async=this.defaults.async||o.async||!1,e.extensions&&(e.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let r=t.renderers[i.name];r?t.renderers[i.name]=function(...s){let g=i.renderer.apply(this,s);return g===!1&&(g=r.apply(this,s)),g}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let r=t[i.level];r?r.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),o.extensions=t),e.renderer){let i=this.defaults.renderer||new bt(this.defaults);for(let r in e.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;let s=r,g=e.renderer[s],d=i[s];i[s]=(...k)=>{let b=g.apply(i,k);return b===!1&&(b=d.apply(i,k)),b||""}}o.renderer=i}if(e.tokenizer){let i=this.defaults.tokenizer||new xt(this.defaults);for(let r in e.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;let s=r,g=e.tokenizer[s],d=i[s];i[s]=(...k)=>{let b=g.apply(i,k);return b===!1&&(b=d.apply(i,k)),b}}o.tokenizer=i}if(e.hooks){let i=this.defaults.hooks||new Ye;for(let r in e.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;let s=r,g=e.hooks[s],d=i[s];Ye.passThroughHooks.has(r)?i[s]=k=>{if(this.defaults.async&&Ye.passThroughHooksRespectAsync.has(r))return(async()=>{let M=await g.call(i,k);return d.call(i,M)})();let b=g.call(i,k);return d.call(i,b)}:i[s]=(...k)=>{if(this.defaults.async)return(async()=>{let M=await g.apply(i,k);return M===!1&&(M=await d.apply(i,k)),M})();let b=g.apply(i,k);return b===!1&&(b=d.apply(i,k)),b}}o.hooks=i}if(e.walkTokens){let i=this.defaults.walkTokens,r=e.walkTokens;o.walkTokens=function(s){let g=[];return g.push(r.call(this,s)),i&&(g=g.concat(i.call(this,s))),g}}this.defaults=L(L({},this.defaults),o)}),this}setOptions(n){return this.defaults=L(L({},this.defaults),n),this}lexer(n,t){return ce.lex(n,t??this.defaults)}parser(n,t){return de.parse(n,t??this.defaults)}parseMarkdown(n){return(t,e)=>{let o=L({},e),i=L(L({},this.defaults),o),r=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&o.async===!1)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return r(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=n),i.async)return(async()=>{let s=i.hooks?await i.hooks.preprocess(t):t,g=await(i.hooks?await i.hooks.provideLexer():n?ce.lex:ce.lexInline)(s,i),d=i.hooks?await i.hooks.processAllTokens(g):g;i.walkTokens&&await Promise.all(this.walkTokens(d,i.walkTokens));let k=await(i.hooks?await i.hooks.provideParser():n?de.parse:de.parseInline)(d,i);return i.hooks?await i.hooks.postprocess(k):k})().catch(r);try{i.hooks&&(t=i.hooks.preprocess(t));let s=(i.hooks?i.hooks.provideLexer():n?ce.lex:ce.lexInline)(t,i);i.hooks&&(s=i.hooks.processAllTokens(s)),i.walkTokens&&this.walkTokens(s,i.walkTokens);let g=(i.hooks?i.hooks.provideParser():n?de.parse:de.parseInline)(s,i);return i.hooks&&(g=i.hooks.postprocess(g)),g}catch(s){return r(s)}}}onError(n,t){return e=>{if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let o="<p>An error occurred:</p><pre>"+ge(e.message+"",!0)+"</pre>";return t?Promise.resolve(o):o}if(t)return Promise.reject(e);throw e}}},Pe=new Ri;function D(n,t){return Pe.parse(n,t)}D.options=D.setOptions=function(n){return Pe.setOptions(n),D.defaults=Pe.defaults,uo(D.defaults),D};D.getDefaults=Jt;D.defaults=Se;D.use=function(...n){return Pe.use(...n),D.defaults=Pe.defaults,uo(D.defaults),D};D.walkTokens=function(n,t){return Pe.walkTokens(n,t)};D.parseInline=Pe.parseInline;D.Parser=de;D.parser=de.parse;D.Renderer=bt;D.TextRenderer=ln;D.Lexer=ce;D.lexer=ce.lex;D.Tokenizer=xt;D.Hooks=Ye;D.parse=D;var Qc=D.options,Zc=D.setOptions,Xc=D.use,Jc=D.walkTokens,ed=D.parseInline;var td=de.parse,nd=ce.lex;function Di(n,t){if(n&1&&I(0,"span",1),n&2){let e=l().$implicit;Q("innerHTML",e.content,et)}}function Li(n,t){if(n&1){let e=P();u(0,"button",3),S("click",function(){C(e);let i=l().$implicit,r=l();return x(r.emitCitation(i))})("keydown.enter",function(){C(e);let i=l().$implicit,r=l();return x(r.emitCitation(i))})("keydown.space",function(){C(e);let i=l().$implicit,r=l();return x(r.emitCitation(i))}),c(1),m()}if(n&2){let e=l().$implicit,o=l();Ee(o.getCategoryClass(e.citation==null?null:e.citation.conceptCategory)),_e("aria-label","Concept: "+e.content+". Click to view details."),a(),T(" ",e.content," ")}}function Vi(n,t){if(n&1&&f(0,Di,1,1,"span",1)(1,Li,2,4,"button",2),n&2){let e=t.$implicit;_(e.type==="text"?0:1)}}var yt=new D.Renderer,Fi=yt.link.bind(yt);yt.link=n=>Fi(n).replace("<a ",'<a target="_blank" rel="noopener noreferrer" ');D.setOptions({gfm:!0,breaks:!0,renderer:yt});var wt=class n{content=N.required();citations=N([]);citationClick=z();segments$=oe(()=>this.parseContent(this.content(),this.citations()));parseContent(t,e){let o=new Map;for(let b of e)o.set(b.conceptName.toLowerCase(),b);let i=new Map,r=0,s=t.replace(/\[\[([^\]]+)\]\]/g,(b,M)=>{let O=`%%CITE_${r++}%%`;return i.set(O,{name:M,citation:o.get(M.toLowerCase())}),O}),g=D.parse(s,{async:!1});if(i.size===0)return[{type:"text",content:g}];let d=[],k=g.split(/(%%CITE_\d+%%)/);for(let b of k){let M=i.get(b);M?d.push({type:"citation",content:M.name,citation:M.citation}):b.length>0&&d.push({type:"text",content:b})}return d}getCategoryClass(t){return t?t.toLowerCase():""}emitCitation(t){t.citation?this.citationClick.emit(t.citation):this.citationClick.emit(t.content)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-concept-citation"]],inputs:{content:[1,"content"],citations:[1,"citations"]},outputs:{citationClick:"citationClick"},decls:3,vars:0,consts:[[1,"content-with-citations"],[3,"innerHTML"],["type","button","tabindex","0",1,"citation-badge",3,"class"],["type","button","tabindex","0",1,"citation-badge",3,"click","keydown.enter","keydown.space"]],template:function(e,o){e&1&&(u(0,"div",0),j(1,Vi,2,1,null,null,tt),m()),e&2&&(a(),G(o.segments$()))},dependencies:[Y],styles:[".content-with-citations[_ngcontent-%COMP%]{display:block;line-height:1.6}.citation-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.125rem .5rem;margin:0 .125rem;font-size:.875rem;font-weight:500;font-family:Inter,system-ui,sans-serif;border-radius:.375rem;background-color:#1a1a1a;border:1px solid #333;color:#a3a3a3;cursor:pointer;transition:all .15s ease;vertical-align:baseline;text-decoration:none}.citation-badge[_ngcontent-%COMP%]:hover, .citation-badge[_ngcontent-%COMP%]:focus{background-color:#262626;border-color:#525252;color:#e5e5e5;outline:none}.citation-badge[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 2px #3b82f6}.citation-badge.finance[_ngcontent-%COMP%]{border-color:#10b98133;color:#10b981}.citation-badge.finance[_ngcontent-%COMP%]:hover{background-color:#10b98120;border-color:#10b981}.citation-badge.marketing[_ngcontent-%COMP%]{border-color:#f59e0b33;color:#f59e0b}.citation-badge.marketing[_ngcontent-%COMP%]:hover{background-color:#f59e0b20;border-color:#f59e0b}.citation-badge.technology[_ngcontent-%COMP%]{border-color:#3b82f633;color:#3b82f6}.citation-badge.technology[_ngcontent-%COMP%]:hover{background-color:#3b82f620;border-color:#3b82f6}.citation-badge.operations[_ngcontent-%COMP%]{border-color:#8b5cf633;color:#8b5cf6}.citation-badge.operations[_ngcontent-%COMP%]:hover{background-color:#8b5cf620;border-color:#8b5cf6}.citation-badge.legal[_ngcontent-%COMP%]{border-color:#6b728033;color:#6b7280}.citation-badge.legal[_ngcontent-%COMP%]:hover{background-color:#6b728020;border-color:#6b7280}.citation-badge.creative[_ngcontent-%COMP%]{border-color:#ec489933;color:#ec4899}.citation-badge.creative[_ngcontent-%COMP%]:hover{background-color:#ec489920;border-color:#ec4899}"],changeDetection:0})};var zi=(n,t)=>t.memoryId;function Bi(n,t){if(n&1&&(u(0,"span",5),c(1),m()),n&2){let e=l(2);a(),T(" (+",e.additionalCount$()," more) ")}}function Wi(n,t){if(n&1){let e=P();u(0,"div",9)(1,"div",10)(2,"span",11),c(3),m(),u(4,"span",12),c(5),m()(),u(6,"p",13),c(7),m(),u(8,"div",14)(9,"button",15),S("click",function(){let i=C(e).$implicit,r=l(3);return x(r.onViewDetails(i))}),c(10," View details "),m(),u(11,"button",16),S("click",function(){let i=C(e).$implicit,r=l(3);return x(r.onMarkOutdated(i))}),c(12," This is outdated "),m()()()}if(n&2){let e=t.$implicit,o=l(3);Ee(o.getTypeClass(e.type)),a(2),H("background-color",o.getTypeColor(e.type)+"20")("color",o.getTypeColor(e.type)),a(),T(" ",o.getTypeLabel(e.type)," "),a(2),y(e.subject),a(2),y(e.summary)}}function Hi(n,t){if(n&1&&(u(0,"div",7),j(1,Wi,13,9,"div",8,zi),m()),n&2){let e=l(2);a(),G(e.attributions())}}function qi(n,t){if(n&1){let e=P();u(0,"div",0)(1,"div",1)(2,"button",2),S("click",function(){C(e);let i=l();return x(i.toggleExpand())}),u(3,"span",3),c(4,"\u{1F4AD}"),m(),u(5,"span",4),c(6," Based on our previous discussion about "),u(7,"strong"),c(8),m(),f(9,Bi,2,1,"span",5),m(),u(10,"span",6),c(11," \u25BC "),m()()(),f(12,Hi,3,0,"div",7),m()}if(n&2){let e=l();a(2),_e("aria-expanded",e.isExpanded$()),a(6),y(e.primarySubject$()),a(),_(e.additionalCount$()>0?9:-1),a(),A("expanded",e.isExpanded$()),a(2),_(e.isExpanded$()?12:-1)}}var Pt=class n{attributions=N([]);attributionClick=z();outdatedClick=z();isExpanded$=v(!1);primarySubject$=v("");additionalCount$=v(0);ngOnChanges(){this.updatePrimarySubject()}ngOnInit(){this.updatePrimarySubject()}updatePrimarySubject(){let t=this.attributions();t.length>0&&(this.primarySubject$.set(t[0]?.subject??"previous context"),this.additionalCount$.set(Math.max(0,t.length-1)))}toggleExpand(){this.isExpanded$.update(t=>!t)}getTypeClass(t){return t.toLowerCase().replace("_","-")}getTypeColor(t){return Pn[t]??"#6b7280"}getTypeLabel(t){return Sn[t]??"Note"}onViewDetails(t){this.attributionClick.emit(t)}onMarkOutdated(t){this.outdatedClick.emit(t)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-memory-attribution"]],inputs:{attributions:[1,"attributions"]},outputs:{attributionClick:"attributionClick",outdatedClick:"outdatedClick"},features:[hn],decls:1,vars:1,consts:[[1,"memory-attribution-container"],[1,"attribution-header"],["type","button","aria-controls","attribution-details",1,"attribution-toggle",3,"click"],["aria-hidden","true",1,"memory-icon"],[1,"attribution-text"],[1,"additional-count"],[1,"expand-icon"],["id","attribution-details","role","region","aria-label","Memory attribution details",1,"attribution-details"],[1,"attribution-item",3,"class"],[1,"attribution-item"],[1,"item-header"],[1,"type-badge"],[1,"subject"],[1,"summary"],[1,"item-actions"],["type","button","aria-label","View full memory details",1,"action-btn","view-btn",3,"click"],["type","button","aria-label","Mark this memory as outdated",1,"action-btn","outdated-btn",3,"click"]],template:function(e,o){e&1&&f(0,qi,13,6,"div",0),e&2&&_(o.attributions().length>0?0:-1)},dependencies:[Y],styles:[".memory-attribution-container[_ngcontent-%COMP%]{margin:.5rem 0;border-radius:.5rem;background-color:#1a1a1a;border:1px solid #333;overflow:hidden}.attribution-header[_ngcontent-%COMP%]{padding:0}.attribution-toggle[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;background:transparent;border:none;color:#a3a3a3;cursor:pointer;font-size:.875rem;text-align:left;transition:background-color .15s ease}.attribution-toggle[_ngcontent-%COMP%]:hover{background-color:#262626}.attribution-toggle[_ngcontent-%COMP%]:focus{outline:none}.attribution-toggle[_ngcontent-%COMP%]:focus-visible{box-shadow:inset 0 0 0 2px #3b82f6}.memory-icon[_ngcontent-%COMP%]{font-size:1rem}.attribution-text[_ngcontent-%COMP%]{flex:1;font-style:italic}.attribution-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#e5e5e5;font-weight:600}.additional-count[_ngcontent-%COMP%]{color:#737373;font-size:.75rem;margin-left:.25rem}.expand-icon[_ngcontent-%COMP%]{font-size:.625rem;transition:transform .2s ease;color:#737373}.expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(180deg)}.attribution-details[_ngcontent-%COMP%]{padding:0 1rem 1rem;border-top:1px solid #333}.attribution-item[_ngcontent-%COMP%]{padding:.75rem;margin-top:.75rem;border-radius:.375rem;background-color:#0d0d0d;border:1px solid #262626}.item-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem}.type-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.125rem .5rem;font-size:.75rem;font-weight:500;border-radius:.25rem;text-transform:uppercase;letter-spacing:.025em}.subject[_ngcontent-%COMP%]{font-weight:600;color:#e5e5e5;font-size:.875rem}.summary[_ngcontent-%COMP%]{margin:0 0 .75rem;color:#a3a3a3;font-size:.875rem;line-height:1.5}.item-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.75rem;font-weight:500;border-radius:.25rem;border:1px solid #333;background-color:transparent;color:#a3a3a3;cursor:pointer;transition:all .15s ease}.action-btn[_ngcontent-%COMP%]:hover{background-color:#262626;color:#e5e5e5}.action-btn[_ngcontent-%COMP%]:focus{outline:none}.action-btn[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 2px #3b82f6}.view-btn[_ngcontent-%COMP%]:hover{border-color:#3b82f6;color:#3b82f6}.outdated-btn[_ngcontent-%COMP%]{color:#f59e0b;border-color:#f59e0b33}.outdated-btn[_ngcontent-%COMP%]:hover{background-color:#f59e0b20;border-color:#f59e0b;color:#f59e0b}"],changeDetection:0})};var yo=()=>[];function Ui(n,t){if(n&1&&(p(0,"p",4),c(1),h()),n&2){let e=l(2);a(),y(e.formatTime(e.message().createdAt))}}function ji(n,t){if(n&1&&(p(0,"div",0)(1,"div",2)(2,"div",3),c(3),h(),f(4,Ui,2,1,"p",4),h()()),n&2){let e=l();a(3),y(e.message().content),a(),_(e.message().createdAt?4:-1)}}function Gi(n,t){n&1&&(w(),E(0,"path",17))}function Yi(n,t){n&1&&(w(),E(0,"path",18))}function Ki(n,t){n&1&&(w(),E(0,"path",19))}function Qi(n,t){if(n&1&&(p(0,"div",15),w(),p(1,"svg",16),f(2,Gi,1,0,":svg:path",17)(3,Yi,1,0,":svg:path",18)(4,Ki,1,0,":svg:path",19),h(),c(5),h()),n&2){let e=l(2);A("confidence-high",e.confidenceLevel$()==="HIGH")("confidence-medium",e.confidenceLevel$()==="MEDIUM")("confidence-low",e.confidenceLevel$()==="LOW"),a(2),_(e.confidenceLevel$()==="HIGH"?2:e.confidenceLevel$()==="MEDIUM"?3:4),a(3),T(" ",(e.message().confidenceScore*100).toFixed(0),"% confident ")}}function Zi(n,t){if(n&1){let e=P();p(0,"div",11)(1,"app-memory-attribution",20),R("attributionClick",function(i){C(e);let r=l(2);return x(r.onAttributionClick(i))})("outdatedClick",function(i){C(e);let r=l(2);return x(r.onOutdatedClick(i))}),h()()}if(n&2){let e=l(2);a(),X("attributions",e.message().memoryAttributions??ye(1,yo))}}function Xi(n,t){n&1&&(p(0,"span",13),c(1,"\xA0"),h())}function Ji(n,t){if(n&1&&(p(0,"div",21),w(),p(1,"svg",16),E(2,"path",23),h(),F(),p(3,"p",24)(4,"span",25),c(5,"To improve:"),h(),c(6),h()()),n&2){let e=l(3);a(6),T(" ",e.improvementSuggestion()," ")}}function er(n,t){if(n&1&&(p(0,"p",22),c(1),h()),n&2){let e=l(3);a(),y(e.formatTime(e.message().createdAt))}}function tr(n,t){if(n&1&&(p(0,"div",14),f(1,Ji,7,1,"div",21),f(2,er,2,1,"p",22),h()),n&2){let e=l(2);a(),_(e.showImprovementSuggestion$()?1:-1),a(),_(e.message().createdAt?2:-1)}}function nr(n,t){if(n&1){let e=P();p(0,"div",1)(1,"div",5)(2,"div",6)(3,"div",7),c(4),h(),p(5,"span",8),c(6),h()(),f(7,Qi,6,8,"div",9),h(),p(8,"div",10),f(9,Zi,2,2,"div",11),p(10,"app-concept-citation",12),R("citationClick",function(i){C(e);let r=l();return x(r.onCitationClick(i))}),h(),f(11,Xi,2,0,"span",13),h(),f(12,tr,3,2,"div",14),h()}if(n&2){let e=l();a(3),H("background-color",e.getPersonaColor()),a(),T(" ",e.getPersonaInitial()," "),a(),H("color",e.personaType()?e.getPersonaColor():"#FAFAFA"),a(),T(" ",e.getPersonaLabel()," "),a(),_(!e.isStreaming()&&e.hasConfidence$()?7:-1),a(2),_(!e.isStreaming()&&e.hasMemoryAttributions$()?9:-1),a(),X("content",e.message().content)("citations",e.message().citations??ye(12,yo)),a(),_(e.isStreaming()?11:-1),a(),_(e.isStreaming()?-1:12)}}var St=class n{get hostId(){return`msg-${this.message().id}`}message=N.required();isStreaming=N(!1);personaType=N(null);improvementSuggestion=N(null);citationClick=z();attributionClick=z();outdatedClick=z();onCitationClick(t){this.citationClick.emit(t)}onAttributionClick(t){this.attributionClick.emit(t)}onOutdatedClick(t){this.outdatedClick.emit(t)}previousScore=N(null);improvementDelta=N(null);hasConfidence$=oe(()=>{let t=this.message().confidenceScore;return t!=null});hasMemoryAttributions$=oe(()=>{let t=this.message().memoryAttributions;return t!=null&&t.length>0});confidenceLevel$=oe(()=>{let t=this.message().confidenceScore;return t==null?"MEDIUM":t>=.85?"HIGH":t>=.5?"MEDIUM":"LOW"});showImprovementSuggestion$=oe(()=>{let t=this.improvementSuggestion(),e=this.confidenceLevel$();return t!=null&&(e==="LOW"||e==="MEDIUM")});formatTime(t){return t?new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}personaColors={CFO:"#3B82F6",CMO:"#8B5CF6",CTO:"#10B981",OPERATIONS:"#F59E0B",LEGAL:"#EF4444",CREATIVE:"#EC4899"};personaLabels={CFO:"CFO",CMO:"CMO",CTO:"CTO",OPERATIONS:"Operations",LEGAL:"Legal",CREATIVE:"Creative"};getPersonaColor(){let t=this.personaType();return t?this.personaColors[t]??"#3B82F6":"#3B82F6"}getPersonaInitial(){let t=this.personaType();return t?(this.personaLabels[t]??"AI").charAt(0):"AI"}getPersonaLabel(){let t=this.personaType();return t?this.personaLabels[t]??"AI Assistant":"AI Assistant"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-chat-message"]],hostVars:1,hostBindings:function(e,o){e&2&&_e("id",o.hostId)},inputs:{message:[1,"message"],isStreaming:[1,"isStreaming"],personaType:[1,"personaType"],improvementSuggestion:[1,"improvementSuggestion"],previousScore:[1,"previousScore"],improvementDelta:[1,"improvementDelta"]},outputs:{citationClick:"citationClick",attributionClick:"attributionClick",outdatedClick:"outdatedClick"},decls:2,vars:2,consts:[[1,"msg-user-row"],[1,"ai-card"],[1,"msg-user"],[1,"msg-user-text"],[1,"msg-user-time"],[1,"ai-header"],[1,"ai-header-left"],[1,"persona-avatar"],[1,"persona-name"],[1,"confidence-badge",3,"confidence-high","confidence-medium","confidence-low"],[1,"ai-content"],[1,"memory-section"],[3,"citationClick","content","citations"],[1,"cursor-blink"],[1,"ai-footer"],[1,"confidence-badge"],["fill","currentColor","viewBox","0 0 20 20"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[3,"attributionClick","outdatedClick","attributions"],[1,"improvement-row"],[1,"ai-time"],["d","M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"],[1,"improvement-text"],[1,"improvement-label"]],template:function(e,o){e&1&&(f(0,ji,5,2,"div",0),f(1,nr,13,13,"div",1)),e&2&&(_(o.message().role==="USER"?0:-1),a(),_(o.message().role==="ASSISTANT"?1:-1))},dependencies:[Y,wt,Pt],styles:["[_nghost-%COMP%]{display:block}.msg-user-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.msg-user[_ngcontent-%COMP%]{max-width:70%;background:#3b82f6;color:#fff;border-radius:16px 16px 4px;padding:12px 16px}.msg-user-text[_ngcontent-%COMP%]{font-size:15px;line-height:1.6;white-space:pre-wrap;word-break:break-word}.msg-user-time[_ngcontent-%COMP%]{font-size:11px;color:#fff9;margin-top:8px;text-align:right}.ai-card[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:12px;border:1px solid #2A2A2A;overflow:hidden}.ai-header[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #2A2A2A;display:flex;align-items:center;justify-content:space-between}.ai-header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.persona-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:600}.persona-name[_ngcontent-%COMP%]{font-size:13px;font-weight:500}.confidence-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:4px 10px;border-radius:20px;font-size:11px;font-weight:500}.confidence-badge[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px}.confidence-high[_ngcontent-%COMP%]{color:#22c55e;background:#22c55e1a}.confidence-medium[_ngcontent-%COMP%]{color:#eab308;background:#eab3081a}.confidence-low[_ngcontent-%COMP%]{color:#ef4444;background:#ef44441a}.ai-content[_ngcontent-%COMP%]{padding:20px;font-size:15px;line-height:1.75;color:#e0e0e0;word-break:break-word}.ai-content[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{margin-top:0!important}.ai-content[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{margin-bottom:0!important}.ai-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6em;font-weight:700;color:#fafafa;margin:28px 0 12px;letter-spacing:-.01em}.ai-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.35em;font-weight:600;color:#fafafa;margin:24px 0 10px;letter-spacing:-.01em}.ai-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.15em;font-weight:600;color:#fafafa;margin:22px 0 8px}.ai-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .ai-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .ai-content[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:1em;font-weight:600;color:#e5e5e5;margin:20px 0 6px}.ai-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:16px 0}.ai-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#fafafa;font-weight:600}.ai-content[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{color:#d4d4d4;font-style:italic}.ai-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .ai-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:16px 0;padding-left:1.75em;list-style-position:outside}.ai-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:disc}.ai-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style-type:decimal}.ai-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:.4em 0;line-height:1.75;color:#e0e0e0}.ai-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker{color:#8b8b8b}.ai-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%], .ai-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] > ol[_ngcontent-%COMP%]{margin:.3em 0}.ai-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin:.4em 0}.ai-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:circle}.ai-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:square}.ai-content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin:20px 0;font-size:.9em}.ai-content[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#262626;color:#fafafa;font-weight:600;text-align:left;padding:10px 14px;border:1px solid #333}.ai-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;border:1px solid #2A2A2A;color:#d4d4d4}.ai-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#1a1a1a}.ai-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background:#0d0d0d}.ai-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#262626}.ai-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#262626;color:#e5e5e5;padding:.15em .4em;border-radius:4px;font-family:JetBrains Mono,Fira Code,Consolas,monospace;font-size:.875em}.ai-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background:#0d0d0d;border:1px solid #2A2A2A;border-radius:8px;padding:14px 18px;overflow-x:auto;margin:20px 0}.ai-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:none;padding:0;border-radius:0;font-size:.85em;line-height:1.5}.ai-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{border-left:3px solid #3B82F6;margin:20px 0;padding:.75em 1.25em;color:#a1a1a1;background:#3b82f60d;border-radius:0 6px 6px 0}.ai-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.4em 0}.ai-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#60a5fa;text-decoration:underline;text-underline-offset:2px}.ai-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#93c5fd}.ai-content[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:none;border-top:1px solid #2A2A2A;margin:24px 0}.ai-content[_ngcontent-%COMP%]   del[_ngcontent-%COMP%]{color:#6b6b6b;text-decoration:line-through}.ai-footer[_ngcontent-%COMP%]{padding:12px 16px;border-top:1px solid #2A2A2A}.ai-time[_ngcontent-%COMP%]{font-size:11px;color:#6b6b6b}.improvement-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-bottom:8px}.improvement-row[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;color:#eab308;flex-shrink:0;margin-top:2px}.improvement-text[_ngcontent-%COMP%]{font-size:13px;color:#a1a1a1;line-height:1.5}.improvement-label[_ngcontent-%COMP%]{color:#eab308;font-weight:500}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.cursor-blink[_ngcontent-%COMP%]{display:inline-block;width:6px;height:20px;background:#3b82f6;border-radius:2px;margin-left:2px;animation:_ngcontent-%COMP%_pulse 1s ease-in-out infinite;vertical-align:text-bottom}.memory-section[_ngcontent-%COMP%]{margin-bottom:12px}"]})};var or=["inputRef"];function ir(n,t){n&1&&(w(),p(0,"svg",7),E(1,"circle",10)(2,"path",11),h())}function rr(n,t){n&1&&(w(),p(0,"svg",8),E(1,"path",12),h())}var Et=class n{disabled=N(!1);messageSent=z();inputRef;inputValue="";handleKeydown(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),this.send())}send(){let t=this.inputValue.trim();!t||this.disabled()||(this.messageSent.emit(t),this.inputValue="",this.inputRef?.nativeElement&&(this.inputRef.nativeElement.style.height="auto"))}autoResize(){let t=this.inputRef?.nativeElement;t&&(t.style.height="auto",t.style.height=`${Math.min(t.scrollHeight,200)}px`)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-chat-input"]],viewQuery:function(e,o){if(e&1&&ot(or,5),e&2){let i;ve(i=ke())&&(o.inputRef=i.first)}},inputs:{disabled:[1,"disabled"]},outputs:{messageSent:"messageSent"},decls:17,vars:4,consts:[["inputRef",""],[1,"input-wrapper"],[1,"input-inner"],[1,"input-row"],[1,"textarea-wrap"],["placeholder","Ask Mentor AI anything...","rows","1",3,"ngModelChange","keydown","input","ngModel","disabled"],["title","Send message",1,"send-btn",3,"click","disabled"],["fill","none","viewBox","0 0 24 24",1,"spin"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],[1,"hint"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",2,"opacity","0.25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",2,"opacity","0.75"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"]],template:function(e,o){if(e&1){let i=P();p(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"textarea",5,0),_n("ngModelChange",function(s){return C(i),fn(o.inputValue,s)||(o.inputValue=s),x(s)}),R("keydown",function(s){return C(i),x(o.handleKeydown(s))})("input",function(){return C(i),x(o.autoResize())}),h()(),p(6,"button",6),R("click",function(){return C(i),x(o.send())}),f(7,ir,3,0,":svg:svg",7)(8,rr,2,0,":svg:svg",8),h()(),p(9,"p",9),c(10," Press "),p(11,"kbd"),c(12,"Enter"),h(),c(13," to send, "),p(14,"kbd"),c(15,"Shift+Enter"),h(),c(16," for new line "),h()()()}e&2&&(a(4),gn("ngModel",o.inputValue),X("disabled",o.disabled()),a(2),X("disabled",o.disabled()||!o.inputValue.trim()),a(),_(o.disabled()?7:8))},dependencies:[Y,rt,En,Mn,Tn],styles:["[_nghost-%COMP%]{display:block}.input-wrapper[_ngcontent-%COMP%]{border-top:1px solid #2A2A2A;padding:16px;background:#0d0d0d}.input-inner[_ngcontent-%COMP%]{max-width:768px;margin:0 auto}.input-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:12px;background:#1a1a1a;border:1px solid #2A2A2A;border-radius:12px;padding:8px;transition:border-color .2s}.input-row[_ngcontent-%COMP%]:focus-within{border-color:#3b82f6}.textarea-wrap[_ngcontent-%COMP%]{flex:1}textarea[_ngcontent-%COMP%]{width:100%;resize:none;background:transparent;border:none;outline:none;color:#fafafa;font-size:15px;font-family:inherit;line-height:1.5;padding:6px 8px;max-height:200px}textarea[_ngcontent-%COMP%]::placeholder{color:#6b6b6b}textarea[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.send-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;min-width:40px;background:#3b82f6;color:#fff;border:none;border-radius:8px;cursor:pointer;transition:opacity .15s}.send-btn[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.9}.send-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.send-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.hint[_ngcontent-%COMP%]{font-size:11px;color:#6b6b6b;text-align:center;margin-top:8px}.hint[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{display:inline-block;padding:1px 6px;background:#242424;border-radius:3px;font-size:10px;font-family:monospace}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}"]})};var Mt=class n{personaType=N(null);personaColors={CFO:"#3B82F6",CMO:"#8B5CF6",CTO:"#10B981",OPERATIONS:"#F59E0B",LEGAL:"#EF4444",CREATIVE:"#EC4899"};personaLabels={CFO:"CFO",CMO:"CMO",CTO:"CTO",OPERATIONS:"Operations",LEGAL:"Legal",CREATIVE:"Creative"};getPersonaColor(){let t=this.personaType();return t?this.personaColors[t]??"#3B82F6":"#3B82F6"}getPersonaInitial(){let t=this.personaType();if(!t)return"AI";let e=this.personaLabels[t];return e?e.charAt(0):"AI"}getPersonaLabel(){let t=this.personaType();return t?this.personaLabels[t]??"AI Assistant":"AI Assistant"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-typing-indicator"]],inputs:{personaType:[1,"personaType"]},decls:15,vars:12,consts:[[1,"ai-response-card","overflow-hidden","animate-in"],[1,"ai-response-header"],[1,"flex","items-center","gap-3"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","text-white","text-[13px]","font-semibold"],[1,"flex","items-center","gap-2"],[1,"text-[13px]","font-medium"],[1,"text-[11px]","text-[var(--color-text-muted)]"],[1,"ai-response-content"],[1,"flex","items-center","gap-1.5"],[1,"w-2","h-2","rounded-full","animate-bounce",2,"animation-delay","0ms","animation-duration","1s"],[1,"w-2","h-2","rounded-full","animate-bounce",2,"animation-delay","150ms","animation-duration","1s"],[1,"w-2","h-2","rounded-full","animate-bounce",2,"animation-delay","300ms","animation-duration","1s"]],template:function(e,o){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c(4),m(),u(5,"div",4)(6,"span",5),c(7),m(),u(8,"span",6),c(9,"is thinking..."),m()()()(),u(10,"div",7)(11,"div",8),I(12,"span",9)(13,"span",10)(14,"span",11),m()()()),e&2&&(a(3),H("background-color",o.getPersonaColor()),a(),T(" ",o.getPersonaInitial()," "),a(2),H("color",o.getPersonaColor()),a(),T(" ",o.getPersonaLabel()," "),a(5),H("background-color",o.getPersonaColor()),a(),H("background-color",o.getPersonaColor()),a(),H("background-color",o.getPersonaColor()))},dependencies:[Y],encapsulation:2})};var Tt=class n{http=W(re);baseUrl="/api/v1/personas";async getPersonas(){return(await B(this.http.get(this.baseUrl))).data}async getPersonaByType(t){return(await B(this.http.get(`${this.baseUrl}/${t}`))).data}static \u0275fac=function(e){return new(e||n)};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})};var ar=()=>[1,2,3,4,5,6],sr=(n,t)=>t.id;function lr(n,t){n&1&&I(0,"div",3)}function cr(n,t){n&1&&(u(0,"div",1),j(1,lr,1,0,"div",3,nt),m()),n&2&&(a(),G(ye(0,ar)))}function dr(n,t){if(n&1&&(u(0,"div",2),w(),u(1,"svg",4),I(2,"path",5),m(),c(3),m()),n&2){let e=l();a(3),T(" ",e.errorMessage$()," ")}}function pr(n,t){if(n&1){let e=P();u(0,"button",8),S("click",function(){let i=C(e).$implicit,r=l(2);return x(r.selectPersona(i))}),u(1,"div",9),c(2),m(),u(3,"span",10),c(4),m(),u(5,"span",11),c(6),m()()}if(n&2){let e,o,i,r,s,g=t.$implicit,d=l(2);H("border-color",((e=d.selectedPersona$())==null?null:e.id)===g.id?g.color:"transparent")("background-color",((o=d.selectedPersona$())==null?null:o.id)===g.id?g.color+"15":""),A("surface-elevated",((i=d.selectedPersona$())==null?null:i.id)!==g.id)("border-transparent",((r=d.selectedPersona$())==null?null:r.id)!==g.id),a(),H("background-color",g.color),a(),T(" ",g.shortName.charAt(0)," "),a(),H("color",((s=d.selectedPersona$())==null?null:s.id)===g.id?g.color:"var(--color-text-primary)"),a(),T(" ",g.shortName," "),a(2),T(" ",d.getShortDescription(g.description)," ")}}function ur(n,t){if(n&1){let e=P();u(0,"button",12),S("click",function(){C(e);let i=l(2);return x(i.clearSelection())}),w(),u(1,"svg",13),I(2,"path",14),m(),c(3),m()}if(n&2){let e=l(2);A("text-[var(--color-text-primary)]",!e.selectedPersona$()),a(3),T(" ",e.selectedPersona$()?"Clear selection":"No persona selected"," ")}}function mr(n,t){if(n&1&&(u(0,"div",1),j(1,pr,7,15,"button",6,sr),m(),f(3,ur,4,3,"button",7)),n&2){let e=l();a(),G(e.personas$()),a(2),_(e.allowNone()?3:-1)}}var Ot=class n{personasService=W(Tt);selectedType=N(null);allowNone=N(!0);personaSelected=z();personas$=v([]);selectedPersona$=v(null);isLoading$=v(!0);errorMessage$=v(null);async ngOnInit(){await this.loadPersonas();let t=this.selectedType();if(t){let e=this.personas$().find(o=>o.type===t);e&&this.selectedPersona$.set(e)}}async loadPersonas(){this.isLoading$.set(!0),this.errorMessage$.set(null);try{let t=await this.personasService.getPersonas();this.personas$.set(t)}catch{this.errorMessage$.set("Failed to load personas")}finally{this.isLoading$.set(!1)}}selectPersona(t){this.selectedPersona$.set(t),this.personaSelected.emit(t)}clearSelection(){this.selectedPersona$.set(null),this.personaSelected.emit(null)}getShortDescription(t){return t.length<=50?t:t.substring(0,47)+"..."}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-persona-selector"]],inputs:{selectedType:[1,"selectedType"],allowNone:[1,"allowNone"]},outputs:{personaSelected:"personaSelected"},decls:4,vars:1,consts:[[1,"persona-selector"],[1,"grid","grid-cols-2","gap-2","sm:grid-cols-3","md:grid-cols-6"],[1,"flex","items-center","gap-2","text-[var(--color-error)]","text-[13px]","p-3","surface-elevated","rounded-lg"],[1,"skeleton","rounded-xl","h-24"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","shrink-0"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"flex","flex-col","items-center","p-3","rounded-xl","border-2","transition-all","duration-200","hover:scale-[1.02]","min-h-[96px]",3,"surface-elevated","border-transparent","borderColor","backgroundColor"],[1,"mt-3","text-[13px]","text-[var(--color-text-muted)]","hover:text-[var(--color-text-primary)]","transition-colors","flex","items-center","gap-1.5",3,"text-[var(--color-text-primary)]"],[1,"flex","flex-col","items-center","p-3","rounded-xl","border-2","transition-all","duration-200","hover:scale-[1.02]","min-h-[96px]",3,"click"],[1,"w-10","h-10","rounded-full","flex","items-center","justify-center","text-white","font-semibold","text-[13px]","mb-2","shadow-lg"],[1,"text-[13px]","font-medium","text-center"],[1,"text-[11px]","text-[var(--color-text-muted)]","text-center","mt-1","line-clamp-2","hidden","sm:block"],[1,"mt-3","text-[13px]","text-[var(--color-text-muted)]","hover:text-[var(--color-text-primary)]","transition-colors","flex","items-center","gap-1.5",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"]],template:function(e,o){e&1&&(u(0,"div",0),f(1,cr,3,1,"div",1)(2,dr,4,1,"div",2)(3,mr,4,1),m()),e&2&&(a(),_(o.isLoading$()?1:o.errorMessage$()?2:3))},dependencies:[Y],styles:[".persona-selector[_ngcontent-%COMP%]{width:100%}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};function hr(n,t){if(n&1&&(u(0,"span",1),c(1),m()),n&2){let e=l();H("background-color",e.getColor()+"30")("color",e.getColor())("border-color",e.getColor()),a(),T(" ",e.getName()," ")}}var It=class n{personaType=N(null);getColor(){let t=this.personaType();return t&&yn[t]||"#6B7280"}getName(){let t=this.personaType();return t?wn[t]||t:""}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-persona-badge"]],inputs:{personaType:[1,"personaType"]},decls:1,vars:1,consts:[[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium",2,"border-width","1px",3,"backgroundColor","color","borderColor"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium",2,"border-width","1px"]],template:function(e,o){e&1&&f(0,hr,2,7,"span",0),e&2&&_(o.personaType()?0:-1)},dependencies:[Y],encapsulation:2})};var gr=(n,t)=>t.id;function fr(n,t){if(n&1&&(u(0,"span",15),c(1),m(),u(2,"h2",16),c(3),m()),n&2){let e=l(2);Ee(e.getCategoryClass(e.concept$().category)),a(),T(" ",e.concept$().category," "),a(2),y(e.concept$().name)}}function _r(n,t){n&1&&I(0,"div",17)(1,"div",18)}function Cr(n,t){if(n&1){let e=P();u(0,"div",9)(1,"p"),c(2),m(),u(3,"button",19),S("click",function(){C(e);let i=l(2);return x(i.loadConcept())}),c(4," Retry "),m()()}if(n&2){let e=l(2);a(2),y(e.error$())}}function xr(n,t){n&1&&I(0,"div",20)(1,"div",21)}function br(n,t){if(n&1&&(u(0,"div",23)(1,"h3",25),c(2,"Detalji"),m(),I(3,"div",26),m()),n&2){let e=l(3);a(3),Q("innerHTML",e.renderMarkdown(e.concept$().extendedDescription),et)}}function vr(n,t){if(n&1){let e=P();u(0,"button",29),S("click",function(){let i=C(e).$implicit,r=l(4);return x(r.onConceptClicked(i.id))}),c(1),m()}if(n&2){let e=t.$implicit;a(),T(" ",e.name," ")}}function kr(n,t){if(n&1&&(u(0,"div",24)(1,"h3",25),c(2,"Related Concepts"),m(),u(3,"div",27),j(4,vr,2,1,"button",28,gr),m()()),n&2){let e=l(3);a(4),G(e.concept$().relatedConcepts)}}function yr(n,t){if(n&1&&(u(0,"p",22),c(1),m(),f(2,br,4,1,"div",23),f(3,kr,6,0,"div",24)),n&2){let e=l(2);a(),y(e.concept$().definition),a(),_(e.concept$().extendedDescription?2:-1),a(),_(e.concept$().relatedConcepts.length>0?3:-1)}}function wr(n,t){if(n&1){let e=P();u(0,"div",0),S("click",function(){C(e);let i=l();return x(i.onClose())}),m(),u(1,"div",1)(2,"div",2)(3,"div",3),f(4,fr,4,4)(5,_r,2,0),m(),u(6,"button",4),S("click",function(){C(e);let i=l();return x(i.onClose())}),w(),u(7,"svg",5),I(8,"line",6)(9,"line",7),m()()(),F(),u(10,"div",8),f(11,Cr,5,1,"div",9)(12,xr,2,0)(13,yr,4,3),m(),u(14,"div",10)(15,"button",11),S("click",function(){C(e);let i=l();return x(i.onLearnMore())}),c(16," Learn More "),w(),u(17,"svg",12),I(18,"line",13)(19,"polyline",14),m()()()()}if(n&2){let e,o=l();a(),_e("aria-label",(e=o.concept$())!=null&&e.name?"Concept: "+((e=o.concept$())==null?null:e.name):"Loading concept"),a(3),_(o.concept$()?4:o.isLoading$()?5:-1),a(7),_(o.error$()?11:o.isLoading$()?12:o.concept$()?13:-1),a(4),Q("disabled",!o.concept$())}}var $t=class n{http=W(re);sanitizer=W(Cn);conceptId=N(null);isOpen=N(!1);close=z();conceptClick=z();learnMore=z();concept$=v(null);isLoading$=v(!1);error$=v(null);constructor(){Je(()=>{this.conceptId()&&this.isOpen()&&this.loadConcept()})}async loadConcept(){let t=this.conceptId();if(t){this.isLoading$.set(!0),this.error$.set(null);try{let e=await B(this.http.get(`/api/v1/knowledge/concepts/${t}/summary`));e?.data&&this.concept$.set(e.data)}catch(e){let o=e instanceof Error?e.message:"Unknown error";this.error$.set(`Failed to load concept details: ${o}`)}finally{this.isLoading$.set(!1)}}}getCategoryClass(t){return t?t.toLowerCase():""}onClose(){this.close.emit()}onConceptClicked(t){this.conceptClick.emit(t)}renderMarkdown(t){let e=D.parse(t,{async:!1});return this.sanitizer.bypassSecurityTrustHtml(e)}onLearnMore(){let t=this.concept$();t&&this.learnMore.emit(t.id)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-concept-panel"]],inputs:{conceptId:[1,"conceptId"],isOpen:[1,"isOpen"]},outputs:{close:"close",conceptClick:"conceptClick",learnMore:"learnMore"},decls:1,vars:1,consts:[["role","presentation",1,"panel-backdrop",3,"click"],["role","dialog","aria-modal","true",1,"concept-panel"],[1,"panel-header"],[1,"header-content"],["type","button","aria-label","Close panel",1,"close-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"panel-content"],[1,"error-message"],[1,"panel-footer"],["type","button",1,"learn-more-button",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","5","y1","12","x2","19","y2","12"],["points","12 5 19 12 12 19"],[1,"category-badge"],[1,"concept-name"],[1,"skeleton","skeleton-badge"],[1,"skeleton","skeleton-title"],["type","button",1,"retry-button",3,"click"],[1,"skeleton","skeleton-text"],[1,"skeleton","skeleton-text","short"],[1,"definition"],[1,"extended-section"],[1,"related-section"],[1,"section-title"],[1,"extended-text",3,"innerHTML"],[1,"related-chips"],["type","button",1,"related-chip"],["type","button",1,"related-chip",3,"click"]],template:function(e,o){e&1&&f(0,wr,20,4),e&2&&_(o.isOpen()?0:-1)},dependencies:[Y],styles:[".panel-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:40}.concept-panel[_ngcontent-%COMP%]{position:fixed;top:0;right:0;height:100vh;width:320px;max-width:90vw;background:#0a0a0a;border-left:1px solid #262626;display:flex;flex-direction:column;z-index:50;animation:_ngcontent-%COMP%_slideIn .2s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(100%)}to{transform:translate(0)}}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:1rem;border-bottom:1px solid #262626}.header-content[_ngcontent-%COMP%]{flex:1;min-width:0}.category-badge[_ngcontent-%COMP%]{display:inline-block;padding:.125rem .5rem;font-size:.75rem;font-weight:500;border-radius:9999px;background:#1a1a1a;color:#a3a3a3;margin-bottom:.5rem}.category-badge.finance[_ngcontent-%COMP%]{background:#10b98120;color:#10b981}.category-badge.marketing[_ngcontent-%COMP%]{background:#f59e0b20;color:#f59e0b}.category-badge.technology[_ngcontent-%COMP%]{background:#3b82f620;color:#3b82f6}.category-badge.operations[_ngcontent-%COMP%]{background:#8b5cf620;color:#8b5cf6}.category-badge.legal[_ngcontent-%COMP%]{background:#6b728020;color:#6b7280}.category-badge.creative[_ngcontent-%COMP%]{background:#ec489920;color:#ec4899}.concept-name[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#f5f5f5;margin:0;line-height:1.4}.close-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:transparent;border:none;color:#737373;cursor:pointer;border-radius:.375rem;transition:all .15s ease;flex-shrink:0;margin-left:.5rem}.close-button[_ngcontent-%COMP%]:hover{background:#262626;color:#e5e5e5}.panel-content[_ngcontent-%COMP%]{flex:1;padding:1rem;overflow-y:auto}.definition[_ngcontent-%COMP%]{color:#d4d4d4;line-height:1.6;margin:0 0 1.5rem}.extended-section[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:1px solid #262626}.extended-text[_ngcontent-%COMP%]{color:#b0b0b0;font-size:.875rem;line-height:1.7}.extended-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10px 0}.extended-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .extended-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .extended-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#e0e0e0;margin:16px 0 8px}.extended-text[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .extended-text[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{padding-left:1.5em;margin:8px 0}.extended-text[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:4px 0}.extended-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#e5e5e5}.related-section[_ngcontent-%COMP%]{margin-top:1.5rem}.section-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#737373;margin:0 0 .75rem;text-transform:uppercase;letter-spacing:.05em}.related-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.related-chip[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem;background:#1a1a1a;border:1px solid #333;color:#a3a3a3;border-radius:9999px;cursor:pointer;transition:all .15s ease}.related-chip[_ngcontent-%COMP%]:hover{background:#262626;border-color:#525252;color:#e5e5e5}.panel-footer[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid #262626}.learn-more-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;width:100%;padding:.75rem;font-size:.875rem;font-weight:500;background:#262626;border:1px solid #333;color:#e5e5e5;border-radius:.5rem;cursor:pointer;transition:all .15s ease}.learn-more-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#333;border-color:#525252}.learn-more-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{text-align:center;color:#ef4444;padding:2rem}.retry-button[_ngcontent-%COMP%]{margin-top:1rem;padding:.5rem 1rem;background:#262626;border:1px solid #333;color:#e5e5e5;border-radius:.375rem;cursor:pointer}.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#1a1a1a 25%,#262626,#1a1a1a 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite;border-radius:.25rem}.skeleton-badge[_ngcontent-%COMP%]{width:80px;height:20px;margin-bottom:.5rem}.skeleton-title[_ngcontent-%COMP%]{width:180px;height:24px}.skeleton-text[_ngcontent-%COMP%]{width:100%;height:16px;margin-bottom:.75rem}.skeleton-text.short[_ngcontent-%COMP%]{width:75%}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}"],changeDetection:0})};var Pr=()=>[1,2,3];function Sr(n,t){return this.trackRow(t)}var Er=(n,t)=>t.id;function Mr(n,t){n&1&&(u(0,"div",2),I(1,"div",3)(2,"div",4)(3,"div",5),m())}function Tr(n,t){n&1&&(u(0,"div",1),j(1,Mr,4,0,"div",2,nt),m()),n&2&&(a(),G(ye(0,Pr)))}function Or(n,t){n&1&&I(0,"span",14)}function Ir(n,t){if(n&1&&(u(0,"span",15),c(1),m()),n&2){let e=l(2).$implicit;a(),y(e.node.conversationCount)}}function $r(n,t){if(n&1){let e=P();u(0,"button",17),S("click",function(i){C(e);let r=l(2).$implicit,s=l(2);return x(s.onNewChat(i,r.node.curriculumId,r.node.label))}),w(),u(1,"svg",18),I(2,"path",19),m()()}}function Nr(n,t){if(n&1){let e=P();u(0,"button",10),S("click",function(){C(e);let i=l().$implicit,r=l(2);return x(r.toggleNode(i.node.curriculumId))}),w(),u(1,"svg",11),S("click",function(i){C(e);let r=l().$implicit;return l(2).toggleNode(r.node.curriculumId),x(i.stopPropagation())}),I(2,"path",12),m(),F(),u(3,"span",13),S("click",function(i){C(e);let r=l().$implicit,s=l(2);return x(s.onNodeClick(i,r.node))}),c(4),m(),f(5,Or,1,0,"span",14),f(6,Ir,2,1,"span",15),f(7,$r,3,0,"button",16),m()}if(n&2){let e=l().$implicit,o=l(2);H("padding-left",12+e.depth*16,"px"),A("root-node",e.depth===0),a(),A("expanded",o.expandedNodes().has(e.node.curriculumId)),a(3),y(e.node.label),a(),_(o.hasNewConversations(e.node.curriculumId)?5:-1),a(),_(e.node.conversationCount>0?6:-1),a(),_(e.node.conceptId?7:-1)}}function Ar(n,t){n&1&&I(0,"span",22)}function Rr(n,t){n&1&&I(0,"span",14)}function Dr(n,t){if(n&1){let e=P();u(0,"button",20),S("click",function(){C(e);let i=l().$implicit,r=l(2);return x(r.onConversationSelect(i.conversation.id))}),u(1,"div",21),f(2,Ar,1,0,"span",22)(3,Rr,1,0,"span",14),u(4,"div",23),c(5),m()(),u(6,"div",24),c(7),m()()}if(n&2){let e=l().$implicit,o=l(2);H("padding-left",12+e.depth*16,"px"),A("active",o.activeConversationId()===e.conversation.id)("tree-item-loading",o.loadingItemId()===e.conversation.id),a(2),_(o.loadingItemId()===e.conversation.id?2:o.newConversationIds().has(e.conversation.id)?3:-1),a(3),y(e.conversation.title||"Untitled"),a(2),y(o.formatDate(e.conversation.updatedAt))}}function Lr(n,t){if(n&1&&(f(0,Nr,8,10,"button",8),f(1,Dr,8,9,"button",9)),n&2){let e=t.$implicit;_(e.type==="node"&&e.node?0:-1),a(),_(e.type==="conversation"&&e.conversation?1:-1)}}function Vr(n,t){if(n&1){let e=P();u(0,"button",28),S("click",function(){let i=C(e).$implicit,r=l(4);return x(r.onConversationSelect(i.id))}),u(1,"div",29),c(2),m(),u(3,"div",24),c(4),m()()}if(n&2){let e=t.$implicit,o=l(4);A("active",o.activeConversationId()===e.id),a(2),y(e.title||"Untitled Conversation"),a(2),y(o.formatDate(e.updatedAt))}}function Fr(n,t){if(n&1&&j(0,Vr,5,4,"button",27,Er),n&2){let e=l(3);G(e.treeData$().uncategorized)}}function zr(n,t){if(n&1){let e=P();u(0,"div",6)(1,"button",25),S("click",function(){C(e);let i=l(2);return x(i.toggleGeneral())}),w(),u(2,"svg",26),I(3,"path",12),m(),c(4," General "),F(),u(5,"span",15),c(6),m()(),f(7,Fr,2,0),m()}if(n&2){let e=l(2);a(2),A("expanded",e.generalExpanded()),a(4),y(e.treeData$().uncategorized.length),a(),_(e.generalExpanded()?7:-1)}}function Br(n,t){n&1&&(u(0,"div",7)(1,"div",30),w(),u(2,"svg",31),I(3,"path",32),m()(),F(),u(4,"p",33),c(5,"No conversations yet"),m(),u(6,"p",34),c(7,"Start a new conversation above"),m()())}function Wr(n,t){if(n&1&&(j(0,Lr,2,2,null,null,Sr,!0),f(2,zr,8,4,"div",6),f(3,Br,8,0,"div",7)),n&2){let e=l();G(e.flatRows()),a(2),_(e.treeData$().uncategorized.length>0?2:-1),a(),_(e.treeData$().tree.length===0&&e.treeData$().uncategorized.length===0?3:-1)}}var Ze=class n{conversationService=W(Me);activeConversationId=N(null);locked=N(!1);newConversationIds=N(new Set);loadingItemId=N(null);conversationSelected=z();newChatRequested=z();conceptSelected=z();treeData$=v(null);isLoading$=v(!1);expandedNodes=v(new Set);generalExpanded=v(!0);flatRows=v([]);ngOnInit(){this.loadTree()}async loadTree(){this.isLoading$.set(!0);try{let t=await this.conversationService.getGroupedConversations();this.treeData$.set(t);let e=new Set;this.collectAllIds(t.tree,e),this.expandedNodes.set(e),this.rebuildFlatRows()}catch{}finally{this.isLoading$.set(!1)}}toggleNode(t){this.expandedNodes.update(e=>{let o=new Set(e);return o.has(t)?o.delete(t):o.add(t),o}),this.rebuildFlatRows()}toggleGeneral(){this.generalExpanded.update(t=>!t)}onConversationSelect(t){this.conversationSelected.emit(t)}onNewChat(t,e,o){t.stopPropagation(),this.newChatRequested.emit({conceptId:e,conceptName:o})}onNodeClick(t,e){if(t.stopPropagation(),e.conceptId)this.conceptSelected.emit({conceptId:e.conceptId,curriculumId:e.curriculumId,conceptName:e.label,isFolder:!1,descendantConceptIds:[e.conceptId],descendantConversationIds:e.conversations.map(o=>o.id)}),this.expandedNodes().has(e.curriculumId)||this.toggleNode(e.curriculumId);else{let o=this.collectDescendantConceptIds(e),i=this.collectDescendantConversationIds(e);this.conceptSelected.emit({conceptId:null,curriculumId:e.curriculumId,conceptName:e.label,isFolder:!0,descendantConceptIds:o,descendantConversationIds:i}),this.expandedNodes().has(e.curriculumId)||this.toggleNode(e.curriculumId)}}collectDescendantConceptIds(t){let e=[];t.conceptId&&e.push(t.conceptId);for(let o of t.children)e.push(...this.collectDescendantConceptIds(o));return e}collectDescendantConversationIds(t){let e=[];for(let o of t.conversations)e.push(o.id);for(let o of t.children)e.push(...this.collectDescendantConversationIds(o));return e}hasNewConversations(t){let e=this.newConversationIds();if(e.size===0)return!1;let o=this.treeData$();return o?this.checkNodeForNew(o.tree,t,e):!1}checkNodeForNew(t,e,o){for(let i of t){if(i.curriculumId===e)return i.conversations.some(s=>o.has(s.id))||this.anyDescendantHasNew(i.children,o);if(this.checkNodeForNew(i.children,e,o))return!0}return!1}anyDescendantHasNew(t,e){for(let o of t)if(o.conversations.some(i=>e.has(i.id))||this.anyDescendantHasNew(o.children,e))return!0;return!1}trackRow(t){return t.type==="node"&&t.node?`node-${t.node.curriculumId}`:t.type==="conversation"&&t.conversation?`conv-${t.conversation.id}`:`${t.type}-${t.depth}`}formatDate(t){let e=new Date(t),i=new Date().getTime()-e.getTime(),r=Math.floor(i/6e4),s=Math.floor(i/36e5),g=Math.floor(i/864e5);return r<1?"Just now":r<60?`${r}m ago`:s<24?`${s}h ago`:g<7?`${g}d ago`:e.toLocaleDateString()}collectAllIds(t,e){for(let o of t)e.add(o.curriculumId),this.collectAllIds(o.children,e)}rebuildFlatRows(){let t=this.treeData$();if(!t){this.flatRows.set([]);return}let e=[],o=this.expandedNodes();this.flattenTree(t.tree,0,e,o),this.flatRows.set(e)}flattenTree(t,e,o,i){for(let r of t)if(o.push({type:"node",depth:e,node:r,curriculumId:r.curriculumId}),i.has(r.curriculumId)){this.flattenTree(r.children,e+1,o,i);for(let s of r.conversations)o.push({type:"conversation",depth:e+1,conversation:s,curriculumId:r.curriculumId})}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-concept-tree"]],inputs:{activeConversationId:[1,"activeConversationId"],locked:[1,"locked"],newConversationIds:[1,"newConversationIds"],loadingItemId:[1,"loadingItemId"]},outputs:{conversationSelected:"conversationSelected",newChatRequested:"newChatRequested",conceptSelected:"conceptSelected"},decls:3,vars:3,consts:[[1,"tree-container"],[2,"padding","0 12px"],[2,"padding","6px 0"],[1,"skeleton",2,"width","50%"],[1,"skeleton",2,"width","70%","margin-left","16px"],[1,"skeleton",2,"width","80%","margin-left","32px"],[1,"general-section"],[1,"empty-state"],[1,"tree-node",3,"root-node","padding-left"],[1,"conversation-item",3,"active","tree-item-loading","padding-left"],[1,"tree-node",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"chevron",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"node-label","clickable",3,"click"],[1,"new-badge"],[1,"node-count"],["title","New conversation",1,"add-btn"],["title","New conversation",1,"add-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","14px","height","14px"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"conversation-item",3,"click"],[2,"display","flex","align-items","center","gap","6px"],[1,"tree-item-spinner"],[1,"conv-title",2,"flex","1"],[1,"conv-meta"],[1,"general-header",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"chevron",2,"width","12px","height","12px"],[1,"general-item",3,"active"],[1,"general-item",3,"click"],[1,"conv-title"],[1,"empty-icon"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","24px","height","24px","color","#6B6B6B"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"],[2,"font-size","13px","color","#6B6B6B"],[2,"font-size","11px","color","#6B6B6B","margin-top","4px"]],template:function(e,o){e&1&&(u(0,"div",0),f(1,Tr,3,1,"div",1)(2,Wr,4,2),m()),e&2&&(A("locked",o.locked()),a(),_(o.isLoading$()?1:o.treeData$()?2:-1))},dependencies:[Y],styles:["[_nghost-%COMP%]{display:block;flex:1;overflow-y:auto}.tree-container[_ngcontent-%COMP%]{padding:4px 0;transition:opacity .2s}.tree-container.locked[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.tree-node[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:5px 8px;cursor:pointer;font-size:12px;font-weight:500;color:#a1a1a1;border-radius:4px;margin:0 4px;background:none;border:none;width:calc(100% - 8px);text-align:left}.tree-node[_ngcontent-%COMP%]:hover{background:#1a1a1a;color:#fafafa}.tree-node.root-node[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#6b6b6b;text-transform:uppercase;letter-spacing:.5px}.chevron[_ngcontent-%COMP%]{width:10px;height:10px;transition:transform .15s;flex-shrink:0}.chevron.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.node-label[_ngcontent-%COMP%]{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.node-count[_ngcontent-%COMP%]{margin-left:auto;font-size:10px;color:#4a4a4a;flex-shrink:0}.add-btn[_ngcontent-%COMP%]{width:16px;height:16px;color:#4a4a4a;opacity:0;transition:opacity .15s;cursor:pointer;flex-shrink:0;background:none;border:none;padding:0}.tree-node[_ngcontent-%COMP%]:hover   .add-btn[_ngcontent-%COMP%]{opacity:1}.add-btn[_ngcontent-%COMP%]:hover{color:#3b82f6}.conversation-item[_ngcontent-%COMP%]{display:block;width:calc(100% - 8px);padding:6px 12px;margin:0 4px 2px;border-radius:4px;cursor:pointer;background:none;border:none;text-align:left;color:inherit}.conversation-item[_ngcontent-%COMP%]:hover{background:#1a1a1a}.conversation-item.active[_ngcontent-%COMP%]{background:#1a1a1a;border-left:2px solid #3B82F6}.conv-title[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.conversation-item.active[_ngcontent-%COMP%]   .conv-title[_ngcontent-%COMP%]{color:#fafafa}.conv-meta[_ngcontent-%COMP%]{font-size:10px;color:#4a4a4a;margin-top:2px}.general-section[_ngcontent-%COMP%]{margin-top:4px;border-top:1px solid #2A2A2A;padding-top:4px}.general-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;cursor:pointer;font-size:11px;font-weight:600;color:#6b6b6b;text-transform:uppercase;letter-spacing:.5px;background:none;border:none;width:100%;text-align:left}.general-header[_ngcontent-%COMP%]:hover{color:#a1a1a1}.general-item[_ngcontent-%COMP%]{display:block;width:calc(100% - 8px);padding:6px 12px 6px 24px;margin:0 4px 2px;border-radius:4px;cursor:pointer;background:none;border:none;text-align:left;color:inherit}.general-item[_ngcontent-%COMP%]:hover{background:#1a1a1a}.general-item.active[_ngcontent-%COMP%]{background:#1a1a1a;border-left:2px solid #3B82F6}.general-item.active[_ngcontent-%COMP%]   .conv-title[_ngcontent-%COMP%]{color:#fafafa}.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#1a1a1a 25%,#242424,#1a1a1a 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite;height:14px;border-radius:4px;margin-bottom:6px}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.new-badge[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#3b82f6;flex-shrink:0}.node-label.clickable[_ngcontent-%COMP%]{cursor:pointer}.node-label.clickable[_ngcontent-%COMP%]:hover{color:#3b82f6}.tree-item-loading[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.tree-item-spinner[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border:2px solid #2A2A2A;border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_shimmer-spin .8s linear infinite;flex-shrink:0}@keyframes _ngcontent-%COMP%_shimmer-spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{padding:32px 12px;text-align:center}.empty-icon[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 auto 12px;background:#1a1a1a;border-radius:50%;display:flex;align-items:center;justify-content:center}"],changeDetection:0})};var wo=(n,t)=>t.id;function Hr(n,t){n&1&&(u(0,"div",0),I(1,"span",11),c(2," Generating workflow plan... "),m())}function qr(n,t){n&1&&(u(0,"div",0),I(1,"span",11),c(2," Agents running... "),m())}function Ur(n,t){if(n&1&&(u(0,"div",1),w(),u(1,"svg",12),I(2,"path",13),m(),F(),u(3,"span",14),c(4),m(),u(5,"span",15),c(6),m()()),n&2){let e=l();a(4),y(e.folderName()),a(2),se("",e.notes().length," task",e.notes().length!==1?"s":"")}}function jr(n,t){if(n&1){let e=P();u(0,"div",4)(1,"span"),c(2),m(),u(3,"div",16)(4,"button",17),S("click",function(){C(e);let i=l();return x(i.deselectAll())}),c(5,"Deselect"),m(),u(6,"button",18),S("click",function(){C(e);let i=l();return x(i.onRunAgents())}),c(7,"Run Agents"),m()()()}if(n&2){let e=l();a(2),se("",e.selectedTaskIds().size," task",e.selectedTaskIds().size>1?"s":""," selected"),a(4),Q("disabled",e.isExecuting()||e.isGeneratingPlan())}}function Gr(n,t){if(n&1){let e=P();u(0,"div",4)(1,"span"),c(2),m(),u(3,"button",17),S("click",function(){C(e);let i=l();return x(i.selectAllPending())}),c(4,"Select all"),m()()}if(n&2){let e=l();a(2),se("",e.pendingTaskCount()," pending task",e.pendingTaskCount()>1?"s":"")}}function Yr(n,t){n&1&&(u(0,"div",6),c(1,"Loading notes..."),m())}function Kr(n,t){n&1&&(u(0,"div",7)(1,"p"),c(2,"No notes yet"),m(),u(3,"p",19),c(4,"Notes and tasks will appear here as you chat"),m()())}function Qr(n,t){if(n&1){let e=P();u(0,"button",33),S("click",function(i){C(e);let r=l().$implicit;return l(2).toggleSelection(r.id),x(i.stopPropagation())}),m()}if(n&2){let e=l().$implicit,o=l(2);A("selected",o.selectedTaskIds().has(e.id))}}function Zr(n,t){if(n&1){let e=P();u(0,"input",34),S("change",function(i){C(e);let r=l().$implicit;return l(2).toggleTaskStatus(r),x(i.stopPropagation())})("click",function(i){return C(e),x(i.stopPropagation())}),m()}if(n&2){let e=l().$implicit,o=l(2);Q("checked",e.status==="COMPLETED")("disabled",o.togglingStatus().has(e.id))}}function Xr(n,t){if(n&1&&(u(0,"span",35),c(1),m()),n&2){let e=l().$implicit;A("score-high",e.aiScore>=80)("score-medium",e.aiScore>=50&&e.aiScore<80)("score-low",e.aiScore<50),a(),T("",e.aiScore,"/100")}}function Jr(n,t){n&1&&I(0,"span",30)}function ea(n,t){n&1&&(w(),u(0,"svg",31),I(1,"path",36),m())}function ta(n,t){if(n&1&&(u(0,"div",37),c(1),m()),n&2){let e=l(2).$implicit;a(),y(e.content)}}function na(n,t){if(n&1&&(u(0,"div",38)(1,"div",44),c(2,"Expected outcome"),m(),c(3),m()),n&2){let e=l(2).$implicit;a(3),T(" ",e.expectedOutcome," ")}}function oa(n,t){n&1&&(I(0,"span",46),c(1," Generating... "))}function ia(n,t){n&1&&(w(),u(0,"svg",47),I(1,"path",48)(2,"path",49),m(),c(3," Execute "))}function ra(n,t){if(n&1){let e=P();u(0,"button",45),S("click",function(){C(e);let i=l(2).$implicit,r=l(2);return x(r.onExecuteTask(i.id))}),f(1,oa,2,0)(2,ia,4,0),m()}if(n&2){let e=l(2).$implicit,o=l(2);Q("disabled",o.executingTaskId()===e.id||o.isExecuting()),a(),_(o.executingTaskId()===e.id?1:2)}}function aa(n,t){if(n&1){let e=P();u(0,"button",50),S("click",function(){C(e);let i=l(2).$implicit,r=l(2);return x(r.emitViewMessage(i))}),c(1,"View in chat"),m()}}function sa(n,t){if(n&1&&(u(0,"span",53),c(1),m()),n&2){let e=l().$implicit;a(),y(e.workflowStepNumber)}}function la(n,t){n&1&&(w(),u(0,"svg",54),I(1,"path",57),m())}function ca(n,t){if(n&1){let e=P();u(0,"div",59)(1,"div",60),c(2,"Your completion report"),m(),u(3,"textarea",61),S("input",function(i){C(e);let r=l(2).$implicit,s=l(5);return x(s.setReportText(r.id,s.asTextareaValue(i)))}),m(),u(4,"div",62)(5,"button",63),S("click",function(){C(e);let i=l(2).$implicit,r=l(5);return x(r.submitReport(i.id))}),c(6),m()()()}if(n&2){let e=l(2).$implicit,o=l(5);a(3),Q("value",o.getReportText(e.id)),a(2),Q("disabled",!o.getReportText(e.id)||o.submittingInProgress().has(e.id)),a(),T(" ",o.submittingInProgress().has(e.id)?"Submitting...":"Submit Report"," ")}}function da(n,t){if(n&1&&(u(0,"div",70),c(1),m()),n&2){let e=l(4).$implicit;a(),y(e.aiFeedback)}}function pa(n,t){if(n&1&&(u(0,"div",65)(1,"div",66)(2,"div",67),I(3,"div",68),m(),u(4,"span",69),c(5),m()(),f(6,da,2,1,"div",70),m()),n&2){let e=l(3).$implicit;a(3),H("width",e.aiScore,"%"),A("high",e.aiScore>=80)("medium",e.aiScore>=50&&e.aiScore<80)("low",e.aiScore<50),a(),A("high",e.aiScore>=80)("medium",e.aiScore>=50&&e.aiScore<80)("low",e.aiScore<50),a(),y(e.aiScore),a(),_(e.aiFeedback?6:-1)}}function ua(n,t){n&1&&(I(0,"span",72),c(1," Scoring... "))}function ma(n,t){n&1&&c(0," Get AI Score ")}function ha(n,t){if(n&1){let e=P();u(0,"div",62)(1,"button",71),S("click",function(){C(e);let i=l(3).$implicit,r=l(5);return x(r.scoreReport(i.id))}),f(2,ua,2,0)(3,ma,1,0),m()()}if(n&2){let e=l(3).$implicit,o=l(5);a(),Q("disabled",o.scoringInProgress().has(e.id)),a(),_(o.scoringInProgress().has(e.id)?2:3)}}function ga(n,t){if(n&1&&(u(0,"div",59)(1,"div",60),c(2,"Your report"),m(),u(3,"div",64),c(4),m(),f(5,pa,7,16,"div",65)(6,ha,4,2,"div",62),m()),n&2){let e=l(2).$implicit;a(4),y(e.userReport),a(),_(e.aiScore!==null&&e.aiScore!==void 0?5:6)}}function fa(n,t){if(n&1&&(u(0,"div",58),c(1),m(),f(2,ca,7,3,"div",59),f(3,ga,7,2,"div",59)),n&2){let e=l().$implicit;a(),y(e.content),a(),_(e.status==="COMPLETED"&&!e.userReport?2:-1),a(),_(e.userReport?3:-1)}}function _a(n,t){if(n&1){let e=P();u(0,"div")(1,"div",52),S("click",function(){let i=C(e).$implicit,r=l(5);return x(r.toggleSubtaskExpand(i.id))}),f(2,sa,2,1,"span",53),f(3,la,2,0,":svg:svg",54),u(4,"span",55),c(5),m(),w(),u(6,"svg",56),I(7,"path",28),m()(),f(8,fa,4,3),m()}if(n&2){let e=t.$implicit,o=l(5);a(2),_(e.workflowStepNumber!==null?2:-1),a(),_(e.status==="COMPLETED"?3:-1),a(2),y(e.title),a(),A("expanded",o.expandedSubtasks().has(e.id)),a(2),_(o.expandedSubtasks().has(e.id)?8:-1)}}function Ca(n,t){if(n&1&&(u(0,"div",42)(1,"div",51),c(2),m(),j(3,_a,9,6,"div",null,wo),m()),n&2){let e=l(2).$implicit;a(2),T("Workflow Output (",e.children.length," steps)"),a(),G(e.children)}}function xa(n,t){if(n&1){let e=P();u(0,"div",43)(1,"div",60),c(2,"Your completion report"),m(),u(3,"textarea",61),S("input",function(i){C(e);let r=l(2).$implicit,s=l(2);return x(s.setReportText(r.id,s.asTextareaValue(i)))}),m(),u(4,"div",62)(5,"button",63),S("click",function(){C(e);let i=l(2).$implicit,r=l(2);return x(r.submitReport(i.id))}),c(6),m()()()}if(n&2){let e=l(2).$implicit,o=l(2);a(3),Q("value",o.getReportText(e.id)),a(2),Q("disabled",!o.getReportText(e.id)||o.submittingInProgress().has(e.id)),a(),T(" ",o.submittingInProgress().has(e.id)?"Submitting...":"Submit Report"," ")}}function ba(n,t){if(n&1&&(u(0,"div",70),c(1),m()),n&2){let e=l(4).$implicit;a(),y(e.aiFeedback)}}function va(n,t){if(n&1&&(u(0,"div",73)(1,"div",66)(2,"div",67),I(3,"div",68),m(),u(4,"span",69),c(5),m()(),f(6,ba,2,1,"div",70),m()),n&2){let e=l(3).$implicit;a(3),H("width",e.aiScore,"%"),A("high",e.aiScore>=80)("medium",e.aiScore>=50&&e.aiScore<80)("low",e.aiScore<50),a(),A("high",e.aiScore>=80)("medium",e.aiScore>=50&&e.aiScore<80)("low",e.aiScore<50),a(),y(e.aiScore),a(),_(e.aiFeedback?6:-1)}}function ka(n,t){n&1&&(I(0,"span",72),c(1," Scoring... "))}function ya(n,t){n&1&&c(0," Get AI Score ")}function wa(n,t){if(n&1){let e=P();u(0,"div",62)(1,"button",71),S("click",function(){C(e);let i=l(3).$implicit,r=l(2);return x(r.scoreReport(i.id))}),f(2,ka,2,0)(3,ya,1,0),m()()}if(n&2){let e=l(3).$implicit,o=l(2);a(),Q("disabled",o.scoringInProgress().has(e.id)),a(),_(o.scoringInProgress().has(e.id)?2:3)}}function Pa(n,t){if(n&1&&(u(0,"div",43)(1,"div",60),c(2,"Your report"),m(),u(3,"div",64),c(4),m(),f(5,va,7,16,"div",73)(6,wa,4,2,"div",62),m()),n&2){let e=l(2).$implicit;a(4),y(e.userReport),a(),_(e.aiScore!==null&&e.aiScore!==void 0?5:6)}}function Sa(n,t){if(n&1&&(u(0,"div",32),f(1,ta,2,1,"div",37),f(2,na,4,1,"div",38),f(3,ra,3,2,"button",39),u(4,"div",40)(5,"span"),c(6),m(),u(7,"span"),c(8),m(),f(9,aa,2,0,"button",41),m(),f(10,Ca,5,1,"div",42),f(11,xa,7,3,"div",43),f(12,Pa,7,2,"div",43),m()),n&2){let e=l().$implicit,o=l(2);a(),_(e.content?1:-1),a(),_(e.expectedOutcome?2:-1),a(),_(e.noteType==="TASK"&&e.status!=="COMPLETED"?3:-1),a(3),y(e.source),a(2),y(o.formatDate(e.createdAt)),a(),_(e.messageId?9:-1),a(),_(e.children&&e.children.length>0?10:-1),a(),_(e.noteType==="TASK"&&e.status==="COMPLETED"&&!e.userReport?11:-1),a(),_(e.userReport?12:-1)}}function Ea(n,t){if(n&1){let e=P();u(0,"div",20)(1,"div",21),S("click",function(){let i=C(e).$implicit,r=l(2);return x(r.toggleExpand(i.id))}),f(2,Qr,1,2,"button",22),f(3,Zr,1,2,"input",23),u(4,"span",24),c(5),m(),u(6,"span",25),c(7),m(),f(8,Xr,2,7,"span",26),w(),u(9,"svg",27),I(10,"path",28),m(),F(),u(11,"button",29),S("click",function(i){let r=C(e).$implicit;return l(2).deleteNote(r.id),x(i.stopPropagation())}),f(12,Jr,1,0,"span",30)(13,ea,2,0,":svg:svg",31),m()(),f(14,Sa,13,9,"div",32),m()}if(n&2){let e=t.$implicit,o=l(2);a(2),_(e.noteType==="TASK"&&e.status!=="COMPLETED"?2:-1),a(),_(e.noteType==="TASK"?3:-1),a(),A("badge-task",e.noteType==="TASK")("badge-note",e.noteType==="NOTE")("badge-summary",e.noteType==="SUMMARY")("badge-review",e.status==="READY_FOR_REVIEW"),a(),y(e.status==="READY_FOR_REVIEW"?"REVIEW":e.noteType),a(),A("completed",e.status==="COMPLETED"),a(),T(" ",e.title," "),a(),_(e.aiScore!==null&&e.aiScore!==void 0?8:-1),a(),A("expanded",o.expandedNotes().has(e.id)),a(2),Q("disabled",o.deletingInProgress().has(e.id)),a(),_(o.deletingInProgress().has(e.id)?12:13),a(2),_(o.expandedNotes().has(e.id)?14:-1)}}function Ma(n,t){if(n&1&&j(0,Ea,15,20,"div",20,wo),n&2){let e=l();G(e.filteredNotes())}}function Ta(n,t){if(n&1){let e=P();u(0,"div",9)(1,"input",74),S("input",function(i){C(e);let r=l();return x(r.newTitle.set(r.asInputValue(i)))}),m(),u(2,"textarea",75),S("input",function(i){C(e);let r=l();return x(r.newContent.set(r.asTextareaValue(i)))}),m(),u(3,"div",76)(4,"button",77),S("click",function(){C(e);let i=l();return x(i.showAddForm.set(!1))}),c(5,"Cancel"),m(),u(6,"button",63),S("click",function(){C(e);let i=l();return x(i.addNote())}),c(7),m()()()}if(n&2){let e=l();a(),Q("value",e.newTitle()),a(),Q("value",e.newContent()),a(4),Q("disabled",!e.newTitle()||e.addingNote$()),a(),y(e.addingNote$()?"Adding...":"Add Note")}}function Oa(n,t){if(n&1){let e=P();u(0,"button",78),S("click",function(){C(e);let i=l();return x(i.showAddForm.set(!0))}),c(1," + Add Note "),m()}}var Xe=class n{notesApi=W(Ae);conversationId=N(null);conceptId=N(null);isExecuting=N(!1);folderConceptIds=N([]);folderConversationIds=N([]);folderName=N(null);autoSelectTaskIds=N([]);executingTaskId=N(null);isGeneratingPlan=N(!1);viewMessage=z();runAgents=z();executeTask=z();notes=v([]);loading=v(!1);activeFilter=v("all");showAddForm=v(!1);newTitle=v("");newContent=v("");selectedTaskIds=v(new Set);pendingTaskCount=v(0);filteredNotes=v([]);expandedNotes=v(new Set);expandedSubtasks=v(new Set);reportTexts=v(new Map);scoringInProgress=v(new Set);deletingInProgress=v(new Set);submittingInProgress=v(new Set);addingNote$=v(!1);togglingStatus=v(new Set);constructor(){Je(()=>{this.conversationId(),this.conceptId(),this.folderConceptIds(),this.folderConversationIds(),this.autoSelectTaskIds(),mn(()=>this.loadNotes())})}async loadNotes(){let t=this.folderConceptIds(),e=this.folderConversationIds();if(t.length>0||e.length>0){this.loading.set(!0);try{let[i,r]=await Promise.all([t.length>0?this.notesApi.getByConceptIds(t):Promise.resolve([]),e.length>0?this.notesApi.getByConversationIds(e):Promise.resolve([])]),s=new Set,g=[];for(let d of[...i,...r])s.has(d.id)||(s.add(d.id),g.push(d));this.notes.set(g),this.updateFilteredNotes()}catch{this.notes.set([]),this.updateFilteredNotes()}finally{this.loading.set(!1)}return}let o=this.conversationId();if(!o){this.notes.set([]),this.updateFilteredNotes();return}this.loading.set(!0);try{let i=await this.notesApi.getByConversation(o);this.notes.set(i),this.updateFilteredNotes(),this.applyAutoSelect()}catch{this.notes.set([]),this.updateFilteredNotes()}finally{this.loading.set(!1)}}applyAutoSelect(){let t=this.autoSelectTaskIds();t.length>0&&this.selectedTaskIds.set(new Set(t))}toggleExpand(t){this.expandedNotes.update(e=>{let o=new Set(e);return o.has(t)?o.delete(t):o.add(t),o})}toggleSubtaskExpand(t){this.expandedSubtasks.update(e=>{let o=new Set(e);return o.has(t)?o.delete(t):o.add(t),o})}getReportText(t){return this.reportTexts().get(t)??""}setReportText(t,e){this.reportTexts.update(o=>{let i=new Map(o);return i.set(t,e),i})}async submitReport(t){let e=this.getReportText(t);if(!(!e||this.submittingInProgress().has(t))){this.submittingInProgress.update(o=>{let i=new Set(o);return i.add(t),i});try{let o=await this.notesApi.submitReport(t,e);this.updateNoteInList(o),this.reportTexts.update(i=>{let r=new Map(i);return r.delete(t),r})}catch{}finally{this.submittingInProgress.update(o=>{let i=new Set(o);return i.delete(t),i})}}}async scoreReport(t){this.scoringInProgress.update(e=>{let o=new Set(e);return o.add(t),o});try{let e=await this.notesApi.scoreReport(t);this.updateNoteInList(e)}catch{}finally{this.scoringInProgress.update(e=>{let o=new Set(e);return o.delete(t),o})}}async toggleTaskStatus(t){if(this.togglingStatus().has(t.id))return;let e=t.status==="COMPLETED"?"PENDING":"COMPLETED";this.togglingStatus.update(o=>{let i=new Set(o);return i.add(t.id),i});try{await this.notesApi.updateStatus(t.id,e),this.notes.update(o=>o.map(i=>i.id===t.id?Z(L({},i),{status:e}):i)),this.updateFilteredNotes()}catch{}finally{this.togglingStatus.update(o=>{let i=new Set(o);return i.delete(t.id),i})}}async deleteNote(t){if(!this.deletingInProgress().has(t)){this.deletingInProgress.update(e=>{let o=new Set(e);return o.add(t),o});try{await this.notesApi.deleteNote(t),this.notes.update(e=>e.filter(o=>o.id!==t)),this.updateFilteredNotes()}catch{}finally{this.deletingInProgress.update(e=>{let o=new Set(e);return o.delete(t),o})}}}async addNote(){let t=this.newTitle(),e=this.newContent();if(!(!t||this.addingNote$())){this.addingNote$.set(!0);try{let o=await this.notesApi.createNote({title:t,content:e,noteType:"NOTE",conversationId:this.conversationId()??void 0,conceptId:this.conceptId()??void 0});this.notes.update(i=>[o,...i]),this.updateFilteredNotes(),this.newTitle.set(""),this.newContent.set(""),this.showAddForm.set(!1)}catch{}finally{this.addingNote$.set(!1)}}}formatDate(t){let e=new Date(t),i=new Date().getTime()-e.getTime(),r=Math.floor(i/6e4),s=Math.floor(i/36e5),g=Math.floor(i/864e5);return r<1?"Just now":r<60?`${r}m ago`:s<24?`${s}h ago`:g<7?`${g}d ago`:e.toLocaleDateString()}asInputValue(t){return t.target.value}asTextareaValue(t){return t.target.value}toggleSelection(t){this.selectedTaskIds.update(e=>{let o=new Set(e);return o.has(t)?o.delete(t):o.add(t),o})}selectAllPending(){let t=this.notes().filter(e=>e.noteType==="TASK"&&e.status!=="COMPLETED").map(e=>e.id);this.selectedTaskIds.set(new Set(t))}deselectAll(){this.selectedTaskIds.set(new Set)}onRunAgents(){let t=Array.from(this.selectedTaskIds());t.length>0&&(this.runAgents.emit(t),this.selectedTaskIds.set(new Set))}onExecuteTask(t){this.executeTask.emit(t)}emitViewMessage(t){t.messageId&&t.conversationId&&this.viewMessage.emit({conversationId:t.conversationId,messageId:t.messageId})}updateFilteredNotes(){let t=this.activeFilter(),e=this.notes();t==="all"?this.filteredNotes.set(e):t==="READY_FOR_REVIEW"?this.filteredNotes.set(e.filter(o=>o.status==="READY_FOR_REVIEW")):this.filteredNotes.set(e.filter(o=>o.noteType===t)),this.pendingTaskCount.set(e.filter(o=>o.noteType==="TASK"&&o.status!=="COMPLETED").length)}updateNoteInList(t){this.notes.update(e=>e.map(o=>o.id===t.id?L(L({},o),t):o.children?Z(L({},o),{children:o.children.map(i=>i.id===t.id?L(L({},i),t):i)}):o)),this.updateFilteredNotes()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-conversation-notes"]],inputs:{conversationId:[1,"conversationId"],conceptId:[1,"conceptId"],isExecuting:[1,"isExecuting"],folderConceptIds:[1,"folderConceptIds"],folderConversationIds:[1,"folderConversationIds"],folderName:[1,"folderName"],autoSelectTaskIds:[1,"autoSelectTaskIds"],executingTaskId:[1,"executingTaskId"],isGeneratingPlan:[1,"isGeneratingPlan"]},outputs:{viewMessage:"viewMessage",runAgents:"runAgents",executeTask:"executeTask"},decls:21,vars:13,consts:[[1,"executing-bar"],[1,"folder-header"],[1,"filter-bar"],[1,"filter-btn",3,"click"],[1,"run-agents-bar"],[1,"notes-container"],[1,"loading-spinner"],[1,"empty-notes"],[1,"add-note-section"],[1,"add-note-form"],[1,"btn-secondary",2,"width","100%"],[1,"executing-spinner"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","18px","height","18px","color","#3B82F6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"],[1,"folder-title"],[1,"folder-count"],[1,"run-agents-actions"],[1,"select-link",3,"click"],[1,"run-agents-btn",3,"click","disabled"],[2,"font-size","11px","margin-top","4px"],[1,"task-card"],[1,"task-card-header",3,"click"],["title","Select for agents",1,"select-btn",3,"selected"],["type","checkbox",1,"task-checkbox",3,"checked","disabled"],[1,"note-type-badge"],[1,"task-title"],[1,"score-badge",3,"score-high","score-medium","score-low"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"expand-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["title","Delete",1,"delete-btn",3,"click","disabled"],[1,"scoring-spinner",2,"width","12px","height","12px","border-top-color","#EF4444"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","14px","height","14px"],[1,"task-card-body"],["title","Select for agents",1,"select-btn",3,"click"],["type","checkbox",1,"task-checkbox",3,"change","click","checked","disabled"],[1,"score-badge"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"task-description"],[1,"expected-outcome"],[1,"execute-btn",3,"disabled"],[1,"task-meta"],[1,"view-in-chat-btn"],[1,"subtasks-section"],[1,"report-section"],[1,"expected-outcome-label"],[1,"execute-btn",3,"click","disabled"],[1,"execute-spinner"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","12px","height","12px"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"view-in-chat-btn",3,"click"],[1,"subtasks-label"],[1,"subtask-item",3,"click"],[1,"subtask-step-num"],["fill","currentColor","viewBox","0 0 20 20",1,"subtask-check"],[1,"subtask-title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"subtask-expand-icon"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"subtask-content"],[1,"report-section",2,"padding-left","32px"],[1,"report-label"],["placeholder","Describe what you did, what you learned, results achieved...",1,"report-textarea",3,"input","value"],[1,"report-actions"],[1,"btn-primary",3,"click","disabled"],[1,"existing-report"],[1,"score-section",2,"border","none","padding-top","8px"],[1,"score-bar-container"],[1,"score-bar-bg"],[1,"score-bar-fill"],[1,"score-number"],[1,"score-feedback"],[1,"btn-score",3,"click","disabled"],[1,"scoring-spinner"],[1,"score-section"],["placeholder","Title",1,"note-input",3,"input","value"],["placeholder","Content...",1,"note-textarea",3,"input","value"],[1,"form-actions"],[1,"btn-secondary",3,"click"],[1,"btn-secondary",2,"width","100%",3,"click"]],template:function(e,o){e&1&&(f(0,Hr,3,0,"div",0)(1,qr,3,0,"div",0),f(2,Ur,7,3,"div",1),u(3,"div",2)(4,"button",3),S("click",function(){return o.activeFilter.set("all"),o.updateFilteredNotes()}),c(5,"All"),m(),u(6,"button",3),S("click",function(){return o.activeFilter.set("TASK"),o.updateFilteredNotes()}),c(7,"Tasks"),m(),u(8,"button",3),S("click",function(){return o.activeFilter.set("READY_FOR_REVIEW"),o.updateFilteredNotes()}),c(9,"Review"),m(),u(10,"button",3),S("click",function(){return o.activeFilter.set("NOTE"),o.updateFilteredNotes()}),c(11,"Notes"),m()(),f(12,jr,8,3,"div",4)(13,Gr,5,2,"div",4),u(14,"div",5),f(15,Yr,2,0,"div",6)(16,Kr,5,0,"div",7)(17,Ma,2,0),m(),u(18,"div",8),f(19,Ta,8,4,"div",9)(20,Oa,2,0,"button",10),m()),e&2&&(_(o.isGeneratingPlan()?0:o.isExecuting()?1:-1),a(2),_(o.folderName()?2:-1),a(2),A("active",o.activeFilter()==="all"),a(2),A("active",o.activeFilter()==="TASK"),a(2),A("active",o.activeFilter()==="READY_FOR_REVIEW"),a(2),A("active",o.activeFilter()==="NOTE"),a(2),_(o.selectedTaskIds().size>0?12:o.pendingTaskCount()>0?13:-1),a(3),_(o.loading()?15:o.filteredNotes().length===0?16:17),a(4),_(o.showAddForm()?19:20))},dependencies:[Y,rt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1;overflow:hidden}.notes-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px}.filter-bar[_ngcontent-%COMP%]{display:flex;gap:4px;padding:0 16px 12px;border-bottom:1px solid #2A2A2A}.filter-btn[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;background:none;border:1px solid #2A2A2A;color:#6b6b6b;cursor:pointer}.filter-btn[_ngcontent-%COMP%]:hover{color:#a1a1a1;border-color:#3b82f6}.filter-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fafafa;border-color:#3b82f6}.task-card[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:8px;margin-bottom:8px;border:1px solid #2A2A2A;overflow:hidden}.task-card[_ngcontent-%COMP%]:hover{border-color:#333}.task-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;cursor:pointer;-webkit-user-select:none;user-select:none}.task-checkbox[_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer;accent-color:#3B82F6;flex-shrink:0}.select-btn[_ngcontent-%COMP%]{width:18px;height:18px;border-radius:50%;border:2px solid #3B82F6;background:transparent;cursor:pointer;flex-shrink:0;padding:0;display:inline-block;box-sizing:border-box}.select-btn.selected[_ngcontent-%COMP%]{background:#3b82f6}.select-btn[_ngcontent-%COMP%]:hover{background:#3b82f64d}.select-btn.selected[_ngcontent-%COMP%]:hover{background:#2563eb}.note-type-badge[_ngcontent-%COMP%]{font-size:10px;padding:2px 6px;border-radius:4px;text-transform:uppercase;font-weight:600;flex-shrink:0}.badge-task[_ngcontent-%COMP%]{background:#1e3a5f;color:#60a5fa}.badge-note[_ngcontent-%COMP%]{background:#1a2e1a;color:#86efac}.badge-summary[_ngcontent-%COMP%]{background:#2e1a2e;color:#c084fc}.badge-review[_ngcontent-%COMP%]{background:#3d2e0a;color:#f59e0b}.task-title[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#fafafa;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.task-title.completed[_ngcontent-%COMP%]{text-decoration:line-through;color:#6b6b6b}.score-badge[_ngcontent-%COMP%]{font-size:11px;font-weight:600;padding:2px 8px;border-radius:10px;flex-shrink:0}.score-high[_ngcontent-%COMP%]{background:#22c55e26;color:#22c55e}.score-medium[_ngcontent-%COMP%]{background:#eab30826;color:#eab308}.score-low[_ngcontent-%COMP%]{background:#ef444426;color:#ef4444}.expand-icon[_ngcontent-%COMP%]{width:16px;height:16px;color:#6b6b6b;flex-shrink:0;transition:transform .2s}.expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.delete-btn[_ngcontent-%COMP%]{background:none;border:none;color:#4a4a4a;cursor:pointer;padding:2px;flex-shrink:0}.delete-btn[_ngcontent-%COMP%]:hover{color:#ef4444}.task-card-body[_ngcontent-%COMP%]{padding:0 12px 12px;border-top:1px solid #242424}.task-description[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;line-height:1.5;padding:10px 0;white-space:pre-wrap;word-break:break-word}.expected-outcome[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;line-height:1.5;padding:8px;background:#0d0d0d;border-radius:6px;margin-bottom:10px}.expected-outcome-label[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#6b6b6b;margin-bottom:4px;text-transform:uppercase}.task-meta[_ngcontent-%COMP%]{font-size:10px;color:#4a4a4a;display:flex;gap:8px;margin-bottom:10px}.subtasks-section[_ngcontent-%COMP%]{margin-top:8px}.subtasks-label[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#6b6b6b;margin-bottom:6px;text-transform:uppercase}.subtask-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:8px;background:#0d0d0d;border-radius:6px;margin-bottom:4px;cursor:pointer}.subtask-item[_ngcontent-%COMP%]:hover{background:#141414}.subtask-step-num[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#3b82f6;background:#3b82f61a;padding:1px 6px;border-radius:4px;flex-shrink:0}.subtask-check[_ngcontent-%COMP%]{width:14px;height:14px;color:#22c55e;flex-shrink:0;margin-top:1px}.subtask-title[_ngcontent-%COMP%]{font-size:12px;color:#d4d4d4;flex:1}.subtask-expand-icon[_ngcontent-%COMP%]{width:12px;height:12px;color:#4a4a4a;flex-shrink:0;transition:transform .2s}.subtask-expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.subtask-content[_ngcontent-%COMP%]{font-size:11px;color:#a1a1a1;line-height:1.5;padding:8px 8px 8px 32px;white-space:pre-wrap;word-break:break-word;max-height:300px;overflow-y:auto}.report-section[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid #242424}.report-label[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#6b6b6b;margin-bottom:6px;text-transform:uppercase}.report-textarea[_ngcontent-%COMP%]{width:100%;background:#0d0d0d;border:1px solid #2A2A2A;border-radius:6px;padding:8px 12px;color:#fafafa;font-size:12px;font-family:inherit;resize:vertical;min-height:60px;box-sizing:border-box}.report-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.report-textarea[_ngcontent-%COMP%]::placeholder{color:#4a4a4a}.report-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px;justify-content:flex-end}.existing-report[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;line-height:1.5;padding:8px;background:#0d0d0d;border-radius:6px;white-space:pre-wrap}.score-section[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid #242424}.score-bar-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:8px}.score-bar-bg[_ngcontent-%COMP%]{flex:1;height:8px;background:#242424;border-radius:4px;overflow:hidden}.score-bar-fill[_ngcontent-%COMP%]{height:100%;border-radius:4px;transition:width .3s}.score-bar-fill.high[_ngcontent-%COMP%]{background:#22c55e}.score-bar-fill.medium[_ngcontent-%COMP%]{background:#eab308}.score-bar-fill.low[_ngcontent-%COMP%]{background:#ef4444}.score-number[_ngcontent-%COMP%]{font-size:18px;font-weight:700;flex-shrink:0}.score-number.high[_ngcontent-%COMP%]{color:#22c55e}.score-number.medium[_ngcontent-%COMP%]{color:#eab308}.score-number.low[_ngcontent-%COMP%]{color:#ef4444}.score-feedback[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;line-height:1.5;padding:8px;background:#0d0d0d;border-radius:6px}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fafafa;border:none;border-radius:6px;padding:6px 16px;font-size:12px;cursor:pointer}.btn-primary[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:none;color:#a1a1a1;border:1px solid #2A2A2A;border-radius:6px;padding:6px 16px;font-size:12px;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{color:#fafafa;border-color:#4a4a4a}.btn-score[_ngcontent-%COMP%]{background:#eab3081a;color:#eab308;border:1px solid rgba(234,179,8,.3);border-radius:6px;padding:6px 16px;font-size:12px;cursor:pointer}.btn-score[_ngcontent-%COMP%]:hover{background:#eab30833}.btn-score[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.view-in-chat-btn[_ngcontent-%COMP%]{background:none;border:none;color:#3b82f6;cursor:pointer;font-size:10px;padding:0}.view-in-chat-btn[_ngcontent-%COMP%]:hover{text-decoration:underline}.empty-notes[_ngcontent-%COMP%]{text-align:center;padding:32px 16px}.empty-notes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;color:#6b6b6b}.add-note-section[_ngcontent-%COMP%]{border-top:1px solid #2A2A2A;padding:12px 16px}.add-note-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.note-input[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #2A2A2A;border-radius:6px;padding:8px 12px;color:#fafafa;font-size:13px;font-family:inherit}.note-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.note-input[_ngcontent-%COMP%]::placeholder{color:#4a4a4a}.note-textarea[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #2A2A2A;border-radius:6px;padding:8px 12px;color:#fafafa;font-size:13px;font-family:inherit;resize:vertical;min-height:60px}.note-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.note-textarea[_ngcontent-%COMP%]::placeholder{color:#4a4a4a}.form-actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}.loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#6b6b6b;font-size:13px}.run-agents-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:#1a1a1a;border-bottom:1px solid #2A2A2A}.run-agents-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1}.run-agents-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.run-agents-btn[_ngcontent-%COMP%]{background:#3b82f6;color:#fafafa;border:none;border-radius:6px;padding:6px 16px;font-size:12px;font-weight:500;cursor:pointer}.run-agents-btn[_ngcontent-%COMP%]:hover{background:#2563eb}.run-agents-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.select-link[_ngcontent-%COMP%]{background:none;border:none;color:#3b82f6;cursor:pointer;font-size:11px;padding:0}.select-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.executing-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background:#1a1a1a;border-bottom:1px solid #2A2A2A;font-size:12px;color:#60a5fa}.executing-spinner[_ngcontent-%COMP%]{width:14px;height:14px;border:2px solid #2A2A2A;border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;flex-shrink:0}.scoring-spinner[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border:2px solid #2A2A2A;border-top-color:#eab308;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-right:6px;vertical-align:middle}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.folder-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:14px 16px;border-bottom:1px solid #2A2A2A;background:#111}.folder-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#fafafa;flex:1}.folder-count[_ngcontent-%COMP%]{font-size:12px;color:#6b6b6b}.execute-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;background:#3b82f61a;color:#60a5fa;border:1px solid rgba(59,130,246,.3);border-radius:6px;padding:5px 12px;font-size:11px;cursor:pointer;margin-top:8px}.execute-btn[_ngcontent-%COMP%]:hover{background:#3b82f633;border-color:#3b82f6}.execute-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.execute-spinner[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border:2px solid rgba(59,130,246,.3);border-top-color:#60a5fa;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}"],changeDetection:0})};var Ia=(n,t)=>t.id;function $a(n,t){n&1&&(u(0,"div",9),c(1,"Loading topics..."),m())}function Na(n,t){if(n&1&&c(0),n&2){let e=l(2);T(' No topics found for "',e.searchQuery(),'" ')}}function Aa(n,t){n&1&&c(0," Type to search topics ")}function Ra(n,t){if(n&1&&(u(0,"div",10),f(1,Na,1,1)(2,Aa,1,0),m()),n&2){let e=l();a(),_(e.searchQuery()?1:2)}}function Da(n,t){if(n&1&&(u(0,"div",17),c(1),m()),n&2){let e=l().$implicit,o=l(2);a(),y(o.getParentPath(e))}}function La(n,t){if(n&1){let e=P();u(0,"button",15),S("click",function(){let i=C(e).$implicit,r=l(2);return x(r.selectTopic(i))}),u(1,"div",16),c(2),m(),f(3,Da,2,1,"div",17),m()}if(n&2){let e=t.$implicit,o=l(2);a(2),y(e.label),a(),_(o.getParentPath(e)?3:-1)}}function Va(n,t){if(n&1&&j(0,La,4,2,"button",14,Ia),n&2){let e=l();G(e.results())}}var Nt=class n{http=W(re);apiUrl=`${Ce.apiUrl}/api/v1/knowledge/curriculum`;topicSelected=z();cancelled=z();searchQuery=v("");results=v([]);isLoading=v(!1);allNodes=[];searchTimeout=null;ngOnInit(){this.loadTopLevelNodes()}onSearchInput(t){let e=t.target.value;this.searchQuery.set(e),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.search(e)},200)}selectTopic(t){this.topicSelected.emit(t)}onOverlayClick(t){t.target.classList.contains("overlay")&&this.cancelled.emit()}getParentPath(t){if(!t.parentId)return"";let e=this.allNodes.find(i=>i.id===t.parentId);if(!e)return"";let o=e.parentId?this.allNodes.find(i=>i.id===e.parentId):null;return o?`${o.label} > ${e.label}`:e.label}async loadTopLevelNodes(){this.isLoading.set(!0);try{let t=await B(this.http.get(this.apiUrl));this.allNodes=t.data;let e=await B(this.http.get(`${this.apiUrl}/search`));this.results.set(e.data)}catch{this.results.set([])}finally{this.isLoading.set(!1)}}async search(t){if(!t){let e=this.allNodes.filter(o=>!o.parentId);this.results.set(e);return}try{let e=await B(this.http.get(`${this.apiUrl}/search?q=${encodeURIComponent(t)}`));this.results.set(e.data)}catch{this.results.set([])}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-topic-picker"]],outputs:{topicSelected:"topicSelected",cancelled:"cancelled"},decls:18,vars:2,consts:[[1,"overlay",3,"click"],[1,"picker-panel",3,"click"],[1,"picker-header"],[1,"picker-title"],[1,"search-wrapper"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"search-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["placeholder","Search topics...","autofocus","",1,"search-input",3,"input","value"],[1,"results-list"],[1,"loading-text"],[1,"empty-results"],[1,"picker-footer"],[1,"cancel-btn",3,"click"],[1,"skip-btn",3,"click"],[1,"result-item"],[1,"result-item",3,"click"],[1,"result-label"],[1,"result-path"]],template:function(e,o){e&1&&(u(0,"div",0),S("click",function(r){return o.onOverlayClick(r)}),u(1,"div",1),S("click",function(r){return r.stopPropagation()}),u(2,"div",2)(3,"div",3),c(4,"Choose a topic for your conversation"),m(),u(5,"div",4),w(),u(6,"svg",5),I(7,"path",6),m(),F(),u(8,"input",7),S("input",function(r){return o.onSearchInput(r)}),m()()(),u(9,"div",8),f(10,$a,2,0,"div",9)(11,Ra,3,1,"div",10)(12,Va,2,0),m(),u(13,"div",11)(14,"button",12),S("click",function(){return o.cancelled.emit()}),c(15,"Cancel"),m(),u(16,"button",13),S("click",function(){return o.topicSelected.emit(null)}),c(17,"Skip \u2014 General Chat"),m()()()()),e&2&&(a(8),Q("value",o.searchQuery()),a(2),_(o.isLoading()?10:o.results().length===0?11:12))},dependencies:[Y],styles:["[_nghost-%COMP%]{display:block}.overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:100;background:#0009;display:flex;align-items:center;justify-content:center}.picker-panel[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #2A2A2A;border-radius:12px;width:480px;max-height:520px;display:flex;flex-direction:column;box-shadow:0 8px 32px #0006}.picker-header[_ngcontent-%COMP%]{padding:16px 20px 12px;border-bottom:1px solid #2A2A2A}.picker-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#fafafa;margin-bottom:12px}.search-input[_ngcontent-%COMP%]{width:100%;background:#0d0d0d;border:1px solid #2A2A2A;border-radius:8px;padding:10px 12px 10px 36px;color:#fafafa;font-size:13px;font-family:inherit}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.search-input[_ngcontent-%COMP%]::placeholder{color:#4a4a4a}.search-wrapper[_ngcontent-%COMP%]{position:relative}.search-icon[_ngcontent-%COMP%]{position:absolute;left:10px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:#4a4a4a}.results-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px}.result-item[_ngcontent-%COMP%]{display:block;width:100%;text-align:left;padding:10px 12px;border-radius:6px;background:none;border:none;color:inherit;cursor:pointer}.result-item[_ngcontent-%COMP%]:hover{background:#242424}.result-label[_ngcontent-%COMP%]{font-size:13px;color:#fafafa}.result-path[_ngcontent-%COMP%]{font-size:11px;color:#4a4a4a;margin-top:2px}.picker-footer[_ngcontent-%COMP%]{padding:12px 20px;border-top:1px solid #2A2A2A;display:flex;justify-content:space-between;align-items:center}.skip-btn[_ngcontent-%COMP%]{background:none;border:1px solid #2A2A2A;border-radius:6px;padding:8px 16px;color:#a1a1a1;font-size:13px;cursor:pointer}.skip-btn[_ngcontent-%COMP%]:hover{color:#fafafa;border-color:#4a4a4a}.cancel-btn[_ngcontent-%COMP%]{background:none;border:none;color:#6b6b6b;font-size:13px;cursor:pointer}.cancel-btn[_ngcontent-%COMP%]:hover{color:#fafafa}.empty-results[_ngcontent-%COMP%], .loading-text[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#6b6b6b;font-size:13px}"],changeDetection:0})};var Fa=["yoloLogContainer"],za=["messagesContainer"],So=(n,t)=>t.stepId,Ba=(n,t)=>t.id,Wa=(n,t)=>t.conceptName;function Ha(n,t){if(n&1){let e=P();p(0,"div",2),w(),p(1,"svg",21),E(2,"path",22),h(),F(),p(3,"span",23),c(4),h(),p(5,"button",24),R("click",function(){C(e);let i=l();return x(i.dismissError())}),w(),p(6,"svg",25),E(7,"path",26),h()()()}if(n&2){let e=l();a(4),y(e.errorMessage$())}}function qa(n,t){if(n&1){let e=P();p(0,"app-topic-picker",27),R("topicSelected",function(i){C(e);let r=l();return x(r.onTopicSelected(i))})("cancelled",function(){C(e);let i=l();return x(i.onTopicPickerCancelled())}),h()}}function Ua(n,t){n&1&&(w(),p(0,"svg",37),E(1,"path",44),h())}function ja(n,t){n&1&&(w(),p(0,"svg",38),E(1,"path",45),h())}function Ga(n,t){n&1&&(w(),p(0,"svg",38),E(1,"path",26),h())}function Ya(n,t){if(n&1&&c(0),n&2){let e=l().$implicit;T(" ",e.workflowStepNumber," ")}}function Ka(n,t){if(n&1&&(p(0,"span",43),c(1),h()),n&2){let e=l().$implicit;a(),y(e.departmentTag)}}function Qa(n,t){if(n&1&&(p(0,"div",33)(1,"div",36),f(2,Ua,2,0,":svg:svg",37)(3,ja,2,0,":svg:svg",38)(4,Ga,2,0,":svg:svg",38)(5,Ya,1,1),h(),p(6,"div",39)(7,"div",40),c(8),h(),p(9,"div",41),c(10),h(),p(11,"div",42)(12,"span",43),c(13),h(),f(14,Ka,2,1,"span",43),p(15,"span",43),c(16),h()()()()),n&2){let e=t.$implicit,o=l(2);a(),A("step-pending",o.getStepStatus(e.stepId)==="pending")("step-in-progress",o.getStepStatus(e.stepId)==="in_progress")("step-completed",o.getStepStatus(e.stepId)==="completed")("step-failed",o.getStepStatus(e.stepId)==="failed"),a(),_(o.getStepStatus(e.stepId)==="in_progress"?2:o.getStepStatus(e.stepId)==="completed"?3:o.getStepStatus(e.stepId)==="failed"?4:5),a(6),y(e.title),a(2),y(e.description),a(3),y(e.conceptName),a(),_(e.departmentTag?14:-1),a(2),T("~",e.estimatedMinutes,"m")}}function Za(n,t){if(n&1){let e=P();p(0,"button",46),R("click",function(){C(e);let i=l(2);return x(i.cancelExecution())}),c(1,"Cancel Execution"),h()}}function Xa(n,t){if(n&1){let e=P();p(0,"button",46),R("click",function(){C(e);let i=l(2);return x(i.rejectPlan())}),c(1,"Cancel"),h(),p(2,"button",47),R("click",function(){C(e);let i=l(2);return x(i.approvePlan())}),c(3,"Approve & Execute"),h()}}function Ja(n,t){if(n&1){let e=P();p(0,"div",28),R("click",function(i){C(e);let r=l();return x(i.target===i.currentTarget&&!r.isExecutingWorkflow$()?r.rejectPlan():null)}),p(1,"div",29)(2,"div",30)(3,"h3"),c(4),h(),p(5,"div",31)(6,"span"),c(7),h(),p(8,"span"),c(9),h(),p(10,"span"),c(11),h()()(),p(12,"div",32),j(13,Qa,17,14,"div",33,So),h(),p(15,"div",34),f(16,Za,2,0,"button",35)(17,Xa,4,0),h()()()}if(n&2){let e=l();a(4),y(e.isExecutingWorkflow$()?"Executing Plan...":"Execution Plan"),a(3),T("",e.currentPlan$().steps.length," steps"),a(2),T("~",e.currentPlan$().totalEstimatedMinutes," min"),a(2),T("",e.currentPlan$().conceptOrder.length," concepts"),a(2),G(e.currentPlan$().steps),a(3),_(e.isExecutingWorkflow$()?16:17)}}function es(n,t){if(n&1&&(w(),p(0,"svg",51),E(1,"path",52),h(),F(),p(2,"h2"),c(3),h()),n&2){let e=l(2);a(3),y(e.folderName$())}}function ts(n,t){if(n&1&&E(0,"app-persona-badge",53),n&2){let e=l(3);X("personaType",e.currentPersonaType$())}}function ns(n,t){if(n&1&&(p(0,"h2"),c(1),h(),f(2,ts,1,1,"app-persona-badge",53)),n&2){let e,o=l(2);a(),y(((e=o.activeConversation$())==null?null:e.title)||"New Conversation"),a(),_(o.currentPersonaType$()?2:-1)}}function os(n,t){if(n&1){let e=P();p(0,"div",50)(1,"div",54)(2,"button",55),R("click",function(){C(e);let i=l(2);return x(i.activeTab$.set("chat"))}),c(3,"Chat"),h(),p(4,"button",55),R("click",function(){C(e);let i=l(2);return x(i.activeTab$.set("notes"))}),c(5,"Tasks"),h()(),p(6,"button",56),R("click",function(){C(e);let i=l(2);return x(i.togglePersonaSelector())}),w(),p(7,"svg",9),E(8,"path",57),h(),c(9),h()()}if(n&2){let e=l(2);a(2),A("active",e.activeTab$()==="chat"),a(2),A("active",e.activeTab$()==="notes"),a(5),T(" ",e.showPersonaSelector$()?"Hide Personas":"Switch Persona"," ")}}function is(n,t){if(n&1){let e=P();p(0,"div",61)(1,"p",70),c(2,"Select a department persona for specialized AI responses:"),h(),p(3,"app-persona-selector",71),R("personaSelected",function(i){C(e);let r=l(4);return x(r.onPersonaSelected(i))}),h()()}if(n&2){let e=l(4);a(3),X("selectedType",e.currentPersonaType$())("allowNone",!1)}}function rs(n,t){if(n&1){let e=P();p(0,"app-chat-message",72),R("citationClick",function(i){C(e);let r=l(4);return x(r.onCitationClick(i))}),h()}if(n&2){let e=t.$implicit,o=l(4);X("message",e)("personaType",e.role==="ASSISTANT"?o.currentPersonaType$():null)}}function as(n,t){if(n&1&&(p(0,"div",76),c(1),h()),n&2){let e=l(5);a(),it("Korak ",e.currentStepIndex$()+1,"/",e.totalStepsCount$(),": ",e.currentStepTitle$())}}function ss(n,t){n&1&&(p(0,"div",77),w(),p(1,"svg",82),E(2,"path",44),h(),c(3," Pripremam plan izvr\u0161avanja... "),h())}function ls(n,t){n&1&&(w(),p(0,"svg",85),E(1,"path",45),h())}function cs(n,t){n&1&&(w(),p(0,"svg",86),E(1,"path",44),h())}function ds(n,t){n&1&&(w(),p(0,"svg",87),E(1,"path",26),h())}function ps(n,t){if(n&1&&(p(0,"span",88),c(1),h()),n&2){let e=l().$implicit;a(),y(e.workflowStepNumber)}}function us(n,t){if(n&1&&(p(0,"div",84),f(1,ls,2,0,":svg:svg",85)(2,cs,2,0,":svg:svg",86)(3,ds,2,0,":svg:svg",87)(4,ps,2,1,"span",88),p(5,"span",89),c(6),h(),p(7,"span",90),c(8),h()()),n&2){let e=t.$implicit,o=l(6);A("active",o.getStepStatus(e.stepId)==="in_progress")("completed",o.getStepStatus(e.stepId)==="completed")("failed",o.getStepStatus(e.stepId)==="failed"),a(),_(o.getStepStatus(e.stepId)==="completed"?1:o.getStepStatus(e.stepId)==="in_progress"?2:o.getStepStatus(e.stepId)==="failed"?3:4),a(5),y(e.title),a(2),y(e.conceptName)}}function ms(n,t){if(n&1&&(p(0,"div",81),j(1,us,9,9,"div",83,So),h()),n&2){let e=l(5);a(),G(e.currentPlan$().steps)}}function hs(n,t){if(n&1&&(p(0,"div",65)(1,"div",73),w(),p(2,"svg",74),E(3,"path",44),h(),F(),p(4,"span",75),c(5,"Izvr\u0161avam zadatke..."),h()(),f(6,as,2,3,"div",76)(7,ss,4,0,"div",77),p(8,"div",78),E(9,"div",79),h(),p(10,"div",80),c(11),h(),f(12,ms,3,0,"div",81),h()),n&2){let e=l(4);a(6),_(e.currentStepTitle$()?6:7),a(3),H("width",e.progressPercent$(),"%"),a(2),se("",e.completedStepsCount$()," / ",e.totalStepsCount$()," koraka zavrseno"),a(),_(e.currentPlan$()?12:-1)}}function gs(n,t){if(n&1&&c(0),n&2){let e=l(5);se(" Processing ",e.yoloProgress$().currentTasks.length," concept",e.yoloProgress$().currentTasks.length>1?"s":""," ")}}function fs(n,t){n&1&&c(0," YOLO Mode \u2014 Autonomous Execution ")}function _s(n,t){if(n&1&&(c(0," | Failed: "),p(1,"span",97),c(2),h()),n&2){let e=l(5);a(2),y(e.yoloProgress$().failed)}}function Cs(n,t){if(n&1&&(c(0," | "),p(1,"span",98),c(2),h()),n&2){let e=l(5);a(2),T("Discovered: ",e.yoloProgress$().discoveredCount)}}function xs(n,t){if(n&1&&(p(0,"span",102),c(1),h()),n&2){let e=l().$implicit;a(),it(" Step ",(e.currentStepIndex??0)+1,"/",e.totalSteps??"?",": ",e.currentStep," ")}}function bs(n,t){if(n&1&&(p(0,"div",99),E(1,"span",100),p(2,"span",101),c(3),h(),f(4,xs,2,3,"span",102),h()),n&2){let e=t.$implicit;a(3),y(e.conceptName),a(),_(e.currentStep?4:-1)}}function vs(n,t){if(n&1&&(p(0,"div",96),j(1,bs,5,2,"div",99,Wa),h()),n&2){let e=l(5);a(),G(e.yoloProgress$().currentTasks)}}function ks(n,t){if(n&1&&(p(0,"div",107),c(1),h()),n&2){let e=t.$implicit;a(),y(e)}}function ys(n,t){if(n&1&&(p(0,"div",106,1),j(2,ks,2,1,"div",107,tt),h()),n&2){let e=l(6);a(2),G(e.yoloProgress$().recentLogs)}}function ws(n,t){if(n&1){let e=P();p(0,"button",103),R("click",function(){C(e);let i=l(5);return x(i.toggleYoloActivityLog())}),w(),p(1,"svg",104),E(2,"path",105),h(),c(3),h(),f(4,ys,4,0,"div",106)}if(n&2){let e=l(5);a(),A("expanded",e.showYoloActivityLog$()),a(2),se(" ",e.showYoloActivityLog$()?"Hide":"Show"," Activity Log (",e.yoloProgress$().recentLogs.length,") "),a(),_(e.showYoloActivityLog$()?4:-1)}}function Ps(n,t){if(n&1&&(p(0,"div",66)(1,"div",91),E(2,"span",92),f(3,gs,1,2)(4,fs,1,0),h(),p(5,"div",93),c(6," Running: "),p(7,"span"),c(8),h(),c(9," | Completed: "),p(10,"span"),c(11),h(),f(12,_s,3,1),f(13,Cs,3,1),h(),p(14,"div",94),E(15,"div",95),h(),f(16,vs,3,0,"div",96),f(17,ws,5,5),h()),n&2){let e=l(4);a(3),_(e.yoloProgress$().currentTasks.length>0?3:4),a(5),se("",e.yoloProgress$().running,"/",e.yoloProgress$().maxConcurrency),a(3),se("",e.yoloProgress$().completed,"/",e.yoloProgress$().total),a(),_(e.yoloProgress$().failed>0?12:-1),a(),_(e.yoloProgress$().discoveredCount>0?13:-1),a(2),H("width",e.yoloProgress$().total>0?e.yoloProgress$().completed/e.yoloProgress$().total*100:0,"%"),a(),_(e.yoloProgress$().currentTasks.length>0?16:-1),a(),_(e.yoloProgress$().recentLogs&&e.yoloProgress$().recentLogs.length>0?17:-1)}}function Ss(n,t){if(n&1&&E(0,"app-chat-message",67),n&2){let e=l(4);X("message",e.streamingMessage$())("isStreaming",!0)("personaType",e.currentPersonaType$())}}function Es(n,t){if(n&1&&E(0,"app-typing-indicator",53),n&2){let e=l(4);X("personaType",e.currentPersonaType$())}}function Ms(n,t){n&1&&(p(0,"div",65)(1,"div",73),w(),p(2,"svg",74),E(3,"path",44),h(),F(),p(4,"span",75),c(5,"U\u010Ditavam workflow..."),h()(),p(6,"div",77),w(),p(7,"svg",82),E(8,"path",44),h(),c(9," Generi\u0161em plan izvr\u0161avanja... "),h()())}function Ts(n,t){if(n&1){let e=P();p(0,"div",115)(1,"button",117),R("click",function(){C(e);let i=l(5);return x(i.continueWorkflowStep())}),c(2," Nastavi "),w(),p(3,"svg",118),E(4,"line",119)(5,"polyline",120),h()(),F(),p(6,"button",121),R("click",function(){C(e);let i=l(5);return x(i.cancelExecution())}),c(7," Otkazi "),h()()}}function Os(n,t){n&1&&(p(0,"div",116),w(),p(1,"svg",122),E(2,"path",123),h(),F(),p(3,"span"),c(4,"Unesite odgovor u polje za poruke ispod"),h()())}function Is(n,t){if(n&1&&(p(0,"div",68)(1,"div",108),w(),p(2,"svg",109),E(3,"circle",110)(4,"polyline",111),h(),F(),p(5,"span",112),c(6),h()(),p(7,"p",113),c(8),h(),p(9,"p",114),c(10),h(),f(11,Ts,8,0,"div",115)(12,Os,5,0,"div",116),h()),n&2){let e=t;a(6),it("Korak ",e.stepIndex+1,"/",e.totalSteps,": ",e.conceptName),a(2),y(e.stepTitle),a(2),y(e.stepDescription),a(),_(e.inputType==="confirmation"?11:12)}}function $s(n,t){if(n&1){let e=P();p(0,"div",69)(1,"button",124),R("click",function(){C(e);let i=l(4);return x(i.returnToPreviousConversation())}),w(),p(2,"svg",118),E(3,"line",125)(4,"polyline",126),h(),c(5," Vrati se na prethodnu konverzaciju "),h()()}}function Ns(n,t){if(n&1){let e=P();p(0,"div",68)(1,"div",108),w(),p(2,"svg",109),E(3,"circle",110)(4,"polyline",111),h(),F(),p(5,"span",112),c(6),h()(),p(7,"p",113),c(8),h(),p(9,"p",114),c(10),h(),p(11,"div",116),w(),p(12,"svg",122),E(13,"path",123),h(),F(),p(14,"span"),c(15,"Imate li dodatne informacije ili odgovore za ovaj korak?"),h()(),p(16,"textarea",127),R("input",function(i){C(e);let r=l(4);return x(r.userStepInput$.set(i.target.value))}),h(),p(17,"div",115)(18,"button",117),R("click",function(){C(e);let i=l(4);return x(i.continueWorkflow())}),c(19),w(),p(20,"svg",118),E(21,"line",119)(22,"polyline",120),h()(),F(),p(23,"button",121),R("click",function(){C(e);let i=l(4);return x(i.cancelExecution())}),c(24," Otka\u017Ei "),h()()()}if(n&2){let e=l(4);a(6),se("Korak ",e.nextStepInfo$().stepIndex+1,"/",e.nextStepInfo$().totalSteps,":"),a(2),y(e.nextStepInfo$().title),a(2),y(e.nextStepInfo$().description),a(6),X("value",e.userStepInput$()),a(3),T(" ",e.userStepInput$()?"Izvr\u0161i sa odgovorom":"Presko\u010Di i izvr\u0161i"," ")}}function As(n,t){if(n&1&&(f(0,is,4,2,"div",61),p(1,"div",62,0)(3,"div",63),j(4,rs,1,2,"app-chat-message",64,Ba),f(6,hs,13,6,"div",65),f(7,Ps,18,11,"div",66),f(8,Ss,1,3,"app-chat-message",67),f(9,Es,1,1,"app-typing-indicator",53),f(10,Ms,10,0,"div",65),f(11,Is,13,6,"div",68),f(12,$s,6,0,"div",69),f(13,Ns,25,6,"div",68),h()()),n&2){let e,o=l(3);_(o.showPersonaSelector$()?0:-1),a(4),G(o.messages$()),a(2),_(o.isExecutingWorkflow$()?6:-1),a(),_(o.isYoloMode$()&&o.yoloProgress$()?7:-1),a(),_(o.isStreaming$()?8:-1),a(),_(o.isLoading$()&&!o.isStreaming$()?9:-1),a(),_(o.isGeneratingPlan$()?10:-1),a(),_((e=o.currentWorkflowStepInput$())?11:-1,e),a(),_(o.previousConversationId$()?12:-1),a(),_(o.awaitingConfirmation$()&&o.nextStepInfo$()&&!o.currentWorkflowStepInput$()?13:-1)}}function Rs(n,t){if(n&1){let e=P();p(0,"div",58)(1,"app-conversation-notes",128),R("viewMessage",function(i){C(e);let r=l(3);return x(r.onViewMessage(i))})("runAgents",function(i){C(e);let r=l(3);return x(r.onRunAgents(i))})("executeTask",function(i){C(e);let r=l(3);return x(r.onExecuteSingleTask(i))}),h()()}if(n&2){let e,o=l(3);a(),X("conversationId",o.activeConversationId$())("conceptId",((e=o.activeConversation$())==null?null:e.conceptId)??null)("autoSelectTaskIds",o.autoSelectTaskIds$())("isExecuting",o.isExecutingWorkflow$())("executingTaskId",o.isGeneratingPlan$()?o.executingTaskId$():null)("isGeneratingPlan",o.isGeneratingPlan$())}}function Ds(n,t){if(n&1){let e=P();f(0,As,14,9)(1,Rs,2,6,"div",58),p(2,"div",59)(3,"app-chat-input",60),R("messageSent",function(i){C(e);let r=l(2);return x(r.sendMessage(i))}),h()()}if(n&2){let e=l(2);_(e.activeTab$()==="chat"?0:1),a(3),X("disabled",e.isLoading$()&&!e.allowWorkflowInput$())}}function Ls(n,t){if(n&1){let e=P();p(0,"div",129)(1,"div",130)(2,"div",131)(3,"div",132),c(4,"Zavr\u0161eno"),h(),p(5,"div",133),c(6),h()(),p(7,"div",131)(8,"div",132),c(9,"Na \u010Dekanju"),h(),p(10,"div",134),c(11),h()(),p(12,"div",131)(13,"div",132),c(14,"Ukupno"),h(),p(15,"div",135),c(16),h()()(),p(17,"div",136)(18,"button",137),R("click",function(){C(e);let i=l(2);return x(i.onRunBrain())}),w(),p(19,"svg",9),E(20,"path",138),h(),c(21," Pokreni Brain "),h(),F(),p(22,"button",139),R("click",function(){C(e);let i=l(2);return x(i.showTopicPicker$.set(!0))}),w(),p(23,"svg",9),E(24,"path",140),h(),c(25," Istra\u017Ei koncept "),h()()(),F(),p(26,"div",141)(27,"app-conversation-notes",142),R("viewMessage",function(i){C(e);let r=l(2);return x(r.onViewMessage(i))})("runAgents",function(i){C(e);let r=l(2);return x(r.onRunAgents(i))})("executeTask",function(i){C(e);let r=l(2);return x(r.onExecuteSingleTask(i))}),h()()}if(n&2){let e=l(2);a(6),y(e.domainCompletedCount$()),a(5),y(e.domainPendingCount$()),a(5),y(e.domainCompletedCount$()+e.domainPendingCount$()),a(2),X("disabled",e.isExecutingWorkflow$()||e.isYoloMode$()||e.domainPendingCount$()===0),a(9),X("conversationId",null)("conceptId",null)("folderConceptIds",e.folderConceptIds$())("folderConversationIds",e.folderConversationIds$())("folderName",e.folderName$())("autoSelectTaskIds",e.autoSelectTaskIds$())("isExecuting",e.isExecutingWorkflow$())("executingTaskId",e.isGeneratingPlan$()?e.executingTaskId$():null)("isGeneratingPlan",e.isGeneratingPlan$())}}function Vs(n,t){if(n&1&&(p(0,"header",48)(1,"div",49),f(2,es,4,1)(3,ns,3,2),h(),f(4,os,10,5,"div",50),h(),f(5,Ds,4,2)(6,Ls,28,13)),n&2){let e=l();a(2),_(e.folderName$()&&!e.activeConversation$()?2:3),a(2),_(e.activeConversation$()?4:-1),a(),_(e.activeConversation$()?5:e.folderName$()?6:-1)}}function Fs(n,t){if(n&1){let e=P();p(0,"div",19)(1,"div",143)(2,"div",144),w(),p(3,"svg",145),E(4,"path",146),h()(),F(),p(5,"h2",147),c(6,"Welcome to Mentor AI"),h(),p(7,"p",148),c(8,"Your AI-powered business partner with expertise in Finance, Marketing, Technology, Operations, Legal, and Creative."),h(),p(9,"button",149),R("click",function(){C(e);let i=l();return x(i.createNewConversation())}),w(),p(10,"svg",150),E(11,"path",10),h(),c(12," Start New Conversation "),h(),F(),p(13,"div",151)(14,"span",152),c(15,"CFO"),h(),p(16,"span",153),c(17,"CMO"),h(),p(18,"span",154),c(19,"CTO"),h(),p(20,"span",155),c(21,"Operations"),h(),p(22,"span",156),c(23,"Legal"),h(),p(24,"span",157),c(25,"Creative"),h()()()()}}function zs(n,t){if(n&1){let e=P();p(0,"aside",20)(1,"div",158),c(2,"Izvor"),h(),p(3,"app-concept-panel",159),R("close",function(){C(e);let i=l();return x(i.closeConceptPanel())})("conceptClick",function(i){C(e);let r=l();return x(r.onRelatedConceptClick(i))}),h()()}if(n&2){let e=l();a(3),X("conceptId",e.selectedConceptId$())("isOpen",!0)}}var Po=class n{conversationService=W(Me);chatWsService=W(ft);http=W(re);route=W(xn);router=W(bn);destroyRef=W(un);notesApi=W(Ae);conceptTree;conversationNotes;yoloLogContainer;messagesContainer;activeConversation$=v(null);activeConversationId$=oe(()=>this.activeConversation$()?.id??null);messages$=oe(()=>this.activeConversation$()?.messages??[]);isLoading$=v(!1);isStreaming$=v(!1);streamingContent$=v("");streamingMessage$=oe(()=>({id:"streaming",conversationId:this.activeConversationId$()??"",role:"ASSISTANT",content:this.streamingContent$(),confidenceScore:null,confidenceFactors:null,createdAt:""}));showPersonaSelector$=v(!1);currentPersonaType$=oe(()=>this.activeConversation$()?.personaType??null);errorMessage$=v(null);selectedConceptId$=v(null);activeTab$=v("chat");showTopicPicker$=v(!1);showPlanOverlay$=v(!1);currentPlan$=v(null);executionProgress$=v(new Map);isExecutingWorkflow$=v(!1);createdConceptConversations$=v([]);newConversationIds$=v(new Set);folderConceptIds$=v([]);folderConversationIds$=v([]);folderName$=v(null);autoSelectTaskIds$=v([]);domainCompletedCount$=v(0);domainPendingCount$=v(0);currentStepTitle$=v(null);currentStepIndex$=v(0);totalStepsCount$=v(0);completedStepsCount$=v(0);progressPercent$=oe(()=>{let t=this.totalStepsCount$();return t===0?0:Math.round(this.completedStepsCount$()/t*100)});activePlanId$=v(null);awaitingConfirmation$=v(!1);nextStepInfo$=v(null);userStepInput$=v("");isGeneratingPlan$=v(!1);allowWorkflowInput$=v(!1);currentWorkflowStepInput$=v(null);previousConversationId$=v(null);executingTaskId$=v(null);loadingConversationId$=v(null);isCreatingConversation$=oe(()=>this.conversationService.isCreating$());isYoloMode$=v(!1);yoloProgress$=v(null);showYoloActivityLog$=v(!1);yoloPending=!1;manualAutostartPending=!1;ngOnInit(){this.setupWebSocket(),this.route.params.pipe(Rt(this.destroyRef)).subscribe(t=>{t.conversationId&&this.loadConversation(t.conversationId)}),this.route.queryParams.pipe(Rt(this.destroyRef)).subscribe(t=>{t.yolo==="true"&&!this.isYoloMode$()&&(this.isYoloMode$.set(!0),this.yoloPending=!0),t.autostart==="true"&&(this.manualAutostartPending=!0)})}ngOnDestroy(){this.chatWsService.disconnect()}async loadConversation(t){try{let e=await this.conversationService.getConversation(t);if(this.activeConversation$.set(e),this.activeTab$.set("chat"),this.yoloPending){this.yoloPending=!1;try{await this.chatWsService.waitForConnection(),this.chatWsService.emitStartYolo(t)}catch{this.showError("WebSocket connection failed \u2014 YOLO mode could not start")}}if(this.manualAutostartPending){this.manualAutostartPending=!1;try{await this.chatWsService.waitForConnection(),this.autoStartManualWorkflow(t)}catch{}}}catch{this.activeConversation$.set(null),this.showError("Failed to load conversation")}}async createNewConversation(){try{let t=await this.conversationService.createConversation();await this.loadConversation(t.id),this.router.navigate(["/chat",t.id]),this.conceptTree?.loadTree()}catch{this.showError("Failed to create conversation")}}async onTopicSelected(t){this.showTopicPicker$.set(!1);try{let e=await this.conversationService.createConversation(void 0,void 0,void 0,t?.id);await this.loadConversation(e.id),this.router.navigate(["/chat",e.id]),this.conceptTree?.loadTree()}catch{this.showError("Failed to create conversation")}}onTopicPickerCancelled(){this.showTopicPicker$.set(!1)}async createConversationUnderConcept(t){this.loadingConversationId$.set(t.conceptId);try{let e=this.formatConversationTitle(t.conceptName),o=await this.conversationService.createConversation(e,void 0,void 0,t.conceptId);this.newConversationIds$.update(i=>{let r=new Set(i);return r.add(o.id),r}),await this.loadConversation(o.id),this.router.navigate(["/chat",o.id]),this.conceptTree?.loadTree()}catch{this.showError("Failed to create conversation")}finally{this.loadingConversationId$.set(null)}}selectConversation(t){this.folderConceptIds$.set([]),this.folderConversationIds$.set([]),this.folderName$.set(null),this.activeTab$.set("chat"),this.autoSelectTaskIds$.set([]),this.newConversationIds$.update(e=>{let o=new Set(e);return o.delete(t),o}),this.router.navigate(["/chat",t])}togglePersonaSelector(){this.showPersonaSelector$.update(t=>!t)}showError(t){this.errorMessage$.set(t),setTimeout(()=>this.dismissError(),5e3)}dismissError(){this.errorMessage$.set(null)}onCitationClick(t){if(typeof t=="string"){this.lookupConceptByName(t);return}if(this.isExecutingWorkflow$()){this.selectedConceptId$.set(t.conceptId);return}let o=this.createdConceptConversations$().find(i=>i.conceptId===t.conceptId);if(o){this.router.navigate(["/chat",o.conversationId]);return}this.selectedConceptId$.set(t.conceptId)}async lookupConceptByName(t){try{let e=await B(this.http.get(`/api/v1/knowledge/concepts/by-name/${encodeURIComponent(t)}`));e?.data?.id&&this.selectedConceptId$.set(e.data.id)}catch{}}closeConceptPanel(){this.selectedConceptId$.set(null)}onRelatedConceptClick(t){this.selectedConceptId$.set(t)}onViewMessage(t){this.activeTab$.set("chat"),setTimeout(()=>{let e=document.getElementById(`msg-${t.messageId}`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("highlight-flash"),setTimeout(()=>e.classList.remove("highlight-flash"),2e3))},100)}async onPersonaSelected(t){let e=this.activeConversationId$();if(e){if(t)try{let o=await this.conversationService.updatePersona(e,t.type);this.activeConversation$.update(i=>i&&Z(L({},i),{personaType:o.personaType}))}catch{this.showError("Failed to update persona")}this.showPersonaSelector$.set(!1)}}async onConceptSelected(t){if(t.isFolder){this.folderConceptIds$.set(t.descendantConceptIds),this.folderConversationIds$.set(t.descendantConversationIds),this.folderName$.set(t.conceptName),this.activeConversation$.set(null),this.activeTab$.set("notes"),this.domainCompletedCount$.set(t.descendantConversationIds.length);let e=new Set(t.descendantConversationIds);this.domainPendingCount$.set(Math.max(0,t.descendantConceptIds.length-e.size));return}this.folderConceptIds$.set([]),this.folderConversationIds$.set([]),this.folderName$.set(null);try{let e=this.conceptTree?.treeData$(),o=this.findNodeByCurriculumId(e?.tree??[],t.curriculumId);if(o&&o.conversations.length>0){let i=o.conversations[0];await this.loadConversation(i.id),this.router.navigate(["/chat",i.id]),this.activeTab$.set("chat")}else{let i=this.formatConversationTitle(t.conceptName),r=await this.conversationService.createConversation(i,void 0,void 0,t.curriculumId);this.newConversationIds$.update(s=>{let g=new Set(s);return g.add(r.id),g}),await this.loadConversation(r.id),this.router.navigate(["/chat",r.id]),this.conceptTree?.loadTree(),this.activeTab$.set("chat")}}catch{this.showError("Failed to load concept")}}findNodeByCurriculumId(t,e){for(let o of t){if(o.curriculumId===e)return o;let i=this.findNodeByCurriculumId(o.children,e);if(i)return i}return null}formatConversationTitle(t){let e=new Date,o=e.toISOString().slice(0,10),i=e.toTimeString().slice(0,5).replace(":","-");return`${t}_${o}_${i}`}async autoStartManualWorkflow(t){try{let o=(await this.notesApi.getByConversation(t)).filter(i=>i.noteType==="TASK"&&i.status==="PENDING").map(i=>i.id);o.length>0&&this.onRunAgents(o)}catch{}}onRunAgents(t){let e=this.activeConversationId$();!e||t.length===0||(this.isGeneratingPlan$.set(!0),this.chatWsService.emitRunAgents(t,e),setTimeout(()=>{let o=this.messagesContainer?.nativeElement;o&&(o.scrollTop=o.scrollHeight)}))}onExecuteSingleTask(t){this.executingTaskId$.set(t),this.onRunAgents([t])}async onRunBrain(){let t=this.folderName$();if(t)try{let e=`Brain: ${t}`,o=await this.conversationService.createConversation(e);await this.loadConversation(o.id),this.isYoloMode$.set(!0),this.chatWsService.emitStartDomainYolo(o.id,t)}catch{this.showError("Failed to start domain Brain execution")}}getStepStatus(t){return this.executionProgress$().get(t)??"pending"}approvePlan(){let t=this.currentPlan$(),e=this.activeConversationId$();!t||!e||(this.isExecutingWorkflow$.set(!0),this.chatWsService.emitWorkflowApproval(t.planId,!0,e))}rejectPlan(){let t=this.currentPlan$(),e=this.activeConversationId$();!t||!e||(this.chatWsService.emitWorkflowApproval(t.planId,!1,e),this.closePlanOverlay())}cancelExecution(){let t=this.activePlanId$()??this.currentPlan$()?.planId,e=this.activeConversationId$();!t||!e||this.chatWsService.emitWorkflowCancel(t,e)}closePlanOverlay(){this.showPlanOverlay$.set(!1),this.currentPlan$.set(null),this.activePlanId$.set(null),this.executionProgress$.set(new Map),this.isExecutingWorkflow$.set(!1),this.currentStepTitle$.set(null),this.currentStepIndex$.set(0),this.totalStepsCount$.set(0),this.completedStepsCount$.set(0),this.createdConceptConversations$.set([]),this.awaitingConfirmation$.set(!1),this.nextStepInfo$.set(null),this.userStepInput$.set(""),this.isGeneratingPlan$.set(!1),this.allowWorkflowInput$.set(!1),this.currentWorkflowStepInput$.set(null),this.previousConversationId$.set(null)}async sendMessage(t){let e=this.activeConversationId$();if(!e||!t.trim())return;this.activeTab$()!=="chat"&&this.activeTab$.set("chat");let o=this.currentWorkflowStepInput$();if(o&&o.inputType==="text"){let r={id:`wf_user_${Date.now()}`,conversationId:e,role:"USER",content:t,confidenceScore:null,confidenceFactors:null,createdAt:new Date().toISOString()};this.activeConversation$.update(s=>s&&Z(L({},s),{messages:[...s.messages,r]})),this.chatWsService.emitStepContinue(o.planId,e,t),this.currentWorkflowStepInput$.set(null),this.allowWorkflowInput$.set(!1),this.isLoading$.set(!0);return}this.isLoading$.set(!0),this.streamingContent$.set("");let i={id:`temp_${Date.now()}`,conversationId:e,role:"USER",content:t,confidenceScore:null,confidenceFactors:null,createdAt:new Date().toISOString()};this.activeConversation$.update(r=>r&&Z(L({},r),{messages:[...r.messages,i]})),this.chatWsService.sendMessage(e,t)}setupWebSocket(){this.chatWsService.connect(),this.chatWsService.onMessageReceived(t=>{this.activeConversation$.update(e=>{if(!e)return e;let o=e.messages.map((i,r,s)=>i.role==="USER"&&i.id.startsWith("temp_")&&!s.slice(r+1).some(d=>d.role==="USER"&&d.id.startsWith("temp_"))?Z(L({},i),{id:t.messageId}):i);return Z(L({},e),{messages:o})}),this.isStreaming$.set(!0)}),this.chatWsService.onMessageChunk(t=>{this.streamingContent$.update(e=>e+t.content)}),this.chatWsService.onComplete(t=>{let e=t.metadata?.confidence,o={id:t.messageId,conversationId:this.activeConversationId$()??"",role:"ASSISTANT",content:t.fullContent,confidenceScore:e?.score??null,confidenceFactors:e?.factors??null,createdAt:new Date().toISOString()};this.activeConversation$.update(i=>i&&Z(L({},i),{messages:[...i.messages,o]})),this.isLoading$.set(!1),this.isStreaming$.set(!1),this.streamingContent$.set("")}),this.chatWsService.onError(()=>{this.isLoading$.set(!1),this.isStreaming$.set(!1),this.showError("Message failed to send. Please try again.")}),this.chatWsService.onNotesUpdated(()=>{this.conversationNotes?.loadNotes()}),this.chatWsService.onTasksCreatedForExecution(t=>{t.conversationId===this.activeConversationId$()&&(this.autoSelectTaskIds$.set(t.taskIds),this.activeTab$.set("notes"),this.conversationNotes?.loadNotes())}),this.chatWsService.onConceptDetected(t=>{this.conceptTree?.loadTree(),t.conversationId===this.activeConversationId$()&&this.activeConversation$.update(e=>e&&Z(L({},e),{conceptId:t.conceptId}))}),this.chatWsService.onPlanReady(t=>{t.conversationId===this.activeConversationId$()&&(this.isGeneratingPlan$.set(!1),this.executingTaskId$.set(null),this.currentPlan$.set(t.plan),this.activePlanId$.set(t.plan.planId),this.executionProgress$.set(new Map),this.isExecutingWorkflow$.set(!1),this.showPlanOverlay$.set(!0))}),this.chatWsService.onConversationsCreated(t=>{t.originalConversationId===this.activeConversationId$()&&(this.createdConceptConversations$.set(t.conversations),this.newConversationIds$.update(e=>{let o=new Set(e);return t.conversations.forEach(i=>o.add(i.conversationId)),o}),this.conceptTree?.loadTree())}),this.chatWsService.onStepProgress(t=>{if(t.conversationId===this.activeConversationId$()){if(this.isExecutingWorkflow$()||this.isExecutingWorkflow$.set(!0),!this.activePlanId$()&&t.planId&&this.activePlanId$.set(t.planId),this.executionProgress$.update(e=>{let o=new Map(e);return o.set(t.stepId,t.status),o}),t.totalSteps!=null&&this.totalStepsCount$.set(t.totalSteps),t.status==="in_progress"){this.currentStepTitle$.set(t.stepTitle??"Izvr\u0161avanje..."),t.stepIndex!=null&&this.currentStepIndex$.set(t.stepIndex);let e=t.stepTitle??"Korak",o=(t.stepIndex??0)+1,i=t.totalSteps??0,r={id:`wf_status_${t.stepId}`,conversationId:this.activeConversationId$()??"",role:"ASSISTANT",content:`**Izvr\u0161avam korak ${o}/${i}:** ${e}`,confidenceScore:null,confidenceFactors:null,createdAt:new Date().toISOString()};this.activeConversation$.update(s=>s&&Z(L({},s),{messages:[...s.messages,r]}))}if(t.status==="completed"&&t.content){this.completedStepsCount$.update(i=>i+1),this.conceptTree?.loadTree();let e=this.completedStepsCount$(),o=this.totalStepsCount$();e<o&&this.currentStepTitle$.set("Pripremam slede\u0107i korak...")}if(t.status==="completed"&&!t.content){this.completedStepsCount$.update(i=>i+1);let e=this.completedStepsCount$(),o=this.totalStepsCount$();e<o&&this.currentStepTitle$.set("Pripremam slede\u0107i korak...")}t.status==="failed"&&this.completedStepsCount$.update(e=>e+1)}}),this.chatWsService.onWorkflowComplete(t=>{if(t.conversationId!==this.activeConversationId$())return;let e=t.status==="completed"?"Zavr\u0161eno":t.status==="cancelled"?"Otkazano":"Gre\u0161ka",o=this.createdConceptConversations$(),i=`**${e}!** Izvr\u0161eno ${t.completedSteps}/${t.totalSteps} koraka.`;o.length>0&&(i+=`

**Rezultati po konceptima:**`,o.forEach((s,g)=>{i+=`
${g+1}. [[${s.conceptName}]]`}),i+=`

Kliknite na koncept ili odaberite konverzaciju u drvetu sa leve strane da pregledate rezultate.`);let r={id:`wf_summary_${t.planId}`,conversationId:this.activeConversationId$()??"",role:"ASSISTANT",content:i,confidenceScore:null,confidenceFactors:null,createdAt:new Date().toISOString()};this.activeConversation$.update(s=>s&&Z(L({},s),{messages:[...s.messages,r]})),this.currentStepTitle$.set(null),this.currentStepIndex$.set(0),this.totalStepsCount$.set(0),this.completedStepsCount$.set(0),this.closePlanOverlay(),this.conversationNotes?.loadNotes(),this.conceptTree?.loadTree()}),this.chatWsService.onWorkflowError(t=>{t.conversationId===this.activeConversationId$()&&(this.closePlanOverlay(),this.showError(t.message??"Workflow execution failed"))}),this.chatWsService.onStepAwaitingConfirmation(t=>{t.conversationId===this.activeConversationId$()&&(this.activePlanId$.set(t.planId),this.awaitingConfirmation$.set(!0),this.nextStepInfo$.set(t.nextStep),this.userStepInput$.set(""))}),this.chatWsService.onStepAwaitingInput(t=>{t.conversationId===this.activeConversationId$()&&(this.currentWorkflowStepInput$.set(t),this.allowWorkflowInput$.set(t.inputType==="text"),this.isLoading$.set(!1))}),this.chatWsService.onStepMessage(t=>{if(t.conversationId!==this.activeConversationId$())return;let e={id:t.messageId,conversationId:t.conversationId,role:"ASSISTANT",content:t.content,confidenceScore:null,confidenceFactors:null,createdAt:new Date().toISOString()};this.activeConversation$.update(o=>o&&Z(L({},o),{messages:[...o.messages,e]}))}),this.chatWsService.onNavigateToConversation(t=>{}),this.chatWsService.onYoloProgress(t=>{t.conversationId===this.activeConversationId$()&&(this.yoloProgress$.set(t),this.isExecutingWorkflow$.set(!0),this.showYoloActivityLog$()&&this.yoloLogContainer?.nativeElement&&setTimeout(()=>{let e=this.yoloLogContainer?.nativeElement;e&&(e.scrollTop=e.scrollHeight)}))}),this.chatWsService.onYoloComplete(t=>{t.conversationId===this.activeConversationId$()&&(this.yoloProgress$.set(null),this.isYoloMode$.set(!1),this.isExecutingWorkflow$.set(!1),this.conversationNotes?.loadNotes(),this.conceptTree?.loadTree())})}continueWorkflow(){let t=this.activePlanId$(),e=this.activeConversationId$();if(!t||!e)return;let o=this.userStepInput$().trim()||void 0;this.chatWsService.emitStepContinue(t,e,o),this.awaitingConfirmation$.set(!1),this.nextStepInfo$.set(null),this.userStepInput$.set("")}continueWorkflowStep(){let t=this.currentWorkflowStepInput$(),e=this.activeConversationId$();!t||!e||(this.chatWsService.emitStepContinue(t.planId,e),this.currentWorkflowStepInput$.set(null),this.allowWorkflowInput$.set(!1))}returnToPreviousConversation(){let t=this.previousConversationId$();t&&(this.previousConversationId$.set(null),this.router.navigate(["/chat",t]))}toggleYoloActivityLog(){this.showYoloActivityLog$.update(t=>!t)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-chat"]],viewQuery:function(e,o){if(e&1&&ot(Ze,5)(Xe,5)(Fa,5)(za,5),e&2){let i;ve(i=ke())&&(o.conceptTree=i.first),ve(i=ke())&&(o.conversationNotes=i.first),ve(i=ke())&&(o.yoloLogContainer=i.first),ve(i=ke())&&(o.messagesContainer=i.first)}},decls:28,vars:9,consts:[["messagesContainer",""],["yoloLogContainer",""],["role","alert",1,"error-toast"],[1,"plan-backdrop"],[1,"layout"],[1,"sidebar"],[1,"sidebar-header"],[1,"sidebar-actions"],[1,"new-chat-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","16px","height","16px"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[3,"conversationSelected","newChatRequested","conceptSelected","activeConversationId","locked","newConversationIds","loadingItemId"],[1,"sidebar-footer"],["routerLink","/admin/llm-config"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["routerLink","/dashboard"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"chat-main"],[1,"empty-state"],[1,"right-panel"],["fill","currentColor","viewBox","0 0 20 20",2,"width","20px","height","20px","color","#EF4444","flex-shrink","0"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[2,"font-size","13px","color","#FAFAFA"],["aria-label","Dismiss",2,"background","none","border","none","color","#6B6B6B","cursor","pointer","margin-left","auto",3,"click"],["fill","currentColor","viewBox","0 0 20 20",2,"width","16px","height","16px"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[3,"topicSelected","cancelled"],[1,"plan-backdrop",3,"click"],[1,"plan-modal"],[1,"plan-header"],[1,"plan-meta"],[1,"plan-steps"],[1,"plan-step"],[1,"plan-footer"],[1,"plan-btn-cancel"],[1,"step-indicator"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"spinner",2,"width","16px","height","16px"],["fill","currentColor","viewBox","0 0 20 20",2,"width","14px","height","14px"],[1,"step-info"],[1,"step-title"],[1,"step-desc"],[1,"step-tags"],[1,"step-tag"],["stroke-linecap","round","stroke-width","2","d","M4 12a8 8 0 018-8"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],[1,"plan-btn-cancel",3,"click"],[1,"plan-btn-approve",3,"click"],[1,"chat-header"],[1,"chat-header-left"],[1,"header-actions"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","18px","height","18px","color","#3B82F6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"],[3,"personaType"],[1,"tab-bar",2,"border-bottom","none"],[1,"tab",3,"click"],[1,"switch-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"notes-view",2,"flex","1","overflow-y","auto"],[2,"flex-shrink","0"],[3,"messageSent","disabled"],[1,"persona-selector-panel"],[1,"chat-messages"],[1,"messages-container"],[2,"display","block","margin-bottom","16px",3,"message","personaType"],[1,"execution-progress"],[1,"yolo-progress"],[3,"message","isStreaming","personaType"],[1,"step-confirmation"],[1,"return-link-container"],[1,"persona-selector-label"],[3,"personaSelected","selectedType","allowNone"],[2,"display","block","margin-bottom","16px",3,"citationClick","message","personaType"],[1,"progress-header"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"progress-spinner"],[1,"progress-label"],[1,"progress-step-name"],[1,"progress-preparing"],[1,"progress-bar-container"],[1,"progress-bar-fill"],[1,"progress-counter"],[1,"progress-steps-list"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"spinner"],[1,"progress-step-item",3,"active","completed","failed"],[1,"progress-step-item"],["fill","currentColor","viewBox","0 0 20 20",1,"progress-step-icon",2,"color","#22C55E"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"progress-step-icon","spinner",2,"color","#60A5FA"],["fill","currentColor","viewBox","0 0 20 20",1,"progress-step-icon",2,"color","#EF4444"],[1,"progress-step-num"],[1,"progress-step-text"],[1,"progress-step-concept"],[1,"yolo-progress-title"],[1,"yolo-spinner"],[1,"yolo-progress-stats"],[1,"yolo-progress-bar"],[1,"yolo-progress-fill"],[1,"yolo-workers"],[1,"yolo-failed"],[1,"yolo-discovered"],[1,"yolo-worker-item"],[1,"yolo-worker-spinner"],[1,"yolo-worker-concept"],[1,"yolo-worker-step"],[1,"yolo-activity-toggle",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"yolo-toggle-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"yolo-activity-log"],[1,"yolo-log-entry"],[1,"confirmation-header"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","#3B82F6","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","10"],["points","12 6 12 12 16 14"],[1,"confirmation-label"],[1,"confirmation-title"],[1,"confirmation-desc"],[1,"confirmation-actions"],[1,"input-prompt"],[1,"confirm-btn","primary",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","5","y1","12","x2","19","y2","12"],["points","12 5 19 12 12 19"],[1,"confirm-btn","cancel",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","#F59E0B","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"],[1,"return-link",3,"click"],["x1","19","y1","12","x2","5","y2","12"],["points","12 19 5 12 12 5"],["placeholder","Unesite va\u0161e odgovore, podatke o kompaniji, specifi\u010Dne zahteve...","rows","4",1,"confirmation-input",3,"input","value"],[3,"viewMessage","runAgents","executeTask","conversationId","conceptId","autoSelectTaskIds","isExecuting","executingTaskId","isGeneratingPlan"],[1,"domain-dashboard"],[1,"domain-stats"],[1,"stat-card"],[1,"stat-label"],[1,"stat-value","completed"],[1,"stat-value","pending"],[1,"stat-value"],[1,"domain-actions"],[1,"run-brain-btn",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"add-investigation-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"notes-view"],[3,"viewMessage","runAgents","executeTask","conversationId","conceptId","folderConceptIds","folderConversationIds","folderName","autoSelectTaskIds","isExecuting","executingTaskId","isGeneratingPlan"],[1,"empty-content"],[1,"empty-icon"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","40px","height","40px","color","#3B82F6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"empty-title"],[1,"empty-desc"],[1,"start-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",2,"width","20px","height","20px"],[1,"persona-pills"],[1,"persona-pill",2,"color","#3B82F6"],[1,"persona-pill",2,"color","#8B5CF6"],[1,"persona-pill",2,"color","#10B981"],[1,"persona-pill",2,"color","#F59E0B"],[1,"persona-pill",2,"color","#EF4444"],[1,"persona-pill",2,"color","#EC4899"],[1,"source-header"],[3,"close","conceptClick","conceptId","isOpen"]],template:function(e,o){e&1&&(f(0,Ha,8,1,"div",2),f(1,qa,1,0,"app-topic-picker"),f(2,Ja,18,5,"div",3),p(3,"div",4)(4,"aside",5)(5,"div",6)(6,"h1"),c(7,"Mentor AI"),h()(),p(8,"div",7)(9,"button",8),R("click",function(){return o.createNewConversation()}),w(),p(10,"svg",9),E(11,"path",10),h(),c(12," New Conversation "),h()(),F(),p(13,"app-concept-tree",11),R("conversationSelected",function(r){return o.selectConversation(r)})("newChatRequested",function(r){return o.createConversationUnderConcept(r)})("conceptSelected",function(r){return o.onConceptSelected(r)}),h(),p(14,"div",12)(15,"a",13),w(),p(16,"svg",9),E(17,"path",14)(18,"path",15),h(),c(19," AI Configuration "),h(),F(),p(20,"a",16),w(),p(21,"svg",9),E(22,"path",17),h(),c(23," Dashboard "),h()()(),F(),p(24,"main",18),f(25,Vs,7,3)(26,Fs,26,0,"div",19),h(),f(27,zs,4,2,"aside",20),h()),e&2&&(_(o.errorMessage$()?0:-1),a(),_(o.showTopicPicker$()?1:-1),a(),_(o.showPlanOverlay$()&&o.currentPlan$()?2:-1),a(11),X("activeConversationId",o.activeConversationId$())("locked",o.isExecutingWorkflow$())("newConversationIds",o.newConversationIds$())("loadingItemId",o.loadingConversationId$()),a(12),_(o.activeConversation$()||o.folderName$()?25:26),a(2),_(o.selectedConceptId$()?27:-1))},dependencies:[Y,vn,St,Et,Mt,Ot,It,$t,Ze,Xe,Nt],styles:["[_nghost-%COMP%]{display:block;height:100vh}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}.layout[_ngcontent-%COMP%]{display:flex;height:100vh;background:#0d0d0d;color:#fafafa;font-family:Inter,system-ui,sans-serif}.sidebar[_ngcontent-%COMP%]{width:280px;min-width:280px;background:#0d0d0d;border-right:1px solid #2A2A2A;display:flex;flex-direction:column}.sidebar-header[_ngcontent-%COMP%]{height:48px;display:flex;align-items:center;padding:0 16px;border-bottom:1px solid #2A2A2A}.sidebar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:15px;font-weight:600}.sidebar-actions[_ngcontent-%COMP%]{padding:12px}.new-chat-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;background:#3b82f6;color:#fff;border:none;padding:10px 16px;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer}.new-chat-btn[_ngcontent-%COMP%]:hover{opacity:.9}.sidebar-footer[_ngcontent-%COMP%]{padding:12px;border-top:1px solid #2A2A2A;display:flex;flex-direction:column;gap:4px}.sidebar-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;color:#6b6b6b;text-decoration:none;padding:6px 4px;border-radius:4px}.sidebar-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fafafa;background:#1a1a1a}.chat-main[_ngcontent-%COMP%]{flex:1;min-width:480px;display:flex;flex-direction:column;background:#0d0d0d}.chat-header[_ngcontent-%COMP%]{height:48px;display:flex;align-items:center;justify-content:space-between;padding:0 16px;border-bottom:1px solid #2A2A2A}.chat-header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.chat-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px;font-weight:500}.switch-btn[_ngcontent-%COMP%]{background:none;border:none;color:#6b6b6b;font-size:13px;cursor:pointer;display:flex;align-items:center;gap:6px}.switch-btn[_ngcontent-%COMP%]:hover{color:#fafafa}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.chat-messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:24px}.messages-container[_ngcontent-%COMP%]{max-width:768px;margin:0 auto}.empty-state[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center}.empty-content[_ngcontent-%COMP%]{text-align:center;max-width:400px;padding:24px}.empty-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 24px;background:#1a1a1a;border-radius:16px;display:flex;align-items:center;justify-content:center}.empty-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin-bottom:8px}.empty-desc[_ngcontent-%COMP%]{font-size:15px;color:#a1a1a1;margin-bottom:24px;line-height:1.5}.start-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;background:#3b82f6;color:#fff;border:none;padding:12px 24px;border-radius:8px;font-size:15px;font-weight:500;cursor:pointer}.start-btn[_ngcontent-%COMP%]:hover{opacity:.9}.persona-pills[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin-top:32px}.persona-pill[_ngcontent-%COMP%]{padding:6px 12px;background:#1a1a1a;border-radius:20px;font-size:11px;font-weight:500}.persona-selector-panel[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #2A2A2A;background:#1a1a1a}.persona-selector-label[_ngcontent-%COMP%]{font-size:13px;color:#a1a1a1;margin-bottom:12px}.error-toast[_ngcontent-%COMP%]{position:fixed;top:16px;right:16px;z-index:50;background:#1a1a1a;border:1px solid #EF4444;padding:12px 16px;border-radius:8px;display:flex;align-items:center;gap:12px;max-width:400px;box-shadow:0 4px 12px #0000004d}.right-panel[_ngcontent-%COMP%]{width:360px;min-width:360px;background:#0d0d0d;border-left:1px solid #2A2A2A;display:flex;flex-direction:column}.source-header[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #2A2A2A;font-size:11px;font-weight:600;color:#6b6b6b;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0}.tab-bar[_ngcontent-%COMP%]{display:flex;gap:0;border-bottom:1px solid #2A2A2A}.tab[_ngcontent-%COMP%]{padding:8px 20px;background:none;border:none;border-bottom:2px solid transparent;color:#6b6b6b;font-size:13px;cursor:pointer}.tab[_ngcontent-%COMP%]:hover{color:#a1a1a1}.tab.active[_ngcontent-%COMP%]{color:#fafafa;border-bottom-color:#3b82f6}.notes-view[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.domain-dashboard[_ngcontent-%COMP%]{padding:20px 24px;border-bottom:1px solid #2A2A2A}.domain-stats[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.stat-card[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #2A2A2A;border-radius:8px;padding:12px 16px;flex:1}.stat-label[_ngcontent-%COMP%]{font-size:11px;color:#6b6b6b;text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}.stat-value[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#fafafa}.stat-value.completed[_ngcontent-%COMP%]{color:#10b981}.stat-value.pending[_ngcontent-%COMP%]{color:#f59e0b}.domain-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.run-brain-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 18px;background:#3b82f6;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer}.run-brain-btn[_ngcontent-%COMP%]:hover{background:#2563eb}.run-brain-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.add-investigation-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 18px;background:#242424;color:#fafafa;border:1px solid #2A2A2A;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer}.add-investigation-btn[_ngcontent-%COMP%]:hover{background:#2a2a2a}.plan-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:100;background:#000000b3;display:flex;align-items:center;justify-content:center}.plan-modal[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #2A2A2A;border-radius:12px;width:560px;max-height:80vh;display:flex;flex-direction:column;box-shadow:0 8px 32px #00000080}.plan-header[_ngcontent-%COMP%]{padding:16px 20px;border-bottom:1px solid #2A2A2A;display:flex;align-items:center;justify-content:space-between}.plan-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fafafa}.plan-meta[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:12px;color:#a1a1a1}.plan-steps[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:12px 20px}.plan-step[_ngcontent-%COMP%]{display:flex;gap:12px;padding:10px 0;border-bottom:1px solid #242424}.plan-step[_ngcontent-%COMP%]:last-child{border-bottom:none}.step-indicator[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:600}.step-pending[_ngcontent-%COMP%]{background:#242424;color:#6b6b6b}.step-in-progress[_ngcontent-%COMP%]{background:#1e3a5f;color:#60a5fa}.step-completed[_ngcontent-%COMP%]{background:#1a2e1a;color:#86efac}.step-failed[_ngcontent-%COMP%]{background:#3b1a1a;color:#fca5a5}.step-info[_ngcontent-%COMP%]{flex:1}.step-title[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#fafafa}.step-desc[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;margin-top:2px}.step-tags[_ngcontent-%COMP%]{display:flex;gap:6px;margin-top:4px}.step-tag[_ngcontent-%COMP%]{font-size:10px;padding:1px 6px;border-radius:4px;background:#242424;color:#6b6b6b}.plan-footer[_ngcontent-%COMP%]{padding:12px 20px;border-top:1px solid #2A2A2A;display:flex;gap:8px;justify-content:flex-end}.plan-btn-cancel[_ngcontent-%COMP%]{background:none;border:1px solid #2A2A2A;color:#a1a1a1;border-radius:6px;padding:8px 20px;font-size:13px;cursor:pointer}.plan-btn-cancel[_ngcontent-%COMP%]:hover{color:#fafafa;border-color:#4a4a4a}.plan-btn-approve[_ngcontent-%COMP%]{background:#3b82f6;color:#fafafa;border:none;border-radius:6px;padding:8px 20px;font-size:13px;font-weight:500;cursor:pointer}.plan-btn-approve[_ngcontent-%COMP%]:hover{background:#2563eb}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.execution-progress[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #2A2A2A;border-radius:10px;padding:14px 18px;margin:12px 0;max-width:768px}.progress-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.progress-spinner[_ngcontent-%COMP%]{width:18px;height:18px;animation:_ngcontent-%COMP%_spin 1s linear infinite;color:#3b82f6;flex-shrink:0}.progress-label[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#fafafa}.progress-step-name[_ngcontent-%COMP%]{font-size:12px;color:#a1a1a1;margin-bottom:8px}.progress-bar-container[_ngcontent-%COMP%]{width:100%;height:4px;background:#242424;border-radius:2px;overflow:hidden}.progress-bar-fill[_ngcontent-%COMP%]{height:100%;background:#3b82f6;border-radius:2px;transition:width .5s ease-in-out}.progress-counter[_ngcontent-%COMP%]{font-size:11px;color:#6b6b6b;margin-top:6px;text-align:right}.progress-steps-list[_ngcontent-%COMP%]{margin-top:10px;border-top:1px solid #242424;padding-top:8px}.progress-step-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:3px 0;font-size:11px;color:#6b6b6b}.progress-step-item.active[_ngcontent-%COMP%]{color:#60a5fa}.progress-step-item.completed[_ngcontent-%COMP%]{color:#86efac}.progress-step-item.failed[_ngcontent-%COMP%]{color:#fca5a5}.progress-step-icon[_ngcontent-%COMP%]{width:14px;height:14px;flex-shrink:0}.progress-step-num[_ngcontent-%COMP%]{width:14px;height:14px;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:600;color:#4a4a4a;flex-shrink:0}.progress-step-text[_ngcontent-%COMP%]{flex:1}.progress-step-concept[_ngcontent-%COMP%]{font-size:10px;color:#4a4a4a;flex-shrink:0}.yolo-progress[_ngcontent-%COMP%]{padding:16px;background:#1a1a1a;border:1px solid #2A2A2A;border-radius:10px;margin:12px 0;max-width:768px}.yolo-progress-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;margin-bottom:8px;color:#fafafa;display:flex;align-items:center;gap:8px}.yolo-spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid #2A2A2A;border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;display:inline-block}.yolo-progress-stats[_ngcontent-%COMP%]{font-size:14px;color:#a0a0a0;text-align:center}.yolo-progress-stats[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600}.yolo-progress-stats[_ngcontent-%COMP%]   .yolo-failed[_ngcontent-%COMP%]{color:#ef4444}.yolo-progress-stats[_ngcontent-%COMP%]   .yolo-discovered[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.yolo-progress-bar[_ngcontent-%COMP%]{height:4px;background:#2a2a2a;border-radius:2px;margin-top:12px;overflow:hidden}.yolo-progress-fill[_ngcontent-%COMP%]{height:100%;background:#3b82f6;border-radius:2px;transition:width .3s}.yolo-workers[_ngcontent-%COMP%]{margin-top:10px;border-top:1px solid #242424;padding-top:8px}.yolo-worker-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 0;font-size:12px;color:#a1a1a1}.yolo-worker-spinner[_ngcontent-%COMP%]{width:12px;height:12px;border:2px solid #2A2A2A;border-top-color:#60a5fa;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;flex-shrink:0}.yolo-worker-concept[_ngcontent-%COMP%]{color:#fafafa;font-weight:500}.yolo-worker-step[_ngcontent-%COMP%]{color:#6b6b6b;font-size:11px}.yolo-activity-toggle[_ngcontent-%COMP%]{background:none;border:none;color:#6b6b6b;cursor:pointer;font-size:11px;padding:4px 0;margin-top:8px;display:flex;align-items:center;gap:4px}.yolo-activity-toggle[_ngcontent-%COMP%]:hover{color:#a1a1a1}.yolo-toggle-icon[_ngcontent-%COMP%]{width:12px;height:12px;transition:transform .2s}.yolo-toggle-icon.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.yolo-activity-log[_ngcontent-%COMP%]{margin-top:6px;max-height:160px;overflow-y:auto;background:#0d0d0d;border-radius:6px;padding:8px}.yolo-log-entry[_ngcontent-%COMP%]{font-size:10px;color:#6b6b6b;padding:2px 0;font-family:Courier New,monospace;white-space:pre-wrap;word-break:break-all}.step-status-msg[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 14px;margin:8px 0;max-width:768px;background:#111;border-left:3px solid #3B82F6;border-radius:0 6px 6px 0;font-size:12px;color:#a1a1a1}.step-status-msg[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]{width:14px;height:14px;flex-shrink:0}@keyframes _ngcontent-%COMP%_pulse-bg{0%,to{opacity:1}50%{opacity:.6}}.progress-preparing[_ngcontent-%COMP%]{font-size:12px;color:#60a5fa;margin-top:8px;display:flex;align-items:center;gap:6px;animation:_ngcontent-%COMP%_pulse-bg 1.5s ease-in-out infinite}.progress-preparing[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px;flex-shrink:0}@keyframes _ngcontent-%COMP%_highlightFlash{0%{outline:2px solid #3B82F6;outline-offset:4px}to{outline:2px solid transparent;outline-offset:4px}}[_nghost-%COMP%]     .highlight-flash{animation:_ngcontent-%COMP%_highlightFlash 2s ease-out}.step-confirmation[_ngcontent-%COMP%]{margin:16px 0;padding:16px;background:#1a1a1a;border:1px solid #2A2A2A;border-radius:12px;border-left:3px solid #3B82F6}.confirmation-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.confirmation-label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:#3b82f6;text-transform:uppercase;letter-spacing:.05em}.confirmation-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#fafafa;margin:0 0 4px}.confirmation-desc[_ngcontent-%COMP%]{font-size:.875rem;color:#a3a3a3;margin:0 0 12px;line-height:1.5}.input-prompt[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;margin-bottom:8px;background:#f59e0b14;border:1px solid rgba(245,158,11,.2);border-radius:8px;font-size:.85rem;color:#f59e0b;font-weight:500}.input-prompt[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.confirmation-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;background:#0d0d0d;border:1px solid #2A2A2A;border-radius:8px;color:#fafafa;font-size:.875rem;font-family:inherit;resize:vertical;min-height:60px;margin-bottom:12px;transition:border-color .15s ease;box-sizing:border-box}.confirmation-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.confirmation-input[_ngcontent-%COMP%]::placeholder{color:#525252}.confirmation-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.confirm-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:6px;padding:8px 16px;font-size:.875rem;font-weight:500;border-radius:8px;cursor:pointer;transition:all .15s ease;border:1px solid transparent}.confirm-btn.primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-color:#3b82f6}.confirm-btn.primary[_ngcontent-%COMP%]:hover{background:#2563eb;border-color:#2563eb}.confirm-btn.cancel[_ngcontent-%COMP%]{background:transparent;color:#a3a3a3;border-color:#2a2a2a}.confirm-btn.cancel[_ngcontent-%COMP%]:hover{background:#1a1a1a;color:#ef4444;border-color:#ef4444}.return-link-container[_ngcontent-%COMP%]{margin:12px 0;text-align:center}.return-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;background:none;border:1px solid #2A2A2A;color:#60a5fa;padding:8px 16px;border-radius:8px;font-size:13px;cursor:pointer;transition:all .15s ease}.return-link[_ngcontent-%COMP%]:hover{background:#1a1a1a;border-color:#3b82f6;color:#93c5fd}.return-link[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}"]})};export{Po as ChatComponent};
