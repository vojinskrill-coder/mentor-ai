import{b as P}from"./chunk-X5FYGGBF.js";import{a as k}from"./chunk-QLHVQZLH.js";import{$a as y,A as i,C as d,D as m,Ea as a,Fa as _,H as p,K as g,V as s,Z as f,fa as u,ga as h,ib as v,kb as M,pa as o,qa as r,ra as b,sa as x,va as C,wa as c}from"./chunk-GC2SN3QZ.js";function S(n,t){if(n&1){let e=x();o(0,"div",2)(1,"h2"),a(2,"Authentication Failed"),r(),o(3,"p"),a(4),r(),o(5,"button",3),C("click",function(){d(e);let E=c();return m(E.retry())}),a(6,"Try Again"),r()()}if(n&2){let e=c();s(4),_(e.error())}}function w(n,t){n&1&&(b(0,"div",4),o(1,"p",5),a(2,"Completing authentication..."),r())}var O=class n{authService=i(P);router=i(M);route=i(v);destroyRef=i(p);error=g(null);ngOnInit(){let t=this.route.snapshot.queryParamMap.get("code");if(this.route.snapshot.queryParamMap.get("error")){let l=this.route.snapshot.queryParamMap.get("error_description");this.error.set(l||"Google authentication was denied.");return}if(!t){this.error.set("No authorization code received from Google.");return}this.handleCallback(t)}handleCallback(t){this.error.set(null),this.authService.handleCallback(t).pipe(k(this.destroyRef)).subscribe({next:()=>{let e=sessionStorage.getItem("returnUrl")||"/chat";sessionStorage.removeItem("returnUrl"),this.router.navigate([e])},error:e=>{this.error.set(e?.error?.detail||e?.error?.message||"Authentication failed. Please try again.")}})}retry(){this.authService.login()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=f({type:n,selectors:[["app-callback"]],decls:4,vars:1,consts:[[1,"page"],[1,"content"],[1,"error-box"],[1,"retry-btn",3,"click"],[1,"spinner"],[1,"loading-text"]],template:function(e,l){e&1&&(o(0,"div",0)(1,"div",1),u(2,S,7,1,"div",2)(3,w,3,0),r()()),e&2&&(s(2),h(l.error()?2:3))},dependencies:[y],styles:["[_nghost-%COMP%]{display:block}.page[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#0d0d0d;padding:16px;font-family:Inter,system-ui,sans-serif;color:#fafafa}.content[_ngcontent-%COMP%]{text-align:center}.error-box[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid rgba(239,68,68,.2);border-radius:8px;padding:24px;max-width:400px}.error-box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#ef4444;margin-bottom:8px}.error-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#ef4444;margin-bottom:16px}.retry-btn[_ngcontent-%COMP%]{padding:8px 20px;background:#3b82f6;color:#fff;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;font-family:inherit}.retry-btn[_ngcontent-%COMP%]:hover{opacity:.9}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #2A2A2A;border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin:0 auto 16px}.loading-text[_ngcontent-%COMP%]{font-size:15px;color:#a1a1a1}"]})};export{O as CallbackComponent};
