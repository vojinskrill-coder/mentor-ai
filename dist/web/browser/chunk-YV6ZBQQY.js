import{a as N}from"./chunk-INE6CAKJ.js";import{b as A}from"./chunk-BTP5US75.js";import{C as V,a as T,b as E,c as M,f as R,g as j,q as D}from"./chunk-IDIHJMUC.js";import{a as C}from"./chunk-HXP2IP54.js";import{A as f,Aa as v,B as g,F as y,Ha as $,I as u,R as r,V as b,Va as I,aa as c,ba as l,cb as k,eb as w,ga as S,ha as e,ia as i,ja as m,na as _,pa as h,ra as p,y as s,za as n}from"./chunk-4VSIGE6D.js";function P(t,a){t&1&&(e(0,"div",2),m(1,"ng-icon",5),e(2,"p",6),n(3,"Validating invitation..."),i()())}function Y(t,a){if(t&1){let o=_();e(0,"div",13)(1,"p",15),n(2," You need to sign in to accept this invitation. "),i(),e(3,"button",16),h("click",function(){f(o);let x=p(2);return g(x.login())}),n(4," Sign in to Accept "),i()()}}function L(t,a){t&1&&(m(0,"ng-icon",18),n(1," Joining... "))}function O(t,a){t&1&&n(0," Accept & Join ")}function q(t,a){if(t&1){let o=_();e(0,"button",17),h("click",function(){f(o);let x=p(2);return g(x.acceptInvitation())}),c(1,L,2,0)(2,O,1,0),i()}if(t&2){let o=p(2);S("disabled",o.state$()==="accepting"),r(),l(o.state$()==="accepting"?1:2)}}function F(t,a){if(t&1&&(e(0,"div",3),m(1,"ng-icon",7),e(2,"div")(3,"h1",8),n(4," You've been invited! "),i(),e(5,"p",6),n(6," You're invited to join "),e(7,"span",9),n(8),i()()(),e(9,"div",10)(10,"div",11)(11,"span",6),n(12,"Department"),i(),e(13,"span",12),n(14),i()(),e(15,"div",11)(16,"span",6),n(17,"Role"),i(),e(18,"span",12),n(19,"Team Member"),i()()(),c(20,Y,5,0,"div",13)(21,q,3,2,"button",14),i()),t&2){let o=p();r(8),v(o.invitation$().tenantName),r(6),v(o.invitation$().department),r(6),l(o.isAuthenticated$()?21:20)}}function J(t,a){t&1&&(e(0,"div",4),m(1,"ng-icon",19),e(2,"h1",20),n(3,"Welcome aboard!"),i(),e(4,"p",6),n(5," You've successfully joined the team. Redirecting to dashboard... "),i()())}function X(t,a){if(t&1&&(e(0,"div",4),m(1,"ng-icon",21),e(2,"h1",20),n(3,"Invalid Invitation"),i(),e(4,"p",6),n(5),i(),e(6,"p",15),n(7," Please request a new invitation from your team administrator. "),i()()),t&2){let o=p();r(5),v(o.errorMessage$())}}var B=class t{route=s(k);router=s(w);invitationService=s(N);authService=s(A);destroyRef=s(y);state$=u("loading");invitation$=u(null);errorMessage$=u("This invitation is no longer valid.");isAuthenticated$=this.authService.isAuthenticated$;token="";ngOnInit(){if(this.token=this.route.snapshot.paramMap.get("token")??"",!this.token){this.state$.set("error"),this.errorMessage$.set("No invitation token provided.");return}this.validateToken()}validateToken(){this.invitationService.validateToken(this.token).pipe(C(this.destroyRef)).subscribe({next:a=>{this.invitation$.set(a.data),this.state$.set("valid")},error:a=>{this.state$.set("error"),this.errorMessage$.set(a.message||"This invitation has expired. Please request a new invite.")}})}login(){this.authService.login(`/invite/${this.token}`)}acceptInvitation(){this.state$.set("accepting"),this.invitationService.acceptInvitation(this.token).pipe(C(this.destroyRef)).subscribe({next:()=>{this.state$.set("accepted"),setTimeout(()=>{this.router.navigate(["/dashboard"])},2e3)},error:a=>{this.state$.set("error"),this.errorMessage$.set(a.message)}})}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=b({type:t,selectors:[["app-invite-accept"]],features:[$([E({lucideLoader2:D,lucideCheckCircle:j,lucideXCircle:V,lucideBuilding2:R})])],decls:6,vars:4,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-background","p-4"],[1,"w-full","max-w-md","space-y-6"],[1,"flex","flex-col","items-center","justify-center","py-12"],[1,"rounded-lg","border","bg-card","p-8","text-center","space-y-6"],[1,"rounded-lg","border","bg-card","p-8","text-center","space-y-4"],["name","lucideLoader2",1,"h-10","w-10","animate-spin","text-primary","mb-4"],[1,"text-muted-foreground"],["name","lucideBuilding2",1,"mx-auto","h-12","w-12","text-primary"],[1,"text-2xl","font-bold","text-foreground","mb-2"],[1,"font-semibold","text-foreground"],[1,"rounded-md","bg-muted","p-4","text-left","space-y-2"],[1,"flex","justify-between","text-sm"],[1,"font-medium","text-foreground"],[1,"space-y-3"],["brnButton","",1,"w-full","inline-flex","items-center","justify-center","rounded-md","bg-primary","px-4","py-2","text-sm","font-medium","text-primary-foreground","hover:bg-primary/90","disabled:opacity-50",3,"disabled"],[1,"text-sm","text-muted-foreground"],["brnButton","",1,"w-full","inline-flex","items-center","justify-center","rounded-md","bg-primary","px-4","py-2","text-sm","font-medium","text-primary-foreground","hover:bg-primary/90",3,"click"],["brnButton","",1,"w-full","inline-flex","items-center","justify-center","rounded-md","bg-primary","px-4","py-2","text-sm","font-medium","text-primary-foreground","hover:bg-primary/90","disabled:opacity-50",3,"click","disabled"],["name","lucideLoader2",1,"mr-2","h-4","w-4","animate-spin"],["name","lucideCheckCircle",1,"mx-auto","h-12","w-12","text-green-500"],[1,"text-2xl","font-bold","text-foreground"],["name","lucideXCircle",1,"mx-auto","h-12","w-12","text-destructive"]],template:function(o,d){o&1&&(e(0,"div",0)(1,"div",1),c(2,P,4,0,"div",2),c(3,F,22,3,"div",3),c(4,J,6,0,"div",4),c(5,X,8,1,"div",4),i()()),o&2&&(r(2),l(d.state$()==="loading"?2:-1),r(),l(d.state$()==="valid"&&d.invitation$()?3:-1),r(),l(d.state$()==="accepted"?4:-1),r(),l(d.state$()==="error"?5:-1))},dependencies:[I,T,M],encapsulation:2})};export{B as InviteAcceptComponent};
