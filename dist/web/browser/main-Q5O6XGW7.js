import{a as h}from"./chunk-DES2IIKE.js";import"./chunk-R4LDHEAD.js";import{b as c}from"./chunk-X5FYGGBF.js";import{A as e,J as g,Z as C,bb as A,eb as S,fb as b,gb as R,jb as T,kb as a,mb as E,nb as I,oa as v,u as f}from"./chunk-GC2SN3QZ.js";var n=(t,r)=>{let o=e(c),i=e(a);return o.isAuthenticated$()?!0:(sessionStorage.setItem("returnUrl",r.url),i.navigate(["/login"]),!1)};function m(t){return(r,o)=>{let i=e(c),l=e(a),p=i.currentUser();return p?t.includes(p.role)?!0:(l.navigate(["/dashboard"]),!1):(l.navigate(["/login"]),!1)}}var s=async()=>{let t=e(a),r=e(h);try{let o=await r.getStatus();return o.tenantStatus==="ACTIVE"||o.tenantStatus==="SUSPENDED"||o.tenantStatus==="PENDING_DELETION"?!0:o.tenantStatus==="DRAFT"||o.tenantStatus==="ONBOARDING"?t.createUrlTree(["/onboarding"]):!0}catch{return t.createUrlTree(["/onboarding"])}},F=async()=>{let t=e(a),r=e(h);try{let o=await r.getStatus();return o.currentStep==="complete"?t.createUrlTree(["/chat"]):o.tenantStatus==="ACTIVE"?t.createUrlTree(["/chat"]):!0}catch{return!0}};var N=[{path:"login",loadComponent:()=>import("./chunk-2OV6CXRT.js").then(t=>t.LoginComponent)},{path:"callback",loadComponent:()=>import("./chunk-YN7ZB5U4.js").then(t=>t.CallbackComponent)},{path:"register",loadComponent:()=>import("./chunk-FEE4GHMW.js").then(t=>t.RegistrationComponent)},{path:"oauth-pending",loadComponent:()=>import("./chunk-T3LHN7Q4.js").then(t=>t.OAuthPendingComponent)},{path:"invite/:token",loadComponent:()=>import("./chunk-TR77DAH6.js").then(t=>t.InviteAcceptComponent)},{path:"2fa-setup",loadComponent:()=>import("./chunk-A6JVGC46.js").then(t=>t.TwoFactorSetupComponent),canActivate:[n]},{path:"verify-2fa",loadComponent:()=>import("./chunk-R476VGEN.js").then(t=>t.TwoFactorVerifyComponent)},{path:"onboarding",loadComponent:()=>import("./chunk-WN5L3BY4.js").then(t=>t.OnboardingWizardComponent),canActivate:[n,F]},{path:"dashboard",loadComponent:()=>import("./chunk-QTTQAD64.js").then(t=>t.DashboardComponent),canActivate:[n,s]},{path:"team",loadComponent:()=>import("./chunk-XXVE5NNW.js").then(t=>t.TeamComponent),canActivate:[n,m(["TENANT_OWNER","ADMIN"])]},{path:"account-settings",loadComponent:()=>import("./chunk-LSGHZJ2I.js").then(t=>t.AccountSettingsComponent),canActivate:[n,m(["TENANT_OWNER"])]},{path:"profile-settings",loadComponent:()=>import("./chunk-PYDG57PW.js").then(t=>t.ProfileSettingsComponent),canActivate:[n]},{path:"admin/llm-config",loadComponent:()=>import("./chunk-45QPPXZO.js").then(t=>t.LlmConfigComponent),canActivate:[n,m(["PLATFORM_OWNER"])]},{path:"chat",loadComponent:()=>import("./chunk-2D6OTFI7.js").then(t=>t.ChatComponent),canActivate:[n,s]},{path:"chat/:conversationId",loadComponent:()=>import("./chunk-2D6OTFI7.js").then(t=>t.ChatComponent),canActivate:[n,s]},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"**",redirectTo:"dashboard"}];var O="mentor_ai_token",_=(t,r)=>{let o=e(a);if(["/api/health","/api/registration","/api/invitations/validate","/api/auth/google/callback"].some(d=>t.url.includes(d)))return r(t);let p=localStorage.getItem(O),H=p?t.clone({setHeaders:{Authorization:`Bearer ${p}`}}):t;return r(H).pipe(f({error:d=>{d.status===401&&(localStorage.removeItem("mentor_ai_token"),localStorage.removeItem("mentor_ai_user"),localStorage.removeItem("mentor_ai_google_user"),o.navigate(["/login"]))}}))};var G={providers:[g(),E(N),S(R(),b([_]))]};var u=class t{static \u0275fac=function(o){return new(o||t)};static \u0275cmp=C({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(o,i){o&1&&v(0,"router-outlet")},dependencies:[I,T],encapsulation:2})};A(u,G).catch(t=>console.error(t));
